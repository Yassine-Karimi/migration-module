<?xml version="1.0" encoding="UTF-8"?>
<services>
  <!--***********************COMMON CONFIGURATION PARAMETERS*****************************************************
    The parameters in this section are meant to be referenced from other places. Parameters that are used on more than one place should be
    placed in this section and then dereferenced when used.
  -->
  <service id="CommonConfiguration">
    <appDetails>
      <!-- Application Name -->
      <appName>MESA</appName>
      <!-- Application version (the one which is displayed on screens to the user) -->
      <version>2.7.3-SNAPSHOT</version>
      <!--Valid values - [1,2]-->
      <numberOfWindows>1</numberOfWindows>
      <!-- Full screen mode ON/OFF -->
      <fullScreen>true</fullScreen>
      <!-- where to find files (open file dialog) -->
      <fileRoot>C:/Dataset/</fileRoot>
    </appDetails>
    <!-- check available updates on server -->
    <checkForUpdates>false</checkForUpdates>
	  <enableBrowserRightClick>true</enableBrowserRightClick>
    <hardware>
      <!-- Screen DPI (number of pixels per inch)
             Possible values: 
             '-1': use the value provided by the hardware (might be wrongly reported by the tablets or high resolution laptop screens)
            '155': usual value for Lenovo Thinkpad Tablet 2
             '96': usual value for desktop monitors
                 : any positive value
           -->
      <screenDPI>96</screenDPI>
    </hardware>
    <!-- Zoom Tool Configuration-->
    <zoomMinLevel500ppi>10</zoomMinLevel500ppi>
    <zoomMaxLevel500ppi>1000</zoomMaxLevel500ppi>
    <zoomMinLevel1000ppi>5</zoomMinLevel1000ppi>
    <zoomMaxLevel1000ppi>500</zoomMaxLevel1000ppi>
  </service> 


  <service id="morpho.mesa.common.utils.log.LogManager">
    <enableAuditLog>true</enableAuditLog>
    <enableAlertLog>false</enableAlertLog>
    <origin refSource="CommonConfiguration" ref="/appDetails/appName" />
    <station refSource="morpho.mesa.common.configuration.MesaConfiguration" ref="/stationIdentifier" />
    <scriptFile>CONFIG/scripts-logging/audit-log-filters.js</scriptFile>
    <scriptFile>CONFIG/scripts-logging/audit-log-builders.js</scriptFile>
  </service> 


  <!-- ***********************MESA USER PREFERENCES PARAMETERS*****************************************************
      Define default user preferences until changed by operator 
      Once the operator set its preferences, these values are not taken into account any more
  -->
  <service id="morpho.mesa.launcher.core.MesaUserPreferences">
    <DefaultLocale>en</DefaultLocale>
    <DefautlApplicantLocale>en</DefautlApplicantLocale>
    <DefaultCurrentLayout>sidebar</DefaultCurrentLayout>
    <fullScreen>false</fullScreen>
  </service> 


  <!-- *********************************** MESA CONFIGURATION PARAMETERS *********************************************************
  -->
  <service id="morpho.mesa.common.configuration.MesaConfiguration">
    <!-- predefined Synopsis containing identifier, firstName, aSurName, thumbnail -->
    <synopsis>
      <name>synopsis1</name>
      <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.demographics.custoData.aFirstName</fieldName>
        <fieldLabel>aFirstName</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.demographics.custoData.aSurName</fieldName>
        <fieldLabel>aSurName</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.portraits.frontal.mainImage.thumbnail</fieldName>
        <fieldType>img</fieldType>
      </synopsisField>
    </synopsis>
    <!-- predefined Synopsis containing identifier, firstName, aSurName, thumbnail -->
    <synopsis>
      <name>synopsis2</name>
      <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
    </synopsis>
    <!-- predefined Synopsis containing firstName, surName -->
    <synopsis>
      <name>synopsis3</name>
	    <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.demographics.custoData.aFirstName</fieldName>
        <fieldLabel>aFirstName</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.demographics.custoData.aSurName</fieldName>
        <fieldLabel>aSurName</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
    </synopsis>
    <!-- predefined Synopsis containing thumbnail -->
    <synopsis>
      <name>synopsis4</name>
	  <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.portraits.frontal-1.mainImage.thumbnail</fieldName>
        <fieldType>img</fieldType>
      </synopsisField>
    </synopsis>
    <!-- predefined Synopsis containing thumbnail for passport acquisition -->
    <synopsis>
      <name>synopsis5</name>
	  <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.edoc_portraits.chip_portrait.mainImage.thumbnail</fieldName>
        <fieldType>img</fieldType>
      </synopsisField>
    </synopsis>
    <!-- predefined Synopsis containing thumbnail and dossier ID -->
    <synopsis>
      <name>synopsis6</name>
	  <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.portraits.frontal.mainImage.thumbnail</fieldName>
        <fieldType>img</fieldType>
      </synopsisField>
    </synopsis>
    <synopsis>
      <name>synopsis7</name>
	  <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.images.ApplicantDocumentToIssue_CHIP_PORTRAIT</fieldName>
        <fieldType>img</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.demographics.custoData.ApplicantDocumentToIssue_firstNameDG1</fieldName>
        <fieldLabel>aFirstName</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.demographics.custoData.ApplicantDocumentToIssue_lastNameDG1</fieldName>
        <fieldLabel>aSurName</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
    </synopsis>
    <synopsis>
      <name>synopsis8</name>
	  <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.demographics.custoData.aFirstName</fieldName>
        <fieldLabel>aFirstName</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.demographics.custoData.aSurName</fieldName>
        <fieldLabel>aSurName</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.portraits.frontal-1.mainImage.thumbnail</fieldName>
        <fieldType>img</fieldType>
      </synopsisField>
    </synopsis>
    <synopsis>
      <name>synopsis9</name>
	  <synopsisField>
        <fieldName>identifier</fieldName>
        <fieldLabel>procIdentifier</fieldLabel>
        <fieldType>txt</fieldType>
      </synopsisField>
      <synopsisField>
        <fieldName>item.face.capturableFeatures.frontal-1.mainImage.thumbnail</fieldName>
        <fieldType>img</fieldType>
      </synopsisField>
    </synopsis>
    <!--Identifies the station among other stations-->
    <stationIdentifier>123456</stationIdentifier>
    <stationHostName>MACA0111</stationHostName>
    <!-- checkBeforeExit : list of items to check before exiting MESA
        each tag is an item to check. true means check must be done, false
        means item is not required (default : false)
        For the time being, only 1 possible item : "exportsNotSent" -->
    <checkBeforeExit>
      <exportsNotSent>true</exportsNotSent>
    </checkBeforeExit>
  </service> 


  <!-- ********************************* MESA SCAN ACQUISITION PARAMETERS *******************************************************
  -->
  <!-- Scan acquisition settings -->
  <service id="morpho.mesa.services.acquisition.scan.morphopak.ScanCaptureConfigurationManager">
    <deviceType>device.scanner</deviceType>
    <!-- optional parameter to specify the name of the scanner to use. If parameter is kept empty, the device used will be the first detected -->
    <deviceId />
  </service> 


  <!-- ******************************* MESA IRIS ACQUISITION PARAMETERS *********************************************************
      Define the MESA IRIS ACQUISITION PARAMETERS
  -->

  <!-- Iris Acquisition through EVC_IrisAndface -->
  <service id="morpho.mesa.services.acquisition.iris.evc.IrisAcquisitionEVCImplementation">
      <!-- type of device to use for iris capture:
        Possible values :
         - iCAMR100
         - BMT20
         - OneLook
      -->
      <device-type>iCAMR100</device-type>
  </service>

  <service id="morpho.mesa.services.acquisition.iris.evc.config.EVCConfigurationManager">
    <!-- ================= BMT20 Configuration ================= -->
    <device-configuration>
      <device-type>BMT20</device-type>

      <!-- EVC Parameter for BMT20 Quality Mode
          Available modes (ordered by increasing values for quality thresholds):
          - LOW
          - STD
          - SECURE
          - VERYSECURE
          For example, more acquired irises will be validated with 'LOW' mode than 'VERYSECURE' mode
     
        Default value: STD
      -->
      <parameter>
        <name>device.bmt20.qualityMode</name>
        <value>STD</value>
      </parameter>     
    </device-configuration>

    <!-- ================= iCAM R100 Configuration ================= -->
    <device-configuration>
      <device-type>iCAMR100</device-type>

      <!-- EVC Parameter for iCAMR100 Quality Mode
          Available modes (ordered by increasing values for quality thresholds):
          - LOW
          - STD
          - SECURE
          - VERYSECURE
          For example, more acquired irises will be validated with 'LOW' mode than 'VERYSECURE' mode
     
        Default value: STD
      -->
      <parameter>
        <name>device.icamr100.qualityMode</name>
        <value>STD</value>
      </parameter> 

      <!-- EVC Parameter for iCAMR100 Device volume 
          Possible values: any integer between 0 and 10
      -->
      <parameter>
        <name>device.icamr100.volume</name>
        <value>4</value>
      </parameter>

       <!-- EVC Parameter for iCAMR100 Device language 
          Possible values: 
           - ENGLISH
           - KOREAN
           - CHINESE
           - SPANISH
           - ARABIC
           - PORTUGUESE
           - RUSSIAN
           - GERMAN
           - FRENCH
           - TURKISH
           - JAPANESE
           - HINDI
           - OTHER
      -->
      <parameter>
        <name>device.icamr100.language</name>
        <value>ENGLISH</value>
      </parameter>
    </device-configuration>

    <!-- ================= OneLook Configuration ================= -->
    <device-configuration>
      <device-type>OneLook</device-type>

      <!-- EVC Parameter for OneLook IP Address -->
      <parameter>
        <name>device.onelook.ip</name>
        <value>127.0.0.1</value>
      </parameter>

      <!-- EVC Parameter for OneLook port -->
      <parameter>
        <name>device.onelook.port</name>
        <value>11099</value>
      </parameter>

      <!-- EVC Parameter for Onelook Quality Mode
      	Possible values :
         - EnrollMode (default)
         - VerifMode
      -->
      <parameter>
        <name>device.onelook.qualityMode</name>
        <value>EnrollMode</value>
      </parameter>
    </device-configuration>

  </service>

  <!-- *************************************** MESA EDOC DATA ACQUISITION ************************************************* -->
  <service id="morpho.mesa.business.edocreader.logic.EDocLogic">
    <!-- false to read only from scanned EDocument -->
    <read_from_chip>true</read_from_chip>
    <!-- MANUAL or AUTO -->
    <acquisition_mode>AUTO</acquisition_mode>
    <!-- true or false -->
    <read_mrz>true</read_mrz>
    <!-- true or false -->
    <read_visible_img_document>true</read_visible_img_document>
    <!-- true or false -->
    <read_ir_img_document>true</read_ir_img_document>
    <!-- true or false -->
    <read_uv_img_document>true</read_uv_img_document>
    <!-- true or false -->
    <read_coaxial_img_document>true</read_coaxial_img_document>
    <!-- true or false -->
    <read_document_cropped_portrait_img>true</read_document_cropped_portrait_img>
    <!-- true or false -->
    <read_portrait_img_chip>true</read_portrait_img_chip>
    <!-- true or false -->
    <read_signature_img_chip>true</read_signature_img_chip>
    <!-- true or false -->
    <store_document_cropped_portrait_img>true</store_document_cropped_portrait_img>
    <!-- true or false -->
    <store_mrz>true</store_mrz>
    <!-- true or false -->
    <store_portrait_img_chip>true</store_portrait_img_chip>
    <!-- true or false to store ir document image -->
    <store_ir_img_document>true</store_ir_img_document>
    <!-- true or false to store uv document image -->
    <store_uv_img_document>true</store_uv_img_document>
    <!-- true or false to store visible document image -->
    <store_visible_img_document>true</store_visible_img_document>
    <!-- true or false to store coaxial document image -->
    <store_coaxial_img_document>true</store_coaxial_img_document>
    <!-- type of compression for jpeg images
         Possible values are :
       - quality : Compression is based on specified quality parameter image_jpeg_compression_quality
       - maxsize : Compression is based on specified max size image_jpeg_compression_maxsize
       Default : quality
    -->
    <image_jpeg_compression_mode>quality</image_jpeg_compression_mode>
    <!-- JPEG image compression size in bytes. If the size is too small, image compression may fail. -->
    <image_jpeg_compression_maxsize>30000</image_jpeg_compression_maxsize>
    <!-- JPEG image compression quality. The value must be in the range [1;100] 
    Lower the compression quality value, higher is compressed the image and poorer is the quality -->
    <image_jpeg_compression_quality>90</image_jpeg_compression_quality>
    <!-- for jpeg2000 compression; maximal size is used -->
    <!-- JPEG200 image compression size in bytes. If the size is too small, image compression may fail.  -->
    <image_jpeg2000_compression_maxsize>30000</image_jpeg2000_compression_maxsize>
  </service> 


  <service id="morpho.mesa.business.edocreader.logic.ICAODocReaderLogic">
    <!-- type of compression for jpeg images
         Possible values are :
       - quality : Compression is based on specified quality parameter image_jpeg_compression_quality
       - maxsize : Compression is based on specified max size image_jpeg_compression_maxsize
       Default : quality
    -->
    <image_jpeg_compression_mode>quality</image_jpeg_compression_mode>
    <!-- JPEG image compression size in bytes. If the size is too small, image compression may fail. -->
    <image_jpeg_compression_maxsize>30000</image_jpeg_compression_maxsize>
    <!-- JPEG image compression quality. The value must be in the range [1;100] 
    Lower the compression quality value, higher is compressed the image and poorer is the quality -->
    <image_jpeg_compression_quality>90</image_jpeg_compression_quality>
    <!--
    Name of the document that is read. Must be unique among all documents read if several documents are read in the same procedure
    -->
    <documentName>ApplicantDocumentToIssue</documentName>
    <!--Device that must be used to read document
      Corresponds to the name of the physical device that will read the document, whether this device is a simple RFID reader
      or a composite reader that contains several internal sub-devices.
      For simple RFID readers, it is implicit that an additional MRZ swiper must be used to read MRZ.
      Possible values :
        B5000
        IDBOX_ONE
        DESKO_PENTA_SCANNER
        REGULA
        OMNIKEY_5X21_CONTACTLESS (corresponds to a simple RFID Reader OMNIKEY 5x21 family, actually only 5421, the contactless part)
      Default : IDBOX_ONE
    -->
    <deviceType>IDBOX_ONE</deviceType>
    <!--Sorted list of DG (Data Groups) to read in chip
      Each item must correspond exactly to a DG name.
      Supported values for item :
        DG1
        DG2
        DG3
        DG7
        DG11
        DG12
    -->
    <dataGroupsList>
      <item>DG1</item>
      <item>DG3</item>
      <item>DG12</item>
      <item>DG2</item>
      <item>DG11</item>
      <item>DG7</item>
    </dataGroupsList>
  </service> 


  <service id="morpho.mesa.services.acquisition.edoc.medocreader.EDocChipReadListener">
    <!--
      Site that must be used to import data (certificates, signed data) to use EAC protocol
      This value is the name of a site which definition is in the ImportSiteRepository section
    -->
    <siteForEAC>MORPHO-IS-ISSUANCE-FROM-EDOC</siteForEAC>
  </service> 


  <service id="morpho.mesa.business.edocreader.logic.P11DocReaderLogic">
    <!--
    Name of the document that is read. Must be unique among all documents read if several documents are read in the same procedure
    -->
    <documentName>ApplicantDocumentToIssue</documentName>
  </service> 


  <service id="default/P28P15DocIssuance/IDCardInfo/morpho.mesa.business.edocreader.logic.P11DocReaderLogic">
    <scriptFile>CONFIG/scripts-logic/NepalCardReader-logic.js</scriptFile>
  </service> 


  <service id="morpho.mesa.business.edocreader.logic.DocumentVisualControlLogic">
    <!--
    Name of the document to visualise
    -->
    <documentName>ApplicantDocumentToIssue</documentName>
    <scriptFile>CONFIG/scripts-logic/icaoVisualControl-logic.js</scriptFile>
    <!-- Enable or disable the biometric quality controls to check captured image
        - true  : enable biometric quality
        - false : disable biometric quality
        Default value : false
    -->
    <computeDocumentFaceBioQuality>true</computeDocumentFaceBioQuality>
    <!-- 
      Lower threshold, if the biometric score is below, the image is considered as of poor quality.
      Default value : 0
    -->
    <minDocumentFaceBioQualityThreshold>0</minDocumentFaceBioQualityThreshold>

    <!-- 
      High threshold, if the biometric score is above, the image is considered as of great quality.
      Default value : 100
    -->
    <maxDocumentFaceBioQualityThreshold>100</maxDocumentFaceBioQualityThreshold>
  </service> 


  <service id="morpho.mesa.business.edocreader.logic.SetPINLogic">
    <!--
    Name of the document that is read. Must be unique among all documents read if several documents are read in the same procedure
    -->
    <documentName>ApplicantDocumentToIssue</documentName>
  </service> 

  <service id="default/P28P15DocIssuance/SetPIN/morpho.mesa.business.edocreader.logic.SetPINLogic">
    <scriptFile>CONFIG/scripts-logic/NepalSetPIN-logic.js</scriptFile>
  </service> 

  <!-- EdocreaderForIssuance logic configuration for P23 procedure -->
  <service id="default/P23CentralPassportIssuance/PassportReading/morpho.mesa.business.edocreader.logic.ICAODocReaderLogic">
    <scriptFile>CONFIG/scripts-logic/edoc-reading-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/ICAODocReader-logic.js</scriptFile>
  </service> 


  <!-- EdocreaderForIssuance logic configuration for P24 procedure -->
  <service id="default/P24LocalPassportIssuance/PassportReading/morpho.mesa.business.edocreader.logic.ICAODocReaderLogic">
    <dataGroupsList>
      <item>DG1</item>
      <item>DG2</item>
      <item>DG3</item>
      <item>DG7</item>
      <item>DG11</item>
      <item>DG12</item>
    </dataGroupsList>
    <scriptFile>CONFIG/scripts-logic/edoc-reading-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/ICAODocReader-logic.js</scriptFile>
  </service> 


  <service id="default/P40PassportIssuanceMOD/PassportReading/morpho.mesa.business.edocreader.logic.ICAODocReaderLogic">
    <dataGroupsList>
      <item>DG1</item>
      <item>DG2</item>
      <item>DG3</item>
      <item>DG7</item>
      <item>DG11</item>
      <item>DG12</item>
    </dataGroupsList>
    <scriptFile>CONFIG/scripts-logic/edoc-reading-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/ICAODocReader-logic.js</scriptFile>
  </service> 


  <service id="default/P25RepresentativeIssuance/PassportReading/morpho.mesa.business.edocreader.logic.ICAODocReaderLogic">
    <scriptFile>CONFIG/scripts-logic/edoc-reading-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/ICAODocReader-logic.js</scriptFile>
  </service> 


 <service id="default/DocumentRenewal/Alpha/morpho.mesa.business.alpha.logic.AlphaLogic">
    <scriptFile>CONFIG/scripts-logic/alpha-logic.js</scriptFile>
  </service>

  <service id="default/DocumentReplacement/Alpha/morpho.mesa.business.alpha.logic.AlphaLogic">
    <scriptFile>CONFIG/scripts-logic/alpha-logic.js</scriptFile>
  </service>

  <service id="default/FirstEnrolmentProcedure/Alpha/morpho.mesa.business.alpha.logic.AlphaLogic">
    <scriptFile>CONFIG/scripts-logic/alpha-logic.js</scriptFile>
  </service>

  <service id="default/P25RepresentativeIssuance/Alpha/morpho.mesa.business.alpha.logic.AlphaLogic">
    <!--
    Name of set of demographics data managed by this logic (mandatory and must be unique among all demographics sets)
    -->
    <demographicsName>Representative</demographicsName>
  </service>
  
  <!-- EdocreaderForIssuance logic configuration for P27 procedure -->
  <service id="default/P27IDCardIssuance/IDCardInfo/morpho.mesa.business.edocreader.logic.ICAODocReaderLogic">
    <scriptFile>CONFIG/scripts-logic/ICAODocReader-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/edoc-reading-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/APDU-MOC-Citiz210.js</scriptFile>
    <readMocData>true</readMocData>
  </service> 


  <service id="default/P27IDCardIssuance/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MCS-REST-ISSUANCE-FROM-EDOC</site>
    <waitForResults>true</waitForResults>
    <timeoutForExportResult>15</timeoutForExportResult>
  </service> 


  <service id="default/P28P15DocIssuance/VisualControl/morpho.mesa.business.edocreader.logic.DocumentVisualControlLogic">
    <scriptFile>CONFIG/scripts-logic/NepalVisualControl-logic.js</scriptFile>
  </service> 


  <service id="default/P28P15DocIssuance/Issuance/morpho.mesa.business.issuance.logic.IssuanceLogic">
    <allowOverwriteIssuanceStatus>true</allowOverwriteIssuanceStatus>
    <documentName>ApplicantDocumentToIssue</documentName>
    <scriptFile>CONFIG/scripts-logic/NepalIssuance-step-logic.js</scriptFile>
  </service> 


  <service id="default/P28P15DocIssuance/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MCS-REST-ISSUANCE-FROM-EDOC</site>
    <waitForResults>true</waitForResults>
    <timeoutForExportResult>15</timeoutForExportResult>
  </service> 


  <!-- ******************************* MESA DATABASE LOCATION PARAMETERS *********************************************************
      Define the MESA database location setting to store all acquired data
  -->
  <service id="morpho.mesa.services.datastorage.jpa.JPADataStorageMgr">
    <javax.persistence.jdbc.url.1>jdbc:h2:file:C:/MesaStorage/MESA;MVCC=FALSE;MV_STORE=FALSE;AUTO_SERVER=FALSE;CACHE_SIZE=16384;MAX_LOG_SIZE=4;MAX_COMPACT_TIME=2000</javax.persistence.jdbc.url.1>
    <!-- define the binary data location (all bio images are stored in this location) -->
    <binaryDataLocation>C:/MesaStorage/Binaries</binaryDataLocation>
    <!-- Encryption key used for AES algorithm to encrypt binary data.
      This binaryDataAESEncryptionKey tag must not contain the key value, it must contain a reference to it mentioned in mesaPasswords.properties file-->
    <binaryDataAESEncryptionKey>binaryDataAESEncryptionKey</binaryDataAESEncryptionKey>
  </service> 

  <service id="morpho.mesa.services.datastorage.jpa.recovery.RecoveryDataStorageMgr">
    <!-- Enable database recovery service. Default value: true -->
    <enableDatabaseRecovery>true</enableDatabaseRecovery>
    <!-- Define the database name with its extension (must be coherent with jdbc url set in custo) 
         Default value: 'MESA.h2.db'. -->
    <databaseName>MESA.h2.db</databaseName>
    <!-- Define the location where the database is stored (must be coherent with jdbc url set in custo) 
         Default value: 'C:/MesaStorage'. -->
    <databaseLocation>C:/MesaStorage</databaseLocation>
    <!-- Define the location where to store the database copy (done in background).
         Each copy will override the previous one.
         Default value: 'C:/MesaStorage/Recovery'. -->
    <databaseCopyLocation>C:/MesaStorage/Recovery</databaseCopyLocation>
    <!-- .......................... Database Copy Trigger Configuration .......................... -->
    <!-- Enable database copy on MESA startup. Default value: true -->
    <databaseCopyOnMESAStartup>true</databaseCopyOnMESAStartup>
    <!-- Define time interval in minute to wait before each database copy
         If value = 0, regular database copy is disabled.
         Default value: 720 (12 hours) -->
    <timeBetweenDatabaseCopy>720</timeBetweenDatabaseCopy>
  </service> 


  <!-- ************************************* MESA CONFIGURATION LOGIC ************************************************************
      Specify the configuration for all logics used to define the data acquisition 
    E.g : - Fingerprint Logic
          - Portrait Logic
          - ScanPortrait Logic
          - Signature Logic 
          - Forms Copy Logic
          - Export Logic
          - Print IQS Logic
          - ....
  -->
  <!--################ FingersPrint Logic Configuration (for Fingers Data acquisition by optical block) ################-->
  <!-- 
        FingersPrint logic configuration for all new procedures that uses fingers capture step.
        It's possible to redefine configuration for a specific procedure : see bellow 
    -->
  <service id="morpho.mesa.business.fingerprint.logic.FingersLogic">
    <!-- name of the set of fingers managed by this logic 
        Default value : "" (then, mandatory parameter)
    -->
    <fingersDataName>fingers</fingersDataName>
    <!--acquisitionSequence
      this block contains all keys that describe the acquisition sequence, that is to say the list of biometric items to capture
      and in which order
    -->
    <acquisitionSequence>
      <!--acquisitionType : keyword that describes the type of acquisition.
      IMPORTANT : there are too ways to describe the acquisition sequence.
      1 : you may use of predefined sequence, using a reserved keyword. In such a case, it is important to notice that the way items 
          will be captured CANNOT be known at this configuration step. It depends on the hardware actually plugged.
          If you use a predefined sequence, the order of captures is driven through captureOrder and palmsFirstOrLast keys values
          Possible values :
              SLAP_RIGHT_FOUR
              SLAP_LEFT_FOUR
              SLAP_BOTH_THUMBS
              SLAP_BOTH_FOREFINGERS
              SLAP_BOTH_NO_THUMBS (all slap fingers except thumbs)
              SLAP_ALL
              ROLLED_ALL
              SLAP_ROLLED_ALL
              SLAP_ROLLED_PALM_ALL
              SLAP_ROLLED_PALM_LOWER
              SLAP_ROLLED_PALM_BUT_UPPER
              FLAT_TWO_FOREFINGERS_AMONG_ALL (2 forefingers by default, other fingers are skipped by default)
              FLAT_TWO_THUMBS_AMONG_ALL (2 thumbs by default, other fingers are skipped by default)
              FLAT_TWO_MIDDLEFINGERS_AMONG_ALL (2 middle fingers by default, other fingers are skipped by default)
      2 : you specify explicitly the sequence to do, by giving the list of capture names and the order of captures
          In such a case, set acquisitionType value to "capturesList" and add a <capturesList> section inside <acquisitionSequence scope.
          In this <capturesList> section, add, in the required order, an <item> section for each capture to do.
          Note : for the time being, this works only for a mono-finger device (such as MSO) and only flat finger names can be set, that is to say :              
            FLAT_RIGHT_THUMB
            FLAT_RIGHT_FORE
            FLAT_RIGHT_MIDDLE
            FLAT_RIGHT_RING
            FLAT_RIGHT_LITTLE
            FLAT_LEFT_THUMB
            FLAT_LEFT_FORE
            FLAT_LEFT_MIDDLE
            FLAT_LEFT_RING
            FLAT_LEFT_LITTLE
      Default value : SLAP_ALL
      -->
      <acquisitionType>SLAP_ALL</acquisitionType>
      <!-- capture order. 
          Important : meaningful only if acquisitionType value is not "CapturesList". 
          Exact capture order depends on acquisitionType value, captureOrder and palmsFirstOrLast.Please refer to customization guide
          to get all details about capture order.
          Possible values :
          UNCONSTRAINED : usually slaps then rolled fingers (palms first or last depending on palmsFirstOrLast value)
          CONSTRAINED_RIGHT_THEN_LEFT : usually right slaps then right rolled fingers then left slaps then left rolled fingers (palms first or last depending on palmsFirstOrLast value)
          CONSTRAINED_LEFT_THEN_RIGHT : usually left slaps then left rolled fingers then right slaps then right rolled fingers (palms first or last depending on palmsFirstOrLast value)
          Default value : UNCONSTRAINED
      -->
      <captureOrder>UNCONSTRAINED</captureOrder>
      <!-- Whether palms should be captured first or last (meaningful only if palms are to be captured and if acquisitionType value is not "CapturesList"). 
        Possible values :
          PALMS_FIRST : palms are captured first : before slaps and rolled fingers
          PALMS_LAST : palms are captured last : after slaps and rolled fingers
          Default value : PALMS_FIRST
      -->
      <palmsFirstOrLast>PALMS_FIRST</palmsFirstOrLast>
    </acquisitionSequence>
    <!-- capture mode.
    Please note that this mode is hardware dependent : all capture sensors do not support
    those 2 modes. Some support only AUTO, some support only MANUAL, some support both,
    some support MANUAL only for slaps but not for rolled.
    You must ensure that the mode you choose is compatible with the device you will use
    Possible values :
        AUTO   : sensor automatically detects when capture is taken, with no operator action
        MANUAL : an operator action is needed to trigger a capture. For rolled fingers, action triggers the beginning 
               of finger capture. The end of the rolling process is always automatical. This mode is not supported for rolled by MTOP device.
        Default value : AUTO
    -->
    <captureMode>AUTO</captureMode>
    <!-- resolution of captured images
    Please note that this is hardware dependent : all capture sensors do not support all resolutions.
    You must ensure that the resolution you choose is compatible with the device you will use 
    Possible values (unit is dot per inch) :
        500  : 500 dpi
        1000 : 1000 dpi       
        Default value : 500
    -->
    <captureResolution>500</captureResolution>
    <!-- Favor speed or quality during controls
    This, associated with securityControl parameter, determine the Failure To Enroll (FTE) rate
    See custo guide for details.
    Possible values :
        DISABLE_ALGORITHM (Important : in this case, segments are NEVER computed)
        FAVOR_SPEED
        INTERMEDIATE_FAST
        INTERMEDIATE
        FAVOR_QUALITY
        Default value : INTERMEDIATE
    -->
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <!-- Security level of the quality controls
    This, associated with speedVSQualityControl parameter, determine the Failure To Enroll (FTE) rate
    See custo guide for details.
    Possible values :
        NO_CONTROL
        LOW
        STANDARD
        SECURE
        VERY_SECURE
        Default value : STANDARD
    -->
    <securityControl>STANDARD</securityControl>
    <!-- Choose to keep templates (coding) from segments in datamodel objects in addition to CFV, which is already kept
	     Templates (coding) are used by formPrint for generating 2D barcode and QR code with fingerprint included
    Possible values :
        true  : templates are kept
        false : templates are not kept
        Default value : false
    -->
    <keepAdditionalTemplates>false</keepAdditionalTemplates>
    <!-- Format of templates
    Please note that this parameter is applicable only if keepAdditionalTemplates is set to true
    Possible values :
        ISO_19794_2_2005 : ISO template format
        ISO_19794_2_2005_CS : ISO_CS template format
        PKMAT : PKMAT format
        Default value : PKMAT
    -->
    <templateFormat>PKMAT</templateFormat>
    <!-- Determine if captured images must be kept in datamodel objects
        true  : captured image are kept
        false : captured image are not kept
        Default value : true
    -->
    <keepCapturedImages>true</keepCapturedImages>
    <!-- Determine if segment images must be kept in datamodel objects
        true  : segment images are kept
        false : segment images are not kept
        Default value : true
    -->
    <keepSegmentImages>true</keepSegmentImages>
    <!-- Compression format of stored images (captured images as well as segment images)
    Possible values :
        ISO_19794_4_2005 (not yet implemented)
        JP2K (mandatory if captureResolution is 1000)
        PNG
        RAW
        WSQ
        Default value : WSQ
    -->
    <storedImagesFormat>WSQ</storedImagesFormat>
    <!-- Following 4 parameters determine height and width of segmented image for flat, rolled and palm ones
    Value is in pixels
    a "0" value means : no constraint (system computes by itself sizes)
    Default value : 0 (unconstrained) for each
    -->
    <flatSegmentImageHeight>0</flatSegmentImageHeight>
    <flatSegmentImageWidth>0</flatSegmentImageWidth>
    <rolledSegmentImageHeight>0</rolledSegmentImageHeight>
    <rolledSegmentImageWidth>0</rolledSegmentImageWidth>
    <upperPalmSegmentImageHeight>0</upperPalmSegmentImageHeight>
    <upperPalmSegmentImageWidth>0</upperPalmSegmentImageWidth>
    <lowerPalmSegmentImageHeight>0</lowerPalmSegmentImageHeight>
    <lowerPalmSegmentImageWidth>0</lowerPalmSegmentImageWidth>
    <writersPalmSegmentImageHeight>0</writersPalmSegmentImageHeight>
    <writersPalmSegmentImageWidth>0</writersPalmSegmentImageWidth>
    <!--Defines if MESA shall give the Operator the ability to reassign an acquired rolled 
        finger to the correct position in case of sequence error is encountered.
        This parameter is applicable just for acquisition sequences witch contains
        SLAPS and ROLLED capture.
      true : A popup with misplaced print names will be displayed, and the operator can choose
             or not to reassign an acquired rolled finger to the correct position 
             in case of sequence error 
      false : No popup will be displayed in case of a sequence error.
    -->
    <misplacedCaptureCorrectionEnabled>true</misplacedCaptureCorrectionEnabled>
    <!--Minimum number of capture attempts with control errors to allow control bypass
    Algorithm : counter of errors is :
    * incremented when a "bypassable" control error is detected
    * reset each time a "non-bypassable" control error (e.g. bad number of fingers) is detected
    and each time control succeeds (no error detected)
    Default value : 3
    -->
    <bypassableControlErrorsNumber>3</bypassableControlErrorsNumber>
    <!-- Defines if the operaor must enter a reason if the capture is bypassed 
    Possible values :
      true  : the operator will be invited to select the reason .
      false : the opeator will not be invited to select the reason
    -->
    <enableBypassReason>true</enableBypassReason>
    <!-- management of device buzzer
    Possible values :
      AUTO : buzzer is automatically managed by acquisition service
      MANUAL : future use (do not use this value)
      DISABLED : buzzer is off
      Default value : AUTO
    -->
    <deviceBuzzerMode>AUTO</deviceBuzzerMode>
    <!-- Management of exception declaration mode.
      SIMPLIFIED : Only two statuses are available ("PRESENT" , "MISSING").
      FULL  : Four statuses are available in this mode ("PRESENT" - "BANDAGED" - "AMPUTATED" - "DAMAGED").
      Default value : FULL
    -->
    <exceptionCycle>FULL</exceptionCycle>
    <!-- Templates that should be used for fingerprint and palmprint summary pages
      Value must be a path to an HTML page
      Default value : no value (which means no template)
    -->
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/rolledAndFlatBothThumbs.html</fingerprintSummaryTemplate>
    <palmprintSummaryTemplate>../fingerprint/summaryTemplates/allPalms.html</palmprintSummaryTemplate>
    <!-- minNumberAvailableBiometricItems  : Defines the minimum number of biometric items included in the "acquisitionSequence" that are to be defined as available  -->
    <minNumberAvailableBiometricItems>0</minNumberAvailableBiometricItems>
    <!-- minNumberOfAcquisitionsToValidateStep : Defines the the minimum number of acquisitions to be done to have the print acquisition step completed .
    the default value is set to ALL : means that all prints will be acquired to complete the acquisition process (Exceptions included). 
    other possible values are upper to 0-->
    <minNumberOfAcquisitionsToValidateStep>ALL</minNumberOfAcquisitionsToValidateStep>
    <!-- minimumTimeBetweenTwoCaptures Defines the minimum time (in seconds) to wait between two captures -->
    <minimumTimeBetweenTwoCaptures>0</minimumTimeBetweenTwoCaptures>
    <!-- displayFingerGuide : Toggles the display of an cross overlay in the center of the capture area to help capture single fingerprints -->
    <displayFingerGuide>false</displayFingerGuide>
    <!-- The fingerGuideColor parameter allows to define the color of the finger guide.
    Possible values (Exhaustive list comes from java.awt.Color) : black, BLACK, blue, BLUE, cyan, CYAN, gray, GRAY, darkGray, DARK_GRAY, lightGray, LIGHT_GRAY,
                      green, GREEN, magenta, MAGENTA, orange, ORANGE, pink, PINK, red, RED, white, WHITE, yellow, YELLOW
    Default value : yellow -->
    <fingerGuideColor>yellow</fingerGuideColor>
    <!-- displayNFIQScore : define if the NFIQ score of the last captured finger will be displayed on the GUI -->
    <displayNFIQScore>false</displayNFIQScore>
    <scriptFile>CONFIG/scripts-logic/fingerprint-logic.js</scriptFile>
    <!-- processingTimeout 
    Maximum time, in milliseconds, allowed for processing status. Afterwards, script function onProcessingHanged() is called
    Default = 10000 
    -->
    <!--300000 ms here (5 minutes), which can be understood as "not activated"-->
    <processingTimeout>300000</processingTimeout>
    <keepPreviousFingerPrintData>true</keepPreviousFingerPrintData>
    <!--  define the priority acquisition sequence for Issuance procedure : UNCONSTRAINED or FORE_FIRST
      UNCONSTRAINED : document order
      FORE_FIRST : acquisition sequence defined : F,T,M,R and L
    -->
    <priorityAcquisitionSequence>UNCONSTRAINED</priorityAcquisitionSequence>
    <checkEnvironmentOptions>
      <checkFPDevices>true</checkFPDevices>
    </checkEnvironmentOptions>
    <!-- Choose to enable Juvenile Mode: If true, algorithms used to segment and code picture are specific to juvenile biometric items.
    The scriptFile parameter can be used to override the value of enableJuvenileMode according of the age of applicant.
      Possible values :
      true  : The juvenile Mode is enabled
      false : The juvenile Mode is not enabled
      Default value : false
    -->
    <enableJuvenileMode>false</enableJuvenileMode>
    <!-- If true, display a warning popup when device is detected as dirty 
      Default value : false 
    -->
    <displayPopupOnDeviceDirty>true</displayPopupOnDeviceDirty>
  </service>

     <!-- ************************************* MbopAcquisition Service *********************************************** -->
   <!-- This configuration deals with fingerprints acquisition service -->

  <service id="morpho.mesa.services.acquisition.print.mbop.MbopAcquisition">
  <!-- 
        The only supported Acquisition type by MWC are:
              - SLAP_RIGHT_FOUR
              - SLAP_LEFT_FOUR
              - SLAP_BOTH_NO_THUMBS 
  -->
      
  <!-- those tow params are used to set the ip address of MWC device
  -->
   <!-- technical key for the ip address in the service
        Default value: sensor.MaSigma.thrift.ip_candidates
    -->
   <!--<SensorMasigmaThriftIpCondidates>sensor.MaSigma.thrift.ip_candidates</SensorMasigmaThriftIpCondidates>-->
   <!--<ipAddresses>10.129.70.107</ipAddresses>-->
   
  </service>

  <!-- FingersPrint logic configuration for First Enrolment procedure -->
  <service id="default/FirstEnrolmentProcedure/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <acquisitionSequence>
    <acquisitionType>SLAP_ALL</acquisitionType>
    </acquisitionSequence>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/allFlatBothThumbs.html</fingerprintSummaryTemplate>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-Fingerprint-Logic.js</scriptFile>
    <keepAdditionalTemplates>true</keepAdditionalTemplates>
    <templateFormat>PROPRIETARY</templateFormat>
  </service>

  <!-- FingersPrint logic configuration for Document Renewal procedure -->
  <service id="default/DocumentRenewal/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <acquisitionSequence>
    <acquisitionType>SLAP_ALL</acquisitionType>
    </acquisitionSequence>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/allFlatBothThumbs.html</fingerprintSummaryTemplate>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-Fingerprint-Logic.js</scriptFile>
    <keepAdditionalTemplates>true</keepAdditionalTemplates>
    <templateFormat>PROPRIETARY</templateFormat>
  </service>

  <!-- FingersPrint logic configuration for Document Replacement procedure -->
  <service id="default/DocumentReplacement/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <acquisitionSequence>
    <acquisitionType>SLAP_ALL</acquisitionType>
    </acquisitionSequence>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/allFlatBothThumbs.html</fingerprintSummaryTemplate>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-Fingerprint-Logic.js</scriptFile>
    <keepAdditionalTemplates>true</keepAdditionalTemplates>
    <templateFormat>PROPRIETARY</templateFormat>
  </service>

  <!-- FingersPrint logic configuration for Police enrolment procedure -->
  <service id="default/PoliceEnrolmentProcedure/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <acquisitionSequence>
      <acquisitionType>SLAP_ROLLED_PALM_ALL</acquisitionType>
	  <palmsFirstOrLast>PALMS_LAST</palmsFirstOrLast>
    </acquisitionSequence>
    <captureMode>AUTO</captureMode>
    <captureResolution>1000</captureResolution>
    <speedVSQualityControl>FAVOR_SPEED</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>JP2K</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/rolledAndFlatBothThumbs.html</fingerprintSummaryTemplate>
    <scriptFile>CONFIG/scripts-logic/PoliceEnrolmentProcedure-Fingerprint-Logic.js</scriptFile>
  </service> 

  <!-- FingersPrint logic configuration for Multiple download sites procedure -->
  <service id="default/MultiImportSitesProcedure/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <acquisitionSequence>
      <acquisitionType>SLAP_ALL</acquisitionType>
      <captureOrder>CONSTRAINED_RIGHT_THEN_LEFT</captureOrder>
    </acquisitionSequence>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/allFlatSeparatedThumbs.html</fingerprintSummaryTemplate>
  </service> 

  <!-- FingersPrint logic configuration for Quick Identification procedure -->
  <service id="default/QuickIdentProcedure/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <acquisitionSequence>
      <acquisitionType>FLAT_TWO_FOREFINGERS_AMONG_ALL</acquisitionType>
      <captureOrder>CONSTRAINED_RIGHT_THEN_LEFT</captureOrder>
    </acquisitionSequence>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/allFlatSeparatedThumbs.html</fingerprintSummaryTemplate>
  </service> 

  <service id="default/FingerprintProcedure/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <acquisitionSequence>
      <acquisitionType>SLAP_ROLLED_PALM_ALL</acquisitionType>      
      <captureOrder>UNCONSTRAINED</captureOrder>
      <palmsFirstOrLast>PALMS_FIRST</palmsFirstOrLast>
    </acquisitionSequence>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepCapturedImages>true</keepCapturedImages>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <misplacedCaptureCorrectionEnabled>true</misplacedCaptureCorrectionEnabled>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <minNumberAvailableBiometricItems>0</minNumberAvailableBiometricItems>
    <enableBypassReason>true</enableBypassReason>
    <deviceBuzzerMode>AUTO</deviceBuzzerMode>
    <exceptionCycle>FULL</exceptionCycle>
    <minimumTimeBetweenTwoCaptures>0</minimumTimeBetweenTwoCaptures>
    <displayFingerGuide>false</displayFingerGuide>
    <fingerGuideColor>yellow</fingerGuideColor>
    <enableJuvenileMode>false</enableJuvenileMode>
    <displayPopupOnDeviceDirty>true</displayPopupOnDeviceDirty>
  </service> 

  <!-- Portrait logic configuration for CardScan Procedure -->
  <service id="default/CardScanProcedure/Portrait/morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <multipleImagesDataName>portraits</multipleImagesDataName>
    <photoDevices>
      <photoDevice>SCANNER-PHOTO-DEVICE</photoDevice>
    </photoDevices>
    <defaultDevice>SCANNER-PHOTO-DEVICE</defaultDevice>
	    <!-- The only card format supported currently is the Format1P-UA -->
<!--     <scanFormat>CONFIG/card-formats/Format3P.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/Format2P-UA.cfd</scanFormat> -->
    <scanFormat>CONFIG/card-formats/Format1P-UA.cfd</scanFormat>
    <!-- Name regarding mandatory scanned image, the value must refer as to the element id from card format (.icf) -->
    <nameOfMandatoryScannedImage>frontal</nameOfMandatoryScannedImage>
    <!-- <nameOfMandatoryScannedImage>right profile</nameOfMandatoryScannedImage> -->
    <!-- <nameOfMandatoryScannedImage>left profile</nameOfMandatoryScannedImage> -->
    <!-- <nameOfMandatoryScannedImage>angled</nameOfMandatoryScannedImage> -->
  </service>

  <service id="default/CardScanProcedure/Signature/morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <maxImagesToCapture>1</maxImagesToCapture>
    <multipleImagesDataName>signatures</multipleImagesDataName>
    <photoDevices>
      <photoDevice>SCANNER-PHOTO-DEVICE</photoDevice>
    </photoDevices>
    <defaultDevice>SCANNER-PHOTO-DEVICE</defaultDevice>
    <scanFormat>CONFIG/card-formats/SignatureUA.cfd</scanFormat>
    <nameOfMandatoryScannedImage>signature</nameOfMandatoryScannedImage>
  </service> 
 
  <!-- FingersPrint logic configuration for P21 procedure -->
  <service id="default/P21Issuance/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <keepPreviousFingerPrintData>false</keepPreviousFingerPrintData>
    <acquisitionSequence>
      <!--Empty parameter for dynamical determination of fingers to acquire-->
    </acquisitionSequence>
    <scriptFile>CONFIG/scripts-logic/issuanceFingerprint-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P21issuanceFingerprint-logic.js</scriptFile>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepCapturedImages>true</keepCapturedImages>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate />
    <palmprintSummaryTemplate />
  </service> 

  <!-- FingersPrint logic configuration for P23 procedure -->
  <service id="default/P23CentralPassportIssuance/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">

    <fingersDataName>fingers</fingersDataName>
    <keepPreviousFingerPrintData>false</keepPreviousFingerPrintData>
    <acquisitionSequence>
      <acquisitionType>capturesList</acquisitionType>
      <capturesList>
        <item>FLAT_RIGHT_FORE</item>
        <item>FLAT_LEFT_FORE</item>
      </capturesList>
    </acquisitionSequence>
    <scriptFile>CONFIG/scripts-logic/issuanceFingerprint-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P23issuanceFingerprint-logic.js</scriptFile>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepCapturedImages>true</keepCapturedImages>
    <keepSegmentImages>false</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate />
    <palmprintSummaryTemplate />
  </service> 

  <!-- FingersPrint logic configuration for P24 procedure -->
  <service id="default/P24LocalPassportIssuance/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <keepPreviousFingerPrintData>false</keepPreviousFingerPrintData>
    <acquisitionSequence>
      <!--Empty parameter for dynamical determination of fingers to acquire-->
    </acquisitionSequence>
    <scriptFile>CONFIG/scripts-logic/issuanceFingerprint-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P24issuanceFingerprint-logic.js</scriptFile>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepCapturedImages>true</keepCapturedImages>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate />
    <palmprintSummaryTemplate />
  </service> 

  <!-- FingersPrint logic configuration for P27 procedure -->
  <service id="default/P27IDCardIssuance/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <keepPreviousFingerPrintData>false</keepPreviousFingerPrintData>
    <acquisitionSequence>
      <!--Empty parameter for dynamical determination of fingers to acquire-->
    </acquisitionSequence>
    <scriptFile>CONFIG/scripts-logic/issuanceFingerprint-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/MOCissuanceFingerprint-logic.js</scriptFile>
    <captureMode>AUTO</captureMode>
    <captureResolution>500</captureResolution>
    <speedVSQualityControl>INTERMEDIATE</speedVSQualityControl>
    <securityControl>STANDARD</securityControl>
    <keepCapturedImages>true</keepCapturedImages>
    <keepSegmentImages>true</keepSegmentImages>
    <storedImagesFormat>WSQ</storedImagesFormat>
    <flatSegmentImageHeight>512</flatSegmentImageHeight>
    <flatSegmentImageWidth>400</flatSegmentImageWidth>
    <bypassableControlErrorsNumber>1</bypassableControlErrorsNumber>
    <fingerprintSummaryTemplate />
    <palmprintSummaryTemplate />
    <keepAdditionalTemplates>true</keepAdditionalTemplates>
    <templateFormat>ISO_19794_2_2005_CS</templateFormat>
  </service> 

  <service id="default/P28P15DocIssuance/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <scriptFile>CONFIG/scripts-logic/NepalFingerprint-logic.js</scriptFile>
    <fingersDataName>fingers</fingersDataName>
    <acquisitionSequence>SLAP_ALL</acquisitionSequence>
    <scriptFile>CONFIG/scripts-logic/issuanceFingerprint-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P28issuanceFingerprint-logic.js</scriptFile>
    <captureOrder>UNCONSTRAINED</captureOrder>
    <keepAdditionalTemplates>true</keepAdditionalTemplates>
    <templateFormat>ISO_19794_2_2005_CS</templateFormat>
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/allFlatBothThumbs.html</fingerprintSummaryTemplate>
    <keepPreviousFingerPrintData>false</keepPreviousFingerPrintData>
  </service> 

  <!--  FingersPrint logic configuration for P40 procedure -->
  <service id="default/P40PassportIssuanceMOD/Fingerprint/morpho.mesa.business.fingerprint.logic.FingersLogic">
    <fingersDataName>fingers</fingersDataName>
    <acquisitionSequence>SLAP_ALL</acquisitionSequence>
    <scriptFile>CONFIG/scripts-logic/issuanceFingerprint-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P40issuanceFingerprint-logic.js</scriptFile>
  </service>

  <service id="default/P40PassportIssuanceMOD/Portrait/morpho.mesa.business.portrait.logic.PortraitLogic">
    <portraitsDataName>portraits</portraitsDataName>
    <scriptFile>CONFIG/scripts-logic/issuancePortrait-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P40issuancePortrait-logic.js</scriptFile>
  </service>

  <!--For temporary tests-->
  <service id="default/P40PassportIssuanceMOD/Portrait2/morpho.mesa.business.portrait.logic.PortraitLogic">
    <portraitsDataName>portraits2</portraitsDataName>
    <scriptFile>CONFIG/scripts-logic/issuancePortrait-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P40issuancePortrait-logic.js</scriptFile>
  </service>

<!--###################################################################################################################-->
  <!--###################### Iris And Face Logic Configuration (for Iris and Face acquisition by live device)  ############################-->
  <!-- 
        Iris and Face logic configuration for all new procedures that uses Iris and face acquisition step.
        It's possible to redefine configuration for a specific procedure : see bellow 
    -->
  <service id="morpho.mesa.business.irisandface.logic.IrisAndFaceLogic">
    <irisesDataName>irises</irisesDataName>
    <faceDataName>face</faceDataName>
    
    <!-- Enable or disable the ICAO quality controls to check captured image
        - true  : enable ICAO
        - false : disable ICAO
        Default value : true
    -->
    <enableIcaoChecks>true</enableIcaoChecks>
    
    <!--portraits must contains only frontal portrait configuration:
      - it is mandatory for face acquisition
      
      List of attributes of portrait element are the following :
      - "name" : value must be unique in this "portrait" list
      - "type" : Possible values for type :
                  FRONT                  
      - "width" : width of the cropped portrait
      - "height" : height of the cropped portrait
      - "closeupMode" : set it to "manual" to define closeup ratio (default value is "auto")
      - "closeupRatio" : ratio between the number of pixels between eyes and the width of the image (between 2.8 and 4), default is 3.76
      - "angle" is optional (0 by default). If "angle" is set, it must be a value in degrees between -180 and 180
      - "mandatory" : true or false. It is optional. By default, it is mandatory
      - "portraitImageDescription" : id of an portraitImageDescription element. If not specified for the portrait, the one specified for the portraitLogic is used
    -->
    <portraits>
      <portrait>
        <name>frontal-1</name>
        <type>FRONT</type>
        <width>414</width>
        <height>512</height>
        <mandatory>true</mandatory>
      </portrait>
    </portraits>

    <portraitImageDescription>IMAGE-FORMAT-1</portraitImageDescription>
    
    <!-- Enable or disable the biometric quality controls to check captured image
        - true  : enable biometric quality
        - false : disable biometric quality
        Default value : false
    -->
    <computeIrisAndFaceBioQuality>true</computeIrisAndFaceBioQuality>

    <!-- lower threshold, if the biometric score is below, the image should be rejected (integer)
        Default value : 0
    -->
    <minIrisAndFaceBioQualityThreshold>0</minIrisAndFaceBioQualityThreshold>

    <!-- high threshold, if the biometric score is above, the image is validated (integer)
        Default value : 100
    -->
    <maxIrisAndFaceBioQualityThreshold>100</maxIrisAndFaceBioQualityThreshold>

    <!-- Defines if the operator must enter a reason if the capture is bypassed 
    Possible values :
      true  : the operator will be invited to select the reason
      false : the operator will not be invited to select the reason
    -->
    <enableBypassReason>true</enableBypassReason>
    <!-- Quality Criteria (enable / disable) -->
    <enableQualityCriteria>true</enableQualityCriteria>
    <!--Minimum number of capture attempts with control errors to allow control bypass
    Algorithm : counter of errors is :
    * incremented when a "bypassable" control error is detected
    * reset each time a "non-bypassable" control error
    Default value : 3
    -->
    <bypassableControlErrorsNumber>2</bypassableControlErrorsNumber>
    <!-- 
      Criteria that will be displayed , the possible values are
      Atropine,Concentricity,Daugman,Dilation,FakeLens,Focus,GazeAlignment,
      Global,GreyScaleLevel, HardLens,Interlace,IrisPupilContrast,
      IrisScleraContrast,Margin,Occlusion,PupilModulation,PupilShape
    -->
    <validationCriteria>Global,FakeLens,Atropine,IrisScleraContrast,IrisPupilContrast,Occlusion</validationCriteria>
    <!-- 
       Criteria to use for validation
     -->
    <crucialCriteria>Global</crucialCriteria>
    <!-- Choose to keep templates (coding) from Iris in datamodel objects
    Possible values :
        true  : templates are kept
        false : templates are not kept
        Default value : false
    -->
    <keepTemplates>false</keepTemplates>
    <!-- format of the processed images.
    Possible values are :
       - JPEG
       - JPEG2000
       - PNG
       - RAW
    -->
    <storedImagesFormat>JPEG</storedImagesFormat>
    <!-- type of compression for jpeg images
         Possible values are :
       - quality : Compression is based on specified quality parameter image_jpeg_compression_quality
       - maxsize : Compression is based on specified max size image_jpeg_compression_maxsize
       Default : quality
    -->
    <image_jpeg_compression_mode>quality</image_jpeg_compression_mode>
    <image_jpeg_compression_maxsize>30000</image_jpeg_compression_maxsize>
    <image_jpeg_compression_quality>90</image_jpeg_compression_quality>
    <image_jpeg2000_compression_maxsize>30000</image_jpeg2000_compression_maxsize>
    <!-- Compression level (between 0 and 9, 6 is the standard value). Used for PNG codec. -->
    <pngCompression>6</pngCompression>
  </service>

  <!--###################################################################################################################-->
  <!--###################### Iris Logic Configuration (for Iris acquisition by live device)  ############################-->
  <!-- 
        Iris logic configuration for all new procedures that uses Iris acquisition step.
        It's possible to redefine configuration for a specific procedure : see bellow 
    -->
  <service id="morpho.mesa.business.iris.logic.IrisLogic">
    <irisesDataName>irises</irisesDataName>
    <!-- Defines if the operator must enter a reason if the capture is bypassed 
    Possible values :
      true  : the operator will be invited to select the reason
      false : the operator will not be invited to select the reason
    -->
    <enableBypassReason>true</enableBypassReason>
    <!-- Quality Criteria (enable / disable) -->
    <enableQualityCriteria>true</enableQualityCriteria>
    
     <!-- Enable or disable the biometric quality controls to check captured image
        - true  : enable biometric quality
        - false : disable biometric quality
        Default value : false
    -->
    <displayIrisBioQuality>true</displayIrisBioQuality>

    <!-- lower threshold, if the biometric score is below, the image should be rejected. Supports values from 0 to 100 (integer)
        Default value : 0
    -->
    <minIrisBioQualityThreshold>95</minIrisBioQualityThreshold>

    <!-- high threshold, if the biometric score is above, the image is considered to be of good quality. Supports values from 0 to 100(integer)
        Default value : 100
    -->
    <maxIrisBioQualityThreshold>100</maxIrisBioQualityThreshold>
    
    <!--Minimum number of capture attempts with control errors to allow control bypass
    Algorithm : counter of errors is :
    * incremented when a "bypassable" control error is detected
    * reset each time a "non-bypassable" control error
    Default value : 3
    -->
    <bypassableControlErrorsNumber>2</bypassableControlErrorsNumber>
    <!-- 
      Criteria that will be displayed , the possible values are
      Atropine,Concentricity,Daugman,Dilation,FakeLens,Focus,GazeAlignment,
      Global,GreyScaleLevel, HardLens,Interlace,IrisPupilContrast,
      IrisScleraContrast,Margin,Occlusion,PupilModulation,PupilShape
    -->
    <validationCriteria>Global,FakeLens,Atropine,IrisScleraContrast,IrisPupilContrast,Occlusion</validationCriteria>
    <!-- 
       Criteria to use for validation
     -->
    <crucialCriteria>Global</crucialCriteria>
    <!-- Choose to keep templates (coding) from Iris in datamodel objects
    Possible values :
        true  : templates are kept
        false : templates are not kept
        Default value : false
    -->
    <keepTemplates>false</keepTemplates>
    <!-- format of the processed images.
    Possible values are :
       - JPEG
       - JPEG2000
       - PNG
       - RAW
    -->
    <storedImagesFormat>JPEG</storedImagesFormat>
    <!-- type of compression for jpeg images
         Possible values are :
       - quality : Compression is based on specified quality parameter image_jpeg_compression_quality
       - maxsize : Compression is based on specified max size image_jpeg_compression_maxsize
       Default : quality
    -->
    <image_jpeg_compression_mode>quality</image_jpeg_compression_mode>
    <image_jpeg_compression_maxsize>30000</image_jpeg_compression_maxsize>
    <image_jpeg_compression_quality>90</image_jpeg_compression_quality>
    <image_jpeg2000_compression_maxsize>30000</image_jpeg2000_compression_maxsize>
    <!-- Compression level (between 0 and 9, 6 is the standard value). Used for PNG codec. -->
    <pngCompression>6</pngCompression>
  </service> 

  <service id="default/IrisProcedure/Iris/morpho.mesa.business.iris.logic.IrisLogic">
    <enableQualityCriteria>true</enableQualityCriteria>
    <validationCriteria>Global,FakeLens,Atropine,IrisScleraContrast,IrisPupilContrast,Occlusion</validationCriteria>
    <crucialCriteria>Global</crucialCriteria>
    <bypassableControlErrorsNumber>2</bypassableControlErrorsNumber>
    <enableBypassReason>true</enableBypassReason>
    <storedImagesFormat>JPEG</storedImagesFormat>
    <image_jpeg_compression_mode>quality</image_jpeg_compression_mode>
    <image_jpeg_compression_maxsize>30000</image_jpeg_compression_maxsize>
    <image_jpeg_compression_quality>90</image_jpeg_compression_quality>
    <image_jpeg2000_compression_maxsize>30000</image_jpeg2000_compression_maxsize>
    <pngCompression>6</pngCompression>
  </service> 

  <!--###################################################################################################################-->
  <service id="default/FirstEnrolmentProcedure/FormPrint/morpho.mesa.business.formPrint.logic.FormPrintLogic">
    <availableTemplatesConfigSite>MESA-APPLICATION-RECEIPT</availableTemplatesConfigSite>
    <formsPath refSource="morpho.mesa.services.exporters.process.FileSystemSender/MESA-APPLICATION-RECEIPT" ref="/path" />
    <!-- Timeout in seconds for printing result. If no result after this time, stop waiting result
      Default : 15
    -->
    <timeoutForPrintingResult>60</timeoutForPrintingResult>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-FormPrint-logic.js</scriptFile>
  </service>

  <!--###################################################################################################################-->
  <service id="default/DocumentRenewal/FormPrint/morpho.mesa.business.formPrint.logic.FormPrintLogic">
    <availableTemplatesConfigSite>MESA-APPLICATION-RECEIPT</availableTemplatesConfigSite>
    <formsPath refSource="morpho.mesa.services.exporters.process.FileSystemSender/MESA-APPLICATION-RECEIPT" ref="/path" />
    <!-- Timeout in seconds for printing result. If no result after this time, stop waiting result
      Default : 15
    -->
    <timeoutForPrintingResult>60</timeoutForPrintingResult>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-FormPrint-logic.js</scriptFile>
  </service>

  <!--###################################################################################################################-->
  <service id="default/DocumentReplacement/FormPrint/morpho.mesa.business.formPrint.logic.FormPrintLogic">
    <availableTemplatesConfigSite>MESA-APPLICATION-RECEIPT</availableTemplatesConfigSite>
    <formsPath refSource="morpho.mesa.services.exporters.process.FileSystemSender/MESA-APPLICATION-RECEIPT" ref="/path" />
    <!-- Timeout in seconds for printing result. If no result after this time, stop waiting result
      Default : 15
    -->
    <timeoutForPrintingResult>60</timeoutForPrintingResult>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-FormPrint-logic.js</scriptFile>
  </service>

  <!--###################################################################################################################-->
  <!--###################################################################################################################-->
  <!-- set the configuration of devices to be used for portrait acquisition  
      Possible types : 
              - webcam : all webcams supported by windows
              - canon_eos : canon digital EOS (Rebel) Reflex cameras
              - scanner : all flat scanners supported by windows EXCEPT Brother DS-620
              - BrotherDS620 : specific type for scanner Brother DS-620
              - monoVirtual : mono virtual device for testing
              - android : android camera such as samsung galaxy
      
  -->
  <service id="morpho.mesa.common.configuration.photodevices.PhotoDeviceRepository">
    <photoDevice>
      <id>WEBCAM-DEFAULT-PHOTO-DEVICE</id>
      <!-- index of the device to be used if several device of the same type is 
           connected to the computer -->
      <index>0</index>
      <type>webcam</type>
      <!-- Mirror effect on LIVE
          It must be one of the following integer:
              - 0 : OFF,
              - 1 : ON. -->
      <mirror>0</mirror>
      <!-- orientation of the device.
           It must be one of the following integers:
            - 0 : No rotation (horizontal image),
            - 1 : Left rotation (vertical image) ,
            - 2 : Right rotation (vertical image),
            - 3 : 180° rotation (horizontal image). -->
      <orientation>0</orientation>
    </photoDevice>
    <photoDevice>
      <id>ID-STUDIO-V1-DEVICE</id>
      <type>idstudio</type>
      <lasink>true</lasink>
      <!-- lasinkProperties value will be considered if and only if lasink is set to true. -->
	  <!-- The image dimensions can be configured on the service: morpho.mesa.business.portrait.logic.PortraitLogic, the recommended values are: width=1656 and height=2048. -->
      <lasinkProperties>
				<zoom>100</zoom>                        
				<focus>auto</focus>                        
				<exposure>manual</exposure>                        
				<whitebalance>auto</whitebalance>                        
				<resolution>0</resolution>                        
				<flashMinPeak>820</flashMinPeak>                        
				<flashMaxPeak>870</flashMaxPeak>                        
				<flashThresholdToggle>660</flashThresholdToggle>                        
				<flashRerCount>10</flashRerCount>                        
				<flashRerDuration>20</flashRerDuration>                        
				<flashRerIdleDuration>25</flashRerIdleDuration>                        
				<flashMode>red_eyes</flashMode>                        
				<compression>0</compression>                                                
        <rotation>1</rotation>
				<expComp>0</expComp>                        
				<liveAuto>1</liveAuto> 
        <mirror>0</mirror>
        <iso>640</iso>
        <tv>0.008</tv>
        <av>10</av>
        <flashDuration>700</flashDuration>
      </lasinkProperties>
    </photoDevice>

    <photoDevice>
      <id>ID-STUDIO-V2-DEVICE</id>
      <type>idstudioV2</type>
      <lasink>true</lasink>
      <!-- lasinkProperties value will be considered if and only if lasink is set to true. -->
      <!-- The image dimensions can be configured on the service: morpho.mesa.business.portrait.logic.PortraitLogic. -->
      <lasinkProperties>
          <rotation>2</rotation>
          <resolution>0</resolution>  
          <liveAuto>0</liveAuto> 
          <compression>0</compression>
          <expComp>0</expComp> 
          <whitebalance>auto</whitebalance>
          <focus>auto</focus> 
          <flashRerDuration>20</flashRerDuration>
          <flashRerCount>10</flashRerCount>
          <flashDuration>800</flashDuration>
          <flashRerIdleDuration>25</flashRerIdleDuration> 
          <iso>800</iso>            
          <tv>0.008</tv>    
          <av>10</av>
          <flashMode>red_eyes</flashMode>
          <focusStep>1</focusStep><!-- Focus_step-->
          <zoomMove>8/60</zoomMove> <!-- Zoom_Move-->
          <flashRerDelay>500</flashRerDelay> <!-- Flash_rer_delay-->
          <flashShutterDelay>25</flashShutterDelay> <!-- Flash_shutter_delay-->
          <flashShutterFocusIdleDelay>0</flashShutterFocusIdleDelay> <!-- .Flash_Shutter_Focus_Idle_Delay-->
      </lasinkProperties>
    </photoDevice>
  
    <photoDevice>
      <id>CANON_EOS-PHOTO-DEVICE</id>
      <type>canon_eos</type>
      <!-- Mirror effect on LIVE
          It must be one of the following integer:
              - 0 : OFF,
              - 1 : ON. -->
      <mirror>0</mirror>
      <!-- orientation of the debice.
           It must be one of the following integers:
            - 0 : No rotation (horizontal image),
            - 1 : Left rotation (vertical image) ,
            - 2 : Right rotation (vertical image),
            - 3 : 180° rotation (horizontal image). -->
      <orientation>0</orientation>
      <lasink>false</lasink>
      <!-- lasinkProperties value will be considered if and only if lasink is set to true. -->
      <lasinkProperties>
        <iso>100</iso>
        <tv>0.004</tv>
        <av>5.6</av>
        <whitebalance>auto</whitebalance>
        <resolution>0</resolution>
      </lasinkProperties>
    </photoDevice>
    <!-- <photoDevice>
      <id>ICAMR100-PHOTO-DEVICE</id>
      <type>irisDevice</type>
    </photoDevice> -->
    <!-- <photoDevice>
      <id>ONELOOK-PHOTO-DEVICE</id>
      <type>irisDevice</type>
    </photoDevice> -->
    <photoDevice>
      <id>SCANNER-PHOTO-DEVICE</id>
      <type>scanner</type>
      <!-- List of available resolutions in pixels per inch -->
      <availableScanResolution>300</availableScanResolution>
      <availableScanResolution>600</availableScanResolution>
      <!--default resolution in pixels per inch -->
      <defaultScanResolution>300</defaultScanResolution>
    </photoDevice>
    <photoDevice>
      <id>BROTHER-PHOTO-DEVICE</id>
      <type>BrotherDS620</type>
      <!-- List of available resolutions in pixels per inch -->
      <availableScanResolution>300</availableScanResolution>
      <availableScanResolution>600</availableScanResolution>
      <!--default resolution in pixels per inch -->
      <defaultScanResolution>300</defaultScanResolution>
    </photoDevice>
    <photoDevice>
      <id>MONOVIRTUAL-PHOTO-DEVICE</id>
      <type>monoVirtual</type>
      <!-- orientation of the device.
           It must be one of the following integers:
            - 0 : No rotation (horizontal image),
            - 1 : Left rotation (vertical image) ,
            - 2 : Right rotation (vertical image),
            - 3 : 180° rotation (horizontal image). -->
      <orientation>0</orientation>
      <!-- relative path of a image on disk to simulate device acquisition -->
      <stubImageRelativePath>\StubData\StubPortraitImage.jpg</stubImageRelativePath>
    </photoDevice>
    <photoDevice>
      <id>ANDROID-PHOTO-DEVICE</id>
      <type>android</type>
      <!-- Mirror effect on LIVE
          It must be one of the following integer:
              - 0 : OFF,
              - 1 : ON. -->
      <mirror>0</mirror>
      <!-- orientation of the device.
           It must be one of the following integers:
            - 0 : No rotation (horizontal image),
            - 1 : Left rotation (vertical image) ,
            - 2 : Right rotation (vertical image),
            - 3 : 180° rotation (horizontal image). -->
      <orientation>0</orientation>
      <!-- flash mode default value 
            Possible values are :
              - 0 : OFF
              - 2 : AUTO -->
      <defaultFlashMode>0</defaultFlashMode>
      <!-- Value of the optical zoom. Possible values between 0 and 100 -->
      <defaultZoomValue>0</defaultZoomValue>
    </photoDevice>
    <photoDevice>
      <id>IDS-PHOTO-DEVICE</id>
      <type>ids</type>
      <!-- orientation of the device.
           It must be one of the following integers:
            - 0 : No rotation (horizontal image),
            - 1 : Left rotation (vertical image) ,
            - 2 : Right rotation (vertical image),
            - 3 : 180° rotation (horizontal image). -->
      <orientation>0</orientation>
    </photoDevice>
    <photoDevice>
      <id>FILEIMPORT-PHOTO-DEVICE</id>
      <type>file</type>
    </photoDevice>
  </service> 

  <service id="morpho.mesa.common.configuration.PortraitImageDescriptionRepository">
    <!--Description of a portrait image, that is to say the resulting cropped image-->
    <portraitImageDescription>
      <id>IMAGE-FORMAT-1</id>
      <!-- GUIImageFormat is the format of portrait image displayed on GUI (after cropping for face portraits and before cropping for other portraits)
      Usually JPEG is fine but if some editing must be done, BMP may be set instead
         - JPEG
         - BMP
      -->
      <GUIImageFormat>JPEG</GUIImageFormat>
      <!-- storedImageFormat is the format of portrait image stored in database
      Possible values are :
         - JPEG
         - JPEG2000
         - BMP
      -->
      <storedImageFormat>JPEG</storedImageFormat>
      <!-- type of compression for jpeg images
         Possible values are :
       - quality : Compression is based on specified quality parameter image_jpeg_compression_quality
       - maxsize : Compression is based on specified max size image_jpeg_compression_maxsize
       Default : quality
    -->
      <image_jpeg_compression_mode>quality</image_jpeg_compression_mode>
      <!-- JPEG image compression size in bytes. If the size is too small, image compression may fail. -->
      <image_jpeg_compression_maxsize>30000</image_jpeg_compression_maxsize>
      <!-- JPEG image compression quality. The value must be in the range [1;100] 
           Lower the compression quality value, higher is compressed the image and poorer is the quality 
      -->
      <image_jpeg_compression_quality>90</image_jpeg_compression_quality>
      <!-- type of compression for jpeg2000 image
      Possible values are :
         - quality : compression level will be customized with a quality level 
         - maxsize : compression level will be customized with a maximum compressed buffer size 
      -->
      <image_jpeg2000_compression_mode>maxsize</image_jpeg2000_compression_mode>
      <!-- JPEG2000 image compression size in bytes. If the size is too small, image compression may fail. -->
      <image_jpeg2000_compression_maxsize>50000</image_jpeg2000_compression_maxsize>
      <!-- JPEG2000 image compression quality. The value must be in the range [1;100] 
           Lower the compression quality value, higher is compressed the image and poorer is the quality 
      -->
      <image_jpeg2000_compression_quality>90</image_jpeg2000_compression_quality>
    </portraitImageDescription>
  </service> 

  <!--################ Portrait Logic Configuration (for Portrait Data acquisition by live device) ######################-->
  <!-- 
          Portrait logic configuration for all new procedures that uses portrait capture step (Live device : APN or Webcam)
          It's possible to redefine configuration for a specific procedure : see bellow 
    -->
  <service id="morpho.mesa.business.portrait.logic.PortraitLogic">
    <!-- list of photoDevices <photoDevice> -->
    <photoDevices>
      <!--photoDevice>ANDROID-PHOTO-DEVICE</photoDevice-->
      <photoDevice>WEBCAM-DEFAULT-PHOTO-DEVICE</photoDevice>
      <photoDevice>CANON_EOS-PHOTO-DEVICE</photoDevice>
      <photoDevice>FILEIMPORT-PHOTO-DEVICE</photoDevice>
      <!--photoDevice>IDS-PHOTO-DEVICE</photoDevice-->
      <photoDevice>SCANNER-PHOTO-DEVICE</photoDevice>
      <!--photoDevice>BROTHER-PHOTO-DEVICE</photoDevice-->
      <photoDevice>ID-STUDIO-V1-DEVICE</photoDevice>
      <photoDevice>ID-STUDIO-V2-DEVICE</photoDevice>
    </photoDevices>
    
    <scanFormat>CONFIG/card-formats/PortraitUA.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A4Portrait.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A5Portrait.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A6Portrait.cfd</scanFormat>
    
    <!--supported extensions for files. Used as a filter to choose files-->
    <supportedFileExtensions>
      <fileExtension>jpg</fileExtension>
      <fileExtension>jpeg</fileExtension>
      <fileExtension>bmp</fileExtension>
    </supportedFileExtensions>

    <portraitImageDescription>IMAGE-FORMAT-1</portraitImageDescription>
	
	<!-- Continue with manual cropping if eyes not found or in case of bad positioning. -->
    <enableManualCroppingWhenEyesNotDetected>false</enableManualCroppingWhenEyesNotDetected>

    <enableFreePhotoPositionning>false</enableFreePhotoPositionning>
    <strictAcquisitionOrder>true</strictAcquisitionOrder>


    <!-- Enable or disable the ICAO quality controls to check captured image
        - true  : enable ICAO
        - false : disable ICAO
        Default value : true
    -->
    <enableIcaoChecks>true</enableIcaoChecks>

    <!-- Enable or disable the biometric quality controls to check captured image
        - true  : enable biometric quality
        - false : disable biometric quality
        Default value : false
    -->
    <computeFaceBioQuality>true</computeFaceBioQuality>

    <!-- lower threshold, if the biometric score is below, the image should be rejected (integer)
        Default value : 0
    -->
    <minFaceBioQualityThreshold>0</minFaceBioQualityThreshold>

    <!-- high threshold, if the biometric score is above, the image is validated (integer)
        Default value : 100
    -->
    <maxFaceBioQualityThreshold>100</maxFaceBioQualityThreshold>

    <!-- Enable to auto realign the eyes horizontally if the head is tilted
       - true  : enable auto realign
       - false : disable auto realign
       Default value : false
	-->
    <enableAutoRealignEyesHorizontally>false</enableAutoRealignEyesHorizontally>
    <!-- name of the set of portrait managed by this logic 
         Default value : "" (then, mandatory parameter)
    -->
    <portraitsDataName>portraits</portraitsDataName>

    <!--portraits contains :
      - a list of portraits to be defined for each procedure with <portrait></portrait> tag.
      
      List of attributes of portrait element are the following :
      - "name" : value must be unique in this "portrait" list
      - "type" : Possible values for type :
                  FRONT,
                  RIGHT_PROFILE,
                  LEFT_PROFILE,
                  ANGLED,
                  FULL_BODY
      - "width" : width of the cropped portrait
      - "height" : height of the cropped portrait
      - "closeupMode" : set it to "manual" to define closeup ratio (default value is "auto")
      - "closeupRatio" : ratio between the number of pixels between eyes and the width of the image (between 2.8 and 4), default is 3.76
      - "angle" is optional (0 by default). If "angle" is set, it must be a value in degrees between -180 and 180
      - "mandatory" : true or false. It is optional. By default, it is mandatory
      - "portraitImageDescription" : id of an portraitImageDescription element. If not specified for the portrait, the one specified for the portraitLogic is used
    -->
    <portraits>
      <portrait>
        <name>frontal</name>
        <type>FRONT</type>
         <width>414</width>
        <height>512</height>
        <!--closeupMode>manual</closeupMode-->
        <!--closeupRatio>3</closeupRatio-->
      </portrait>
    </portraits>  
  </service> 

  <service id="morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <!-- name of the set of documents managed by this logic 
         Default value : "" (then, mandatory parameter)
    -->
    <multipleImagesDataName />
    <!-- list of photoDevices <photoDevice> -->
    <photoDevices>
      <photoDevice>WEBCAM-DEFAULT-PHOTO-DEVICE</photoDevice>
      <photoDevice>CANON_EOS-PHOTO-DEVICE</photoDevice>
      <photoDevice>SCANNER-PHOTO-DEVICE</photoDevice>
      <photoDevice>FILEIMPORT-PHOTO-DEVICE</photoDevice>
      <photoDevice>BROTHER-PHOTO-DEVICE</photoDevice>

    </photoDevices>
    <!--supported extensions for files. Used as a filter to choose files-->
    <supportedFileExtensions>
      <fileExtension>jpg</fileExtension>
      <fileExtension>jpeg</fileExtension>
      <fileExtension>bmp</fileExtension>
      <fileExtension>png</fileExtension>
    </supportedFileExtensions>
    <!-- set the default device to be active when loading the step
         give the id of the device defined either inside photoDevices or FILE for file import -->
    <defaultDevice>WEBCAM-DEFAULT-PHOTO-DEVICE</defaultDevice>
    <!-- format of the processed images.
         Possible values are :
           - JPEG
           - JPEG2000
           - BMP
    -->
    <imageFormat>JPEG</imageFormat>
    <!-- type of compression for jpeg images
         Possible values are :
       - quality : Compression is based on specified quality parameter image_jpeg_compression_quality
       - maxsize : Compression is based on specified max size image_jpeg_compression_maxsize
       Default : quality
    -->
    <image_jpeg_compression_mode>quality</image_jpeg_compression_mode>
    <!-- JPEG image compression size in bytes. If the size is too small, image compression may fail. -->
    <image_jpeg_compression_maxsize>30000</image_jpeg_compression_maxsize>
    <!-- JPEG image compression quality. The value must be in the range [1;100] 
    Lower the compression quality value, higher is compressed the image and poorer is the quality -->
    <image_jpeg_compression_quality>90</image_jpeg_compression_quality>
    <!-- for jpeg2000 compression;maxsize is used -->
    <!-- JPEG200 image compression size in bytes. If the size is too small, image compression may fail.  -->
    <image_jpeg2000_compression_maxsize>30000</image_jpeg2000_compression_maxsize>
    <!-- Give the possibility in the GUI to proceed to rotation of the cropping box -->
    <enableRotation>false</enableRotation>
    <!-- enable or disable displaying cropping boxes -->
    <displayCropBox>true</displayCropBox>
    <!-- Minimum number of images to be acquired, default value = 1 -->
    <minNumberOfImagesToAcquire>1</minNumberOfImagesToAcquire>
  </service> 

  <service id="morpho.mesa.business.portrait.logic.SimultaneousPortraitsLogic">
    <!-- list of photoDevices <photoDevice> -->
    <photoDevices>
	  <photoDevice>CANON_EOS-PHOTO-DEVICE</photoDevice>
      <photoDevice>WEBCAM-DEFAULT-PHOTO-DEVICE</photoDevice>
    </photoDevices>
	
	<!-- mapping between device identifier and portrait type to acquire
	     by default it is preferable to keep this list empty
		 in this case de device used the first detected (index = 0 )
		 the tag to use is devicePortraitMapper
		 so many devicePortraitMapper as the desired mapping
		 <devicePortraitMapper>
		   <portraitType></portraitType>
		   <deviceIdentifier></deviceIdentifier>
		 </devicePortraitMapper>
	-->
    
    <!--supported extensions for files. Used as a filter to choose files-->
    <supportedFileExtensions>
      <fileExtension>jpg</fileExtension>
      <fileExtension>jpeg</fileExtension>
      <fileExtension>bmp</fileExtension>
      <fileExtension>png</fileExtension>
    </supportedFileExtensions>

    <portraitImageDescription>IMAGE-FORMAT-1</portraitImageDescription>

    <enableFreePhotoPositionning>false</enableFreePhotoPositionning>
    <strictAcquisitionOrder>true</strictAcquisitionOrder>


    <!-- Enable or disable the ICAO quality controls to check captured image
        - true  : enable ICAO
        - false : disable ICAO
        Default value : true
    -->
    <enableIcaoChecks>true</enableIcaoChecks>

    <!-- Enable or disable the biometric quality controls to check captured image
        - true  : enable biometric quality
        - false : disable biometric quality
        Default value : false
    -->
    <computeFaceBioQuality>true</computeFaceBioQuality>

    <!-- lower threshold, if the biometric score is below, the image should be rejected (integer)
        Default value : 0
    -->
    <minFaceBioQualityThreshold>0</minFaceBioQualityThreshold>

    <!-- high threshold, if the biometric score is above, the image is validated (integer)
        Default value : 100
    -->
    <maxFaceBioQualityThreshold>100</maxFaceBioQualityThreshold>

    <!-- Enable to auto realign the eyes horizontally if the head is tilted
       - true  : enable auto realign
       - false : disable auto realign
       Default value : false
	-->
    <enableAutoRealignEyesHorizontally>false</enableAutoRealignEyesHorizontally>
    <!-- name of the set of portrait managed by this logic 
         Default value : "" (then, mandatory parameter)
    -->
    <portraitsDataName>portraits</portraitsDataName>

    <!--portraits contains :
      - a list of portraits to be defined for each procedure with <portrait></portrait> tag.
      
      List of attributes of portrait element are the following :
      - "name" : value must be unique in this "portrait" list
      - "type" : Possible values for type :
                  FRONT,
                  RIGHT_PROFILE,
                  LEFT_PROFILE,
      - "width" : width of the cropped portrait
      - "height" : height of the cropped portrait
      - "closeupMode" : set it to "manual" to define closeup ratio (default value is "auto")
      - "closeupRatio" : ratio between the number of pixels between eyes and the width of the image (between 2.8 and 4), default is 3.76
      - "mandatory" : true or false. It is optional. By default, it is mandatory
      - "portraitImageDescription" : id of an portraitImageDescription element. If not specified for the portrait, the one specified for the portraitLogic is used
    -->
    <portraits>
      <portrait>
        <name>frontal</name>
        <type>FRONT</type>
         <width>414</width>
        <height>512</height>
        <!--closeupMode>manual</closeupMode-->
        <!--closeupRatio>3</closeupRatio-->
      </portrait>
    </portraits>  
  </service> 

  <service id="default/FirstEnrolmentProcedure/DocumentCopies/morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <multipleImagesDataName>documents</multipleImagesDataName>
    <scanFormat>CONFIG/card-formats/A4Document.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A5Document.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A6Document.cfd</scanFormat>
  </service>

  <service id="default/DocumentRenewal/DocumentCopies/morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <multipleImagesDataName>documents</multipleImagesDataName>
    <scanFormat>CONFIG/card-formats/A4Document.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A5Document.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A6Document.cfd</scanFormat>
  </service>

  <service id="default/DocumentReplacement/DocumentCopies/morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <multipleImagesDataName>documents</multipleImagesDataName>
    <scanFormat>CONFIG/card-formats/A4Document.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A5Document.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A6Document.cfd</scanFormat>
  </service>

  <service id="default/DocumentCopiesProcedure/DocumentCopies/morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <multipleImagesDataName>documents</multipleImagesDataName>
    <scanFormat>CONFIG/card-formats/A4Document.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A5Document.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A6Document.cfd</scanFormat>
  </service> 

  <service id="default/SMTProcedure/Smt/morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <multipleImagesDataName>smt</multipleImagesDataName>
    <enableRotation>true</enableRotation>
    <scanFormat>CONFIG/card-formats/A4SMT.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A5SMT.cfd</scanFormat>
    <scanFormat>CONFIG/card-formats/A6SMT.cfd</scanFormat>
  </service> 

  <service id="morpho.mesa.business.barcode.logic.BarcodeReadingLogic">
    <!-- List of Devices <BarcodeDevice> 
         Note: the first device defined will be the default one
         Possible values for <type> : BARCODE_READER or IMAGE_FILE
    -->
    <barcodeDevices>
      <barcodeDevice>
        <type>BARCODE_READER</type>
      </barcodeDevice>
      <barcodeDevice>
        <type>IMAGE_FILE</type>
      </barcodeDevice>
    </barcodeDevices>
    <!--For IMAGE_FILE device:-->
    <!--supported extensions for files. Used as a filter to choose files-->
    <supportedFileExtensions>
      <!-- the formats listed here are the only ones supported by the current version MESA -->
      <fileExtension>jpg</fileExtension>
      <fileExtension>jpeg</fileExtension>
      <fileExtension>bmp</fileExtension>
      <fileExtension>png</fileExtension>
    </supportedFileExtensions>
  </service> 

  <service id="default/P21Issuance/2DBarcode/morpho.mesa.business.barcode.logic.BarcodeReadingLogic">
    <scriptFile>CONFIG/scripts-logic/P21-barcode-reading-logic.js</scriptFile>
    <!--
        Name of sets of data managed by this logic.
        Mandatory and must be unique among all demographics sets and all biometrics templates
        set, since it is used to identify the demographics set extracted from 2D barcode and finger templates set extracted 
        from the same 2D barcode
    -->
    <dataName>ApplicantReceipt</dataName>
  </service> 

  <service id="default/P40PassportIssuanceMOD/2DBarcode/morpho.mesa.business.barcode.logic.BarcodeReadingLogic">
    <scriptFile>CONFIG/scripts-logic/P21-barcode-reading-logic.js</scriptFile>
    <site>DOCUMENT_STATUS</site>    
    <!--
        Name of sets of data managed by this logic.
        Mandatory and must be unique among all demographics sets and all biometrics templates
        set, since it is used to identify the demographics set extracted from 2D barcode and finger templates set extracted 
        from the same 2D barcode
    -->
    <dataName>ApplicantReceipt</dataName>
  </service>

  <service id="default/P40PassportIssuanceMOD/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MCS-REST-ISSUANCE-FROM-RECEIPT</site>
    <waitForResults>true</waitForResults>
    <timeoutForExportResult>15</timeoutForExportResult>
  </service>

  <!-- Portrait logic configuration for First Enrolment procedure -->
  <service id="default/FirstEnrolmentProcedure/Portrait/morpho.mesa.business.portrait.logic.PortraitLogic">
    <enableIcaoChecks>true</enableIcaoChecks>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-Portrait-Logic.js</scriptFile>
	 <portraits>
	 <!-- The image dimensions recommended for the IdStudio_V2 are: width=1656 and height=2048. for Canon EOS and Webcam you can use the following values <width>414</width> <height>512</height>-->
      <portrait>
        <name>frontal</name>
        <type>FRONT</type>
         <width>1656</width>
        <height>2048</height>
      </portrait>
    </portraits> 
	
  </service>

  <!-- Portrait logic configuration for Document Renewal procedure -->
  <service id="default/DocumentRenewal/Portrait/morpho.mesa.business.portrait.logic.PortraitLogic">
    <enableIcaoChecks>true</enableIcaoChecks>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-Portrait-Logic.js</scriptFile>
	<portraits>
	 <!-- The image dimensions recommended for the IdStudio_V2 are: width=1656 and height=2048. for Canon EOS and Webcam you can use the following values <width>414</width> <height>512</height>-->
      <portrait>
        <name>frontal</name>
        <type>FRONT</type>
         <width>1656</width>
        <height>2048</height>
      </portrait>
    </portraits> 
  </service>

  <!-- Portrait logic configuration for Document Replacement procedure -->
  <service id="default/DocumentReplacement/Portrait/morpho.mesa.business.portrait.logic.PortraitLogic">
    <enableIcaoChecks>true</enableIcaoChecks>
    <scriptFile>CONFIG/scripts-logic/CivilEnrolmentProcedure-Portrait-Logic.js</scriptFile>
	<portraits>
	 <!-- The image dimensions recommended for the IdStudio_V2 are: width=1656 and height=2048. for Canon EOS and Webcam you can use the following values <width>414</width> <height>512</height>-->
      <portrait>
        <name>frontal</name>
        <type>FRONT</type>
         <width>1656</width>
        <height>2048</height>
      </portrait>
    </portraits> 
  </service>

  <!-- Portrait logic configuration for Police enrolment procedure -->
  <service id="default/PoliceEnrolmentProcedure/Portrait/morpho.mesa.business.portrait.logic.PortraitLogic">
    <enableIcaoChecks>true</enableIcaoChecks>
    <scriptFile>CONFIG/scripts-logic/PoliceEnrolmentProcedure-Portrait-Logic.js</scriptFile>
    <portraits>
      <portrait>
        <name>frontal-1</name>
        <type>FRONT</type>
         <width>414</width>
        <height>512</height>
        <mandatory>true</mandatory>
      </portrait>
      <portrait>
        <name>Right-Profile-1</name>
        <type>RIGHT_PROFILE</type>
         <width>414</width>
        <height>512</height>
        <mandatory>true</mandatory>
      </portrait>
      <portrait>
        <name>Left-Profile-1</name>
        <type>LEFT_PROFILE</type>
         <width>414</width>
        <height>512</height>
        <mandatory>true</mandatory>
      </portrait>
      <portrait>
        <name>Angled-1</name>
        <type>ANGLED</type>
        <width>414</width>
        <height>512</height>
        <allowedAngle>30</allowedAngle>
        <allowedAngle>60</allowedAngle>
        <mandatory>false</mandatory>
      </portrait>
	  <portrait>
        <name>Angled-2</name>
        <type>ANGLED</type>
        <width>414</width>
        <height>512</height>
        <allowedAngle>-30</allowedAngle>
        <allowedAngle>60</allowedAngle>
        <mandatory>false</mandatory>
      </portrait>
    </portraits>    
  </service>  

  <!-- Portrait logic configuration for Portrait procedure -->
  <service id='default/PortraitProcedure/Portrait/morpho.mesa.business.portrait.logic.PortraitLogic'>
    <strictAcquisitionOrder>false</strictAcquisitionOrder>
    <enableIcaoChecks>true</enableIcaoChecks>
    <computeFaceBioQuality>true</computeFaceBioQuality>
	
	<!-- Continue with manual cropping if eyes not found or in case of bad positioning. -->
    <enableManualCroppingWhenEyesNotDetected>true</enableManualCroppingWhenEyesNotDetected>
	
    <enableAutoRealignEyesHorizontally>true</enableAutoRealignEyesHorizontally>
    <portraits>
      <portrait>
        <name>frontal-1</name>
        <type>FRONT</type>
         <width>414</width>
        <height>512</height>
        <mandatory>true</mandatory>
      </portrait>
      <portrait>
        <name>Right-Profile-1</name>
        <type>RIGHT_PROFILE</type>
         <width>414</width>
        <height>512</height>
        <mandatory>true</mandatory>
      </portrait>
      <portrait>
        <name>Left-Profile-1</name>
        <type>LEFT_PROFILE</type>
         <width>414</width>
        <height>512</height>
        <mandatory>true</mandatory>
      </portrait>
      <portrait>
        <name>Angled-1</name>
        <type>ANGLED</type>
        <allowedAngle>30</allowedAngle>
        <allowedAngle>60</allowedAngle>
         <width>414</width>
        <height>512</height>
        <mandatory>false</mandatory>
      </portrait>
      <portrait>
        <name>Full-Body-1</name>
        <type>FULL_BODY</type>
        <width>200</width>
        <height>400</height>
        <mandatory>false</mandatory>
      </portrait>
    </portraits>
  </service>

  <!-- Portrait logic configuration for Multiple download sites  procedure -->
  <service id="default/MultiImportSitesProcedure/Portrait/morpho.mesa.business.portrait.logic.PortraitLogic">
    <enableIcaoChecks>true</enableIcaoChecks>
        <portraits>
      <portrait>
        <name>frontal</name>
        <type>FRONT</type>
         <width>414</width>
        <height>512</height>
        <mandatory>true</mandatory>
      </portrait>
    </portraits>    

  </service> 

  <service id="morpho.mesa.business.evidence.logic.EvidenceLogic">
    <!-- name of the set of evidences managed by this logic 
         Default value : "" (then, mandatory parameter) -->
    <evidencesDataName>evidences</evidencesDataName>
    <!-- allow possibility to acquire using import file -->
    <allowEvidenceFileDevice>true</allowEvidenceFileDevice>
    <!-- allow possibility to acquire using scan device -->
    <allowEvidenceScanDevice>true</allowEvidenceScanDevice>
    <!-- file import configuration -->
    <evidenceFileDevice>
      <!-- supported image formats for file import -->
      <supportedImageFormat>jpg</supportedImageFormat>
      <supportedImageFormat>jpeg</supportedImageFormat>
      <supportedImageFormat>bmp</supportedImageFormat>
      <supportedImageFormat>jp2</supportedImageFormat>
      <supportedImageFormat>png</supportedImageFormat>
      <supportedImageFormat>wsq</supportedImageFormat>
    </evidenceFileDevice>
    <!-- scan device configuration -->
    <evidenceScanDevice>
      <!--  give the ability to scan using User-defined scan and Optimized scan -->
      <useImageEnhancementFeatures>true</useImageEnhancementFeatures>
      <!-- scan with IQS Mode : true or false -->
      <IQSMode>false</IQSMode>
      <!-- brightness of scan : between 0 and 255 
           Use only when IQS mode is set to false -->
      <brightness>128</brightness>
      <!-- contrast of scan : between 0 and 255 
           Use only when IQS mode is set to false -->
      <contrast>128</contrast>
      <!-- List of available resolution in pixels per inch -->
      <availableScanResolutions>500,1000</availableScanResolutions>
      <!--default resolution in pixels per inch -->
      <defaultScanResolution>500</defaultScanResolution>
      <!-- List of available scan formats.  A format is defined by :
            - id : unique identifier of the formatv
            - unit : unit used for specifying the width and height of the area to scan
                      possible values are : inch or mm 
            - width of the area to scan
            - height of the area to scan 
      -->
      <availableScanFormats>
        <scanFormat>
          <id>A4</id>
          <unit>mm</unit>
          <width>210</width>
          <height>297</height>
          <offsetX>0</offsetX>
          <offsetY>0</offsetY>
        </scanFormat>
        <scanFormat>
          <id>A5</id>
          <unit>mm</unit>
          <width>148</width>
          <height>210</height>
          <offsetX>0</offsetX>
          <offsetY>0</offsetY>
        </scanFormat>
        <!-- To test scanning useful area, uncomments the tag scanFormat bellow -->
        <!-- <scanFormat>
          <id>C1</id>
          <unit>mm</unit>
          <width>50</width>
          <height>60</height>
          <offsetX>40</offsetX>
          <offsetY>30</offsetY>
          </scanFormat> 
           -->
      </availableScanFormats>
      <!-- Default scan format to use -->
      <defaultScanFormatId>A4</defaultScanFormatId>
    </evidenceScanDevice>
    <!-- Compression format of stored evidence images
      Possible values :
        ISO_19794_4_2005 (not yet implemented)
        JP2 (mandatory if captureResolution is 1000)
        PNG
        RAW
        WSQ
        Default value : JPG
    -->
    <evidenceImageStorageFormat>JPG</evidenceImageStorageFormat>
    <!-- Default unit used for the ruler. Possible values are :
            - mm : millimeters
            - inch : inches -->
    <evidenceRulerUnit>mm</evidenceRulerUnit>
    <!-- Max Latent Print Images per evidence, 
          Possibles values : between 0 and 99 
          default value is 99 -->
    <maxLatentsPrintImagesPerEvidence>99</maxLatentsPrintImagesPerEvidence>
    <!-- Max Evidences Print Images , 
          Possibles values : between 1 and 99 
          default value is 99 -->
    <maxEvidencesPrintImages>99</maxEvidencesPrintImages>
    <!-- Config file to be used to parametrize evidences and latents names-->
    <scriptFile>CONFIG/scripts-logic/evidence-logic.js</scriptFile>
    <!-- The file containing the definition of evidence descriptors -->
    <evidenceDescriptorsFile>CONFIG/descriptor/descriptors/evidence.xml</evidenceDescriptorsFile>
    <!-- The file containing the definition of latent descriptors -->
    <latentDescriptorsFile>CONFIG/descriptor/descriptors/latent.xml</latentDescriptorsFile>
    <!-- The following width and height parameters specify the size (minimum, standard, maximum)
    of a latent box of finger type on an evidence image.
    The unit is pixel. They refer to referenceFingerLatentResolution value, which unit is dpi.
    e.g. 
      * if standardFingerLatentPrintHeight is 512 (pixels) and referenceFingerLatentResolution is 500 (dpi)
        then standard height (in inches) is 512/500
      * if real evidence image resolution is 1000 dpi, standard height in inches will not change, then
        standard height in pixels will be 512 * 1000 / 500
    -->
    <referenceFingerLatentResolution>500</referenceFingerLatentResolution>
    <!-- standard dimension is used as default dimension for latents -->
    <standardFingerLatentPrintHeight>512</standardFingerLatentPrintHeight>
    <standardFingerLatentPrintWidth>512</standardFingerLatentPrintWidth>
    <!-- maximum dimension is used to distinguish latents of finger type 
      from latents of palm type -->
    <maximumFingerLatentPrintHeight>600</maximumFingerLatentPrintHeight>
    <maximumFingerLatentPrintWidth>600</maximumFingerLatentPrintWidth>
    <!-- minimum allowed dimension of a Latent print -->
    <minimumFingerLatentPrintHeight>100</minimumFingerLatentPrintHeight>
    <minimumFingerLatentPrintWidth>100</minimumFingerLatentPrintWidth>
    <!-- Allow the operator to change the latent type even autodetection is used-->
    <allowOverridePalmAutomaticDetection>false</allowOverridePalmAutomaticDetection>
    <!-- list of predefined Min Max Histogram values to be used for Image Enhancement
         for user-defined mode.
         Each predfinedMinMaxHisto contains min and max histogram values for image  
         processing based on histogram stretching 
    -->
    <predefinedMinMaxHistoValues>
      <predefinedMinMaxHistoValue>
        <min>0</min>
        <max>50</max>
      </predefinedMinMaxHistoValue>
      <predefinedMinMaxHistoValue>
        <min>0</min>
        <max>128</max>
      </predefinedMinMaxHistoValue>
      <predefinedMinMaxHistoValue>
        <min>0</min>
        <max>255</max>
      </predefinedMinMaxHistoValue>
      <predefinedMinMaxHistoValue>
        <min>96</min>
        <max>255</max>
      </predefinedMinMaxHistoValue>
      <predefinedMinMaxHistoValue>
        <min>128</min>
        <max>255</max>
      </predefinedMinMaxHistoValue>
    </predefinedMinMaxHistoValues>
  </service> 

  <!--####################################################################################################################-->
  <service id="com.printrak.frontend.services.card_acquisition_toolkit.logic.ConfigurationLogic">
    <cardFormatDir>CONFIG/card-formats</cardFormatDir>
    <!--Default card format. MANDATORY. MUST correspond exactly to one of the files listed in cardFormatDefinitionList section-->
    <defaultCardFormatDefinition>TestInterpol.cfd</defaultCardFormatDefinition>
    <!--This section lists the supported card formats-->
    <cardFormatDefinitionList>
      <cardFormatDefinition>FBI Applicant.cfd</cardFormatDefinition>
      <cardFormatDefinition>FBI Default.cfd</cardFormatDefinition>
      <cardFormatDefinition>Free Form.cfd</cardFormatDefinition>
      <cardFormatDefinition>Morpho.cfd</cardFormatDefinition>
      <cardFormatDefinition>Palm Only.cfd</cardFormatDefinition>
      <cardFormatDefinition>Tenprint Only.cfd</cardFormatDefinition>
      <cardFormatDefinition>TestInterpol.cfd</cardFormatDefinition>
    </cardFormatDefinitionList>
    <!-- cardscan segment size customisation -->
    <!-- <bioZoneMinimumFingerHeight></bioZoneMinimumFingerHeight> 
    <bioZoneMaximumFingerHeight></bioZoneMaximumFingerHeight> 
    <bioZoneMinimumFingerWidth></bioZoneMinimumFingerWidth> 
    <bioZoneMaximumFingerWidth></bioZoneMaximumFingerWidth> 

    <bioZoneMinimumLowerPalmWidth></bioZoneMinimumLowerPalmWidth> 
    <bioZoneMaximumLowerPalmWidth></bioZoneMaximumLowerPalmWidth> 
    <bioZoneMinimumLowerPalmHeight></bioZoneMinimumLowerPalmHeight> 
    <bioZoneMaximumLowerPalmHeight></bioZoneMaximumLowerPalmHeight> 

    <bioZoneMinimumUpperPalmWidth></bioZoneMinimumUpperPalmWidth> 
    <bioZoneMaximumUpperPalmWidth></bioZoneMaximumUpperPalmWidth> 
    <bioZoneMinimumUpperPalmHeight></bioZoneMinimumUpperPalmHeight> 
    <bioZoneMaximumUpperPalmHeight></bioZoneMaximumUpperPalmHeight> 

    <bioZoneMinimumWritersWidth></bioZoneMinimumWritersWidth> 
    <bioZoneMaximumWritersWidth></bioZoneMaximumWritersWidth> 
    <bioZoneMinimumWritersHeight></bioZoneMinimumWritersHeight> 
    <bioZoneMaximumWritersHeight></bioZoneMaximumWritersHeight> -->
  </service> 

  <service id="default/CardScanProcedure/LoadConfiguration/com.printrak.frontend.services.card_acquisition_toolkit.logic.ConfigurationLogic">
    <cardFormatDefinitionList>
      <cardFormatDefinition>UpperPalm.cfd</cardFormatDefinition>
      <cardFormatDefinition>TestUsefulArea.cfd</cardFormatDefinition>
      <cardFormatDefinition>TestInterpol.cfd</cardFormatDefinition>
      <cardFormatDefinition>CH1_TP_2PP.cfd</cardFormatDefinition>
      <cardFormatDefinition>ControlFingers.cfd</cardFormatDefinition>
      <cardFormatDefinition>ControlFingersWithSkip.cfd</cardFormatDefinition>
      <cardFormatDefinition>SLAP_ROLLED_PALM_ALL.cfd</cardFormatDefinition>
    </cardFormatDefinitionList>
    <defaultCardFormatDefinition>UpperPalm.cfd</defaultCardFormatDefinition>
  </service>

  <service id="morpho.mesa.business.cardscan.logic.CardScanLogic">
    <!-- name of the set of data managed by this logic 
        Default value : "" (then, mandatory parameter)
    -->
    <cardScanDataName>cardScanData</cardScanDataName>
    <!-- true to store original images into data base -->
    <storeOriginalImages>true</storeOriginalImages>
    <!-- full or low -->
    <originalImagesResolution>full</originalImagesResolution>
    <!-- Compression format of stored images (captured images as well as segment images)
      Possible values :
        ISO_19794_4_2005 (not yet implemented)
        JP2K (mandatory if captureResolution is 1000)
        PNG
        RAW
        WSQ
        Default value : WSQ
    -->
    <storedImagesFormat>WSQ</storedImagesFormat>
    <!-- for BMI program, MorphoImageConvert does not work with big size image -->
    <!-- do not change next two values (wsq, 300), unless MorphoImageConvert permit it -->
    <storedImagesFormat_1000Dpi>WSQ</storedImagesFormat_1000Dpi>
    <storedImagesRes_1000Dpi>500</storedImagesRes_1000Dpi>
    <!-- Management of exception declaration mode.
      SIMPLIFIED : Only two statuses are available ("PRESENT" , "MISSING").
      FULL  : Four statuses are available in this mode ("PRESENT" - "BANDAGED" - "AMPUTATED" - "DAMAGED").
      Default value : FULL
    -->
    <exceptionCycle>FULL</exceptionCycle>
    <!-- Templates that should be used for fingerprint and palmprint summary pages
      Value must be a path to an HTML page
      Default value : no value (which means no template)
    -->
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/rolledAndFlatSeparatedThumbs.html</fingerprintSummaryTemplate>
    <palmprintSummaryTemplate>../fingerprint/summaryTemplates/palmsWriterLower.html</palmprintSummaryTemplate>
    <!-- Defines the list of used cardScan devices -->
    <cardScanDevices>
      <cardScanDevice>
        <name>EPSON Perfection V800/V850</name>
      </cardScanDevice>
      <cardScanDevice>
        <name>WIA-EPSON Perfection V800/V850</name>
      </cardScanDevice>
      <cardScanDevice>
        <name>File</name>
      </cardScanDevice>
    </cardScanDevices>
    <!-- Resolution of scanned and imported images
         Please note that this is hardware dependent : all scanners do not support all resolutions.
         You must ensure that the resolution you choose is compatible with the device you will use.
         As for the imported images resolution it is functionally depending on device resolution.
         Possible values (unit is dot per inch) :
            500  : 500 dpi
            1000 : 1000 dpi       
            Default value : 500
    -->
    <workResolution>500</workResolution>
    <!-- Number of bytes (length) of the optional fields for the Record Type Seven.
      Used for Nist Type-7 file import (Scanned Images) -->
    <optionalFieldsOfRecordSevenLength>28</optionalFieldsOfRecordSevenLength>
  </service> 

  <service id="default/CardScanProcedure/CardScan/morpho.mesa.business.cardscan.logic.CardScanLogic">
    <cardScanDevices>
      <cardScanDevice>
        <name>Image File</name>
      </cardScanDevice>
      <cardScanDevice>
        <name>IQS Scanner</name>
      </cardScanDevice>
      <cardScanDevice>
        <name>NIST File</name>
      </cardScanDevice>
    </cardScanDevices>
    <fingerprintSummaryTemplate>../fingerprint/summaryTemplates/rolledAndFlatSeparatedThumbs.html</fingerprintSummaryTemplate>
    <palmprintSummaryTemplate>../fingerprint/summaryTemplates/allPalms.html</palmprintSummaryTemplate>
  </service> 

  <!--################# Signature Logic Configuration (for Signature data acquisition) ###################################-->
  <!-- 
          Signature logic configuration for all new procedures that uses Signature capture step
          It's possible to redefine configuration for a specific procedure : see bellow 
    -->
  <service id="morpho.mesa.business.signature.logic.SignatureLogic">
    <!-- Name of the set of signatures managed by this logic -->
    <signaturesDataName>signatures</signaturesDataName>
    <!-- DPI of captured images.
         screen DPI is set in CommonConfiguration configuration section 
    -->
    <screenDPI refSource="CommonConfiguration" ref="/hardware/screenDPI" />
    <!-- Type of device used to acquire signature
    Possible values :
       - MOUSE
       - SIGNPAD
    -->
    <deviceType>SIGNPAD</deviceType>
    <!-- Time between device connectivity checks in ms 
             Default value: 2000 
             /!\ A time too small (<1000ms) will generate visual latencies on GUI
        -->
    <timeBetweenDeviceConnectivityChecks>2000</timeBetweenDeviceConnectivityChecks>
    <!-- 
        displayLCDGuidance : if true, the text Guidance will appear on the pad
        Default value : false
      -->
    <displayLCDGuidance>false</displayLCDGuidance>
    <lCDGuidanceText>
      <lCDText>
        <!-- 
            content: Defines the text to display.               
            Default value : ""
            To draw a line use : __________________________________                
          -->
        <content>__________________________________</content>
        <!-- 
            XPosition: Defines the horizontal position of text
            Default value : 0
          -->
        <xPosition>0</xPosition>
        <!-- 
            YPosition: Defines the vertical position of text
            Default value : 40
          -->
        <yPosition>40</yPosition>
        <lCDFont>
          <!--
              name : Defines the name of the font.
              possible values supported by the device : Dialog / DialogInput / Monospaced / Serif / SansSerif
              Default value : Dialog
            -->
          <name>Dialog</name>
          <!--
              type : Defines the type of the font.
              possible values supported by the device: PLAIN / BOLD /ITALIC 
              Default value : PLAIN
            -->
          <type>PLAIN</type>
          <!--
              fontSize : Defines the size of text.
              possible values supported by the device : 8 /10 / 12 
              Default value : 12
            -->
          <size>12</size>
        </lCDFont>
      </lCDText>
    </lCDGuidanceText>
  </service> 

  <!-- Signature logic configuration for First Enrolment procedure -->
  <service id="default/FirstEnrolmentProcedure/Signature/morpho.mesa.business.signature.logic.SignatureLogic">
    <deviceType>MOUSE</deviceType>
  </service>

  <!-- Signature logic configuration for Document Renewal procedure -->
  <service id="default/DocumentRenewal/Signature/morpho.mesa.business.signature.logic.SignatureLogic">
    <deviceType>MOUSE</deviceType>
  </service>

  <!-- Signature logic configuration for Document Replacement procedure -->
  <service id="default/DocumentReplacement/Signature/morpho.mesa.business.signature.logic.SignatureLogic">
    <deviceType>MOUSE</deviceType>
  </service>

  <!-- Signature logic configuration for Signature procedure -->
  <service id="default/SignatureProcedure/Signature/morpho.mesa.business.signature.logic.SignatureLogic">
    <deviceType>SIGNPAD</deviceType>
    <signaturesDataName>signatures</signaturesDataName>
  </service> 

  <service id="default/SignatureProcedure/SignatureOperator/morpho.mesa.business.signature.logic.SignatureLogic">
    <deviceType>MOUSE</deviceType>
    <signaturesDataName>signatures_operator</signaturesDataName>
  </service> 

  <!--#####################################################################################################################-->
  <!--################## NIST Import Logic Configuration (for NIST Data import from file system) ##########################-->
  <!-- 
          NIST Import logic configuration for all new procedures that uses NIST Import step
          It's possible to redefine configuration for a specific procedure : See bellow
    -->
  <service id="morpho.mesa.business.dataimport.logic.NistImportLogic">
    <nistFilenamePattern>C:/MESAstorage/importNISTfiles/{DATE}/{TICKET}.nst</nistFilenamePattern>
    <siteId>NIST-EBTS</siteId>
    <nistImportServiceId>morpho.mesa.services.nist.mcp.MCPNistImportService</nistImportServiceId>
  </service> 

  <service id="morpho.mesa.services.nist.mcp.MCPNistImportService/NIST-EBTS">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <!-- <adapter>nist_2011_binary</adapter> -->
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <!-- <mesaDataAdapterOverload>nist_2011_binary_js</mesaDataAdapterOverload> -->
    <mesaDataAdapterEntryPoint>main_ebts</mesaDataAdapterEntryPoint>
    <mesaDataAdapterEntryPointDebug>main_ebts_debug</mesaDataAdapterEntryPointDebug>
    <scriptFile>CONFIG/scripts-site/IMPORT-NIST-EBTS.js</scriptFile>
    <!--debug>true</debug-->
    <!--tracePath>file:///C:/MesaStorage/tmp</tracePath-->
  </service> 

  <!--#####################################################################################################################-->
  <!--################## NIST Import Logic Configuration (for NIST Data import over HTTP) ##########################-->
  <!-- 
          NIST Import logic configuration for all new procedures that uses NIST Import over HTTP step
          It's possible to redefine configuration for a specific procedure : See bellow
    -->
  <service id="morpho.mesa.business.dataimport.logic.HttpDownloadLogic">
    <urlPattern>http://localhost/ws/v1/workflows?businessId={ID}</urlPattern>
    <siteId>NIST-EBTS</siteId>
    <nistImportServiceId>morpho.mesa.services.nist.mcp.MCPNistImportService</nistImportServiceId>
    <scriptFile>CONFIG/scripts-logic/http-nist-download-logic.js</scriptFile>
  </service> 

  <!--#####################################################################################################################-->
  <!-- ************************ CONFIGURATION OF NON GUI LOGIC *********************************************************-->
  <service id="morpho.mesa.services.exporters.process.DefaultExportProcessingEngine">
    <!-- Interval (in milliseconds) to wait before re-checking for exports to process 
    default : 2000
    -->
    <timeBetweenChecks>2000</timeBetweenChecks>
    <!-- Number of exports to fetch and process at the same time (one batch) 
    default : 5
    -->
    <processingBatchSize>5</processingBatchSize>
  </service>  

  <!--################################# Export Dossier Logic Configuration ###############################################-->
  <service id="morpho.mesa.business.export.logic.ExportLogic">
    <!-- Define the list of sites to export to 
         The Export Sites are defined in morpho.mesa.common.configuration.ExportSiteRepository configuration section
    -->
    <site>MBIS-DSM-1</site>
    <site>MESA-SMTP-1</site>
    <site>NIST-FILE-1</site>
    <site>MESA-USB-1</site>
    <site>ABIS-SERVER-POLICE</site>
    <site>ABIS-SERVER-QuickIdent</site>
    <!-- Timeout in seconds for export result. If no result after this time, stop waiting result
      Default : 15
    -->
    <timeoutForExportResult>30</timeoutForExportResult>
  </service>

  <!-- Export logic configuration for Police enrolment procedure -->
  <service id="default/PoliceEnrolmentProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>PEP-NIST-FILE</site>
    <site>ABIS-SERVER-POLICE</site>
  </service> 

  <service id="default/FirstEnrolmentProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>CEP-NIST-FILE</site>
	  <site>ESB-REST-POST-NIST</site>
  </service>

  <service id="default/DocumentRenewal/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>CEP-NIST-FILE</site>
	  <site>ESB-REST-POST-NIST</site>
  </service>

  <service id="default/DocumentReplacement/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>CEP-NIST-FILE</site>
	  <site>ESB-REST-POST-NIST</site>
  </service>
  
  <!-- Export logic configuration for Multiple download sites  procedure -->
  <service id="default/MultiImportSitesProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-3-hooks</site>
  </service> 

  <!-- Export logic configuration for Demographics procedure -->
  <service id="default/DemographicsProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 

  <service id="morpho.mesa.business.issuance.logic.IssuanceLogic">
    <!-- Allow the Operator to override the predefined issuance status of a document -->
    <allowOverwriteIssuanceStatus>true</allowOverwriteIssuanceStatus>
    <documentName>ApplicantDocumentToIssue</documentName>
    <scriptFile>CONFIG/scripts-logic/issuance-step-logic.js</scriptFile>
  </service> 

  <service id="default/P21Issuance/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MCS-REST-ISSUANCE-FROM-RECEIPT</site>
    <waitForResults>true</waitForResults>
    <timeoutForExportResult>15</timeoutForExportResult>
  </service> 

  <service id="default/P21Issuance/Authentication/morpho.mesa.business.matching.logic.MatchingLogic">
    <!-- Possible values are : template or image -->
    <matchingType>template</matchingType>
    <scriptFile>CONFIG/scripts-logic/matching-logic-issuance-templates.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P21-authentication-process.js</scriptFile>
  </service> 

  <service id="morpho.mesa.business.matching.logic.MatchingLogic">
    <!-- Define the minimum number of fingers with a valid match required to have a positive matching status
          - numberOfFingersToMatch must be greater than or equal to 0
          - if 0, the numberOfFingersToMatch is updated to 1
          - if numberOfFingersToMatch is greater than the number of fingers in the document, the matching status will be "Not Possible"
    -->
    <numberOfFingersToMatch>2</numberOfFingersToMatch>
  </service> 

  <service id="default/P23CentralPassportIssuance/Authentication/morpho.mesa.business.export.logic.ExportLogic">
    <site>MIM-WS-1</site>
    <waitForResults>true</waitForResults>
    <timeoutForExportResult>60</timeoutForExportResult>
    <scriptFile>CONFIG/scripts-logic/P23-authentication-process.js</scriptFile>
  </service> 

  <service id="default/P23CentralPassportIssuance/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MCS-REST-ISSUANCE-FROM-EDOC</site>
    <waitForResults>true</waitForResults>
    <timeoutForExportResult>15</timeoutForExportResult>
  </service> 

  <service id="default/P24LocalPassportIssuance/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MCS-REST-ISSUANCE-FROM-EDOC</site>
    <waitForResults>true</waitForResults>
    <timeoutForExportResult>15</timeoutForExportResult>
  </service> 

  <service id="default/P24LocalPassportIssuance/Authentication/morpho.mesa.business.matching.logic.MatchingLogic">
    <!-- Possible values are : template or image -->
    <matchingType>image</matchingType>
    <scriptFile>CONFIG/scripts-logic/matching-logic-issuance-images.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P24-authentication-process.js</scriptFile>
  </service> 

  <service id="default/P40PassportIssuanceMOD/Authentication_Face/morpho.mesa.business.matching.logic.MatchingOperationLogic">
    <scriptFile>CONFIG/scripts-logic/P40AuthenticationFace-logic.js</scriptFile>
  </service> 

  <service id="default/P25RepresentativeIssuance/Issuance/morpho.mesa.business.issuance.logic.IssuanceLogic">
    <allowOverwriteIssuanceStatus>false</allowOverwriteIssuanceStatus>
  </service> 

  <service id="default/P25RepresentativeIssuance/DocumentCopies/morpho.mesa.business.multipleImages.logic.MultipleImagesLogic">
    <multipleImagesDataName>documents</multipleImagesDataName>
  </service> 

  <service id="default/P25RepresentativeIssuance/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MCS-REST-ISSUANCE-FROM-EDOC</site>
    <waitForResults>true</waitForResults>
    <timeoutForExportResult>15</timeoutForExportResult>
  </service> 

  <service id="default/P25RepresentativeIssuance/Authentication/morpho.mesa.business.matching.logic.MatchingLogic">
    <!-- Possible values are : template or image -->
    <matchingType>image</matchingType>
    <scriptFile>CONFIG/scripts-logic/matching-logic-issuance-images.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P25-authentication-process.js</scriptFile>
  </service> 

  <service id="default/P27IDCardIssuance/Authentication/morpho.mesa.business.matchingOnCard.logic.MatchingOnCardLogic">
    <!-- name of the set of fingers involved in matching
        Default value : "" (then, mandatory parameter)
    -->
    <fingersDataName>fingers</fingersDataName>
    <!--Name of the document on which matching on card must be done (typically corresponds to the name of a previously read 
    document)
        Default value : null (then, mandatory parameter)
    -->
    <documentName>ApplicantDocumentToIssue</documentName>
    <scriptFile>CONFIG/scripts-logic/P27MatchingOnCard-logic.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/P27-authentication-process.js</scriptFile>
    <scriptFile>CONFIG/scripts-logic/APDU-MOC-Citiz210.js</scriptFile>
  </service> 

  <service id="default/P28P15DocIssuance/Authentication/morpho.mesa.business.matchingOnCard.logic.MatchingOnCardLogic">
    <fingersDataName>fingers</fingersDataName>
    <documentName>ApplicantDocumentToIssue</documentName>
    <scriptFile>CONFIG/scripts-logic/NepalMatchOnCard-logic.js</scriptFile>
    <!--
      Name of the step from workflow that corresponds to the fingers capture
      It is used to recapture fingers, if necessary, when matching result is NO HIT
      Default : the absence of this parameter means that nothing will be done : no recapture
    -->
    <recaptureFingersStepName>WKF_STEP_FINGERPRINTS_CAPTURE</recaptureFingersStepName>
  </service> 

  <!-- Export logic configuration for Signature -->
  <service id="default/SignatureProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 

  <!-- Export logic configuration for Iris Procedure -->
  <service id="default/IrisProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service>

 <!-- Export logic configuration for Iris And Face Procedure -->
  <service id="default/IrisAndFaceProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service>  

  <!-- Export logic configuration for Portrait Procedure -->
  <service id="default/PortraitProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 

  <service id="default/InvokerWaitingPortal/InvokerParametrizedProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 

  <service id="default/P27IDCardIssuance/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>ISSUANCE-DISK</site>
  </service> 

  <!-- Export logic configuration for CardScan Procedure -->
  <service id="default/CardScanProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
    <site>CS-NIST-FILE</site>
  </service> 

  <!-- Export logic configuration for Fingerprint Procedure -->
  <service id="default/FingerprintProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>ABIS-SERVER-POLICE</site>
    <site>ABIS-SERVER-QuickIdent</site>
  </service> 

  <!-- Export logic configuration for Evidences and latents Procedure -->
  <service id="default/EvidencesAndLatentsProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 

  <!-- Export logic configuration for SMT Procedure -->
  <service id="default/SMTProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 

  <!-- Export logic configuration for Document copies Procedure -->
  <service id="default/DocumentCopiesProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 

  <!-- Export logic configuration for Quick Identification procedure -->
  <service id="default/QuickIdentProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 

  <service id="default/AsynchQuickIdentProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>ABIS-SERVER-QuickIdent</site>
  </service> 
  <!--############################## Data Import logic Configuration ###################################-->
  <service id="morpho.mesa.business.dataimport.logic.DataImportLogic" />
  <!-- Import logic configuration for First Enrolment procedure - from preloaded database -->
  <service id="default/FirstEnrolmentProcedure/dataImport/morpho.mesa.business.dataimport.logic.DataImportLogic">
    <site>SQL_DATA_IMPORT_1</site>
  </service> 

  <!--################################## Print Dossier Logic Configuration ###############################################-->
  <service id="morpho.mesa.business.dossiers.logic.PrintUILogic">
    <availablePrintersAndTemplatesConfig>
      <!-- printers names -->
      <printer>PdfWriter</printer>
      <printer>Raster1</printer>
      <!-- Printing Format -->
      <cardFormat>standard-fbi-applicant.fmt</cardFormat>
      <cardFormat>standard-fbi-criminal.fmt</cardFormat>
    </availablePrintersAndTemplatesConfig>
  </service> 

  <service id="morpho.mesa.business.export.logic.PrintLogic">
    <!-- See morpho.mesa.common.configuration.ExportSiteRepository configuration section -->
    <site>MESA-CPS</site>
    <!-- number of copies to print -->
    <copies>1</copies>
    <!-- define the maximum of number of copies the operator can select to print -->
    <maxCopies>5</maxCopies>
    <availablePrintersAndTemplatesConfig>
      <!-- printers names -->
      <printer>PdfWriter</printer>
      <printer>Raster1</printer>
      <!-- Printing Format -->
      <cardFormat>standard-fbi-applicant.fmt</cardFormat>
      <cardFormat>standard-fbi-criminal.fmt</cardFormat>
      <cardFormat>full-case.fmt</cardFormat>
    </availablePrintersAndTemplatesConfig>
  </service> 
 
  <service id="default/DossiersManager/morpho.mesa.business.dossiers.logic.DossiersManagerLogic">
    <descriptorsDefinitionFile>CONFIG/descriptor/descriptors/dossiersManager_ui_filter.xml</descriptorsDefinitionFile>
    <maxDossiersFromQuery>50</maxDossiersFromQuery>
    <timeoutForPrintingResult>60</timeoutForPrintingResult>
    <formsPath>C:\MesaStorage\ApplicationForm</formsPath>
    <availablePrintersAndTemplatesConfig>
        <!-- printers names -->
        <printer>PdfWriter</printer>
        <printer>Raster1</printer>
        <!-- Printing Format -->
        <cardFormat>standard-fbi-applicant.fmt</cardFormat>
        <cardFormat>standard-fbi-criminal.fmt</cardFormat>
    </availablePrintersAndTemplatesConfig>
    <scriptFile>CONFIG/scripts-logic/dossiers-manager-logic.js</scriptFile>
  </service> 

  <!-- Print Dossier logic configuration for Demographics procedure -->
  <service id="default/DemographicsProcedure/Print/morpho.mesa.business.export.logic.PrintLogic">
    <site>MESA-CPS</site>
    <copies>1</copies>
    <availablePrintersAndTemplatesConfig>
      <printer>PdfWriter</printer>
      <cardFormat>standard-fbi-criminal.fmt</cardFormat>
    </availablePrintersAndTemplatesConfig>
  </service> 

  <!-- Import logic configuration for Multiple download sites procedure -->
  <service id="default/MultiImportSitesProcedure/import/morpho.mesa.business.dataimport.logic.DataImportLogic">
    <autoMerge>false</autoMerge>
    <!-- we can select in GUI data to be merged (today GUI automatically send everything) -->
    <site>SOAP_NIST_DATA_IMPORT_1</site>
    <site>REST_PORTRAIT_DATA_IMPORT_1</site>
    <site>SQL_DATA_IMPORT_1</site>
  </service>

  <service id="default/DocumentRenewal/import/morpho.mesa.business.dataimport.logic.DataImportLogic">
    <autoMerge>false</autoMerge>
    <scriptFile>CONFIG/scripts-logic/documentRenewal-script.js</scriptFile>
    <!-- we can select in GUI data to be merged (today GUI automatically send everything) -->
    <site>REST_FINGERPRINT_DATA_IMPORT_1</site>
  </service>

  <service id="default/DocumentReplacement/import/morpho.mesa.business.dataimport.logic.DataImportLogic">
    <autoMerge>false</autoMerge>
    <scriptFile>CONFIG/scripts-logic/documentRenewal-script.js</scriptFile>
    <!-- we can select in GUI data to be merged (today GUI automatically send everything) -->
    <site>REST_FINGERPRINT_DATA_IMPORT_1</site>
  </service>

  <!-- Import logic configuration for Quick Ident procedure -->
  <service id="default/QuickIdentProcedure/import/morpho.mesa.business.dataimport.logic.DataImportLogic">
    <scriptFile>CONFIG/scripts-logic/quickIdentification-script.js</scriptFile>
	  <maxImportedData>3</maxImportedData>
    <site>SOAP_QUICK_IDENT</site>
  </service> 

  <!--################################################################################################################-->
  <!--############################ Import Site Repository Configuration ##############################################-->
  <!-- 
        Defines all import sites supported by MESA application
        Please refer to custo guide to get details about each parameter usage
    -->
  <service id="morpho.mesa.common.configuration.ImportSiteRepository">
    <site>
      <!-- This site can't be renamed so easely as it is referenced in code, please do not.-->
      <id>LOCAL_NIST_FILE_IMPORT</id>
      <receiverServiceId>morpho.mesa.services.dataimport.local.file.LocalFileReceiver</receiverServiceId>
      <processorServiceId>morpho.mesa.services.nist.mcp.MCPNistProcessor</processorServiceId>
      <scriptFile>CONFIG/scripts-site/import/local_nist_data_import.js</scriptFile>
    </site>
    <site>
      <id>SOAP_NIST_DATA_IMPORT_1</id>
      <receiverServiceId>morpho.mesa.services.importers.process.JavascriptSOAPReceiver</receiverServiceId>
      <processorServiceId>morpho.mesa.services.nist.mcp.MCPNistProcessor</processorServiceId>
      <scriptFile>CONFIG/scripts-site/import/soap_data_import.js</scriptFile>
    </site>
    <site>
      <id>SQL_DATA_IMPORT_1</id>
      <receiverServiceId>morpho.mesa.services.dataimport.receiver.SqlDataBaseReceiver</receiverServiceId>
      <scriptFile>CONFIG/scripts-site/import/sql_data_import_civil_enrolment.js</scriptFile>
    </site>
    <site>
      <id>REST_PORTRAIT_DATA_IMPORT_1</id>
      <receiverServiceId>morpho.mesa.services.importers.process.HttpReceiver</receiverServiceId>
      <scriptFile>CONFIG/scripts-site/import/rest_data_import.js</scriptFile>
    </site>
    <site>
      <id>REST_FINGERPRINT_DATA_IMPORT_1</id>
      <receiverServiceId>morpho.mesa.services.importers.process.HttpReceiver</receiverServiceId>
      <scriptFile>CONFIG/scripts-site/import/rest_data_fingerprint_import.js</scriptFile>
    </site>
    <site>
      <id>DOCUMENT_STATUS</id>
      <receiverServiceId>morpho.mesa.services.importers.process.HttpReceiver</receiverServiceId>
      <scriptFile>CONFIG/scripts-site/import/DOCUMENT_STATUS.js</scriptFile>
    </site>
    <site>
      <id>SOAP_QUICK_IDENT</id>
      <!-- Maximum execution time, in milliseconds, of retrieveImportData polling if no result available -->
      <receiverExecutionTimeOut>20000</receiverExecutionTimeOut>
      <!-- the purpose of this parameter is to decide if the site should apply an action before retrieving data or not, 
        ie the sendActionRequest hook should be executed or not.  -->
      <actionRequired>true</actionRequired>
      <!-- Interval, in milliseconds, to wait between each retrieveImportData hook execution -->
      <delayBetweenImportRequests>1000</delayBetweenImportRequests>
      <receiverServiceId>morpho.mesa.services.importers.process.JavascriptSOAPReceiver</receiverServiceId>
      <scriptFile>CONFIG/scripts-site/import/quick_ident.js</scriptFile>
    </site>
    <site>
      <id>MORPHO-IS-ISSUANCE-FROM-EDOC</id>
      <receiverServiceId>morpho.mesa.services.importers.process.JavascriptSOAPReceiver</receiverServiceId>
      <scriptFile>CONFIG/scripts-site/import/morphois_soap_data_import.js</scriptFile>
    </site>
  </service> 

  <service id="morpho.mesa.services.importers.process.JavascriptSOAPReceiver/MORPHO-IS-ISSUANCE-FROM-EDOC">
    <scriptFile>CONFIG/scripts-service/javascript-soap-sender/morpho-is-eac-interface.js</scriptFile>
    <wsdlLocation>https://morphois.idemia.com:8443/EACws/services/EACWebService?wsdl</wsdlLocation>
	
     <!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore>
        <path>CONFIG/security/keystore/clt_localhost.jks-keystore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/clt_localhost.jks-truststore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderTrustStore>
      <checkCertificatesValidity>false</checkCertificatesValidity>
    </senderSecurityConfiguration>
  </service> 

  <!--############################ Import Site Configuration ##############################################-->
  <service id="morpho.mesa.services.dataimport.receiver.SqlDataBaseReceiver/SQL_DATA_IMPORT_1">
    <!-- Configuration to load alphas data from Preloaded database H2 (local DBMS) -->
    <connectionConfiguration>
      <connectionIdentifier>CNID1</connectionIdentifier>
      <driver>org.h2.Driver</driver>
      <databaseUrl>jdbc:h2:c:/MesaStorage/MESAPreloaded;MV_STORE=FALSE;MVCC=FALSE</databaseUrl>
      <jdbcDriverUrl>h2-1.4.189.jar</jdbcDriverUrl>
      <userName>mesaUser</userName>
      <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
      <passWord>alphaDataPreloadedDbPassword</passWord>
    </connectionConfiguration>
  </service> 

  <service id="morpho.mesa.services.dataimport.receiver.SqlDataBaseReceiver/SQL_DATA_IMPORT_2">
    <!-- Configuration to load alphas data from External database Firebird (Example of Generic implementation) -->
    <connectionConfiguration>
      <connectionIdentifier>CNID2</connectionIdentifier>
      <driver>org.firebirdsql.jdbc.FBDriver</driver>
      <databaseUrl>jdbc:firebirdsql://localhost/C:/MesaStorage/EXTDB.FDB</databaseUrl>
      <jdbcDriverUrl>jaybird-full-3.0.3.jar</jdbcDriverUrl>
      <userName>SYSDBA</userName>
      <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
      <passWord>alphaDataPreloadedDbExternalPassword</passWord>
    </connectionConfiguration>
  </service> 

   <service id="morpho.mesa.services.importers.process.HttpReceiver/REST_PORTRAIT_DATA_IMPORT_1">
    <httpMethod>GET</httpMethod>
	<!--"nginx" refers to the CN (Common name) in the keystore, and should be mapped to the real server IP/name in the "hosts" file-->
    <baseUrl>https://nginx</baseUrl>
    <port>443</port>
    <complementRequestUrl>/generic/rest/service/getMethod/portrait/</complementRequestUrl>
    <accept>application/json</accept>
    <contentType>application/json</contentType>
	
    <!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore> 
        <path>CONFIG/security/keystore/keystore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/truststore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderTrustStore>   
    </senderSecurityConfiguration> 
  </service>

  <!--LIMITATION IN THIS VERSION OF MESA : senderKeystore and senderTrustStore must be the same as of the response site mentioned in activeSiteIds tag.-->
  <service id="morpho.mesa.services.importers.process.HttpReceiver/DOCUMENT_STATUS">
    <httpMethod>POST</httpMethod>
    <!--"nginx" refers to the CN (Common name) in the keystore, and should be mapped to the real server IP/name in the "hosts" file-->
    <baseUrl>https://nginx</baseUrl>
    <port>497</port>
    <complementRequestUrl>document</complementRequestUrl>
    <accept>application/json</accept>
    <contentType>application/json</contentType>
	
	<!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
      <checkCertificatesValidity>false</checkCertificatesValidity>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore>
        <path>CONFIG/security/keystore/client.keystore.jks</path>
        <password>genericsecuritystorepwd2</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/server.truststore.jks</path>
        <password>genericsecuritystorepwd2</password>
      </senderTrustStore>  
    </senderSecurityConfiguration>  
  </service>

  <service id="morpho.mesa.services.importers.process.HttpReceiver/REST_FINGERPRINT_DATA_IMPORT_1">
    <httpMethod>POST</httpMethod>
    <!--"nginx" refers to the CN (Common name) in the keystore, and should be mapped to the real server IP/name in the "hosts" file-->
    <baseUrl>https://nginx</baseUrl>
    <port>443</port>
    <complementRequestUrl>/generic/rest/service/postMethodtojson/esb/authentication</complementRequestUrl>
    <accept>application/json</accept>
    <contentType>application/json</contentType>
	
	<!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
      <checkCertificatesValidity>false</checkCertificatesValidity>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore>
        <path>CONFIG/security/keystore/client.keystore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/server.truststore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderTrustStore>  
    </senderSecurityConfiguration>  
  </service>

  <service id="morpho.mesa.services.importers.process.JavascriptSOAPReceiver/SOAP_NIST_DATA_IMPORT_1">
    <scriptFile>CONFIG/scripts-service/javascript-soap-sender/soap_import-nist.js</scriptFile>
    <wsdlLocation>ToBeDefined</wsdlLocation>
	
    <!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore> 
        <path>CONFIG/security/keystore/keystore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/truststore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderTrustStore>   
    </senderSecurityConfiguration>  
  </service> 

  <service id="morpho.mesa.services.nist.mcp.MCPNistProcessor/ABIS-SERVER-RESPONSE">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>proc_police_response</mesaDataAdapterOverload>
    <!--<debug>false</debug> -->
  </service> 
  <service id="morpho.mesa.services.nist.mcp.MCPNistProcessor/SOAP_NIST_DATA_IMPORT_1">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <mesaDataAdapterEntryPoint>main_ebts</mesaDataAdapterEntryPoint>
    <mesaDataAdapterEntryPointDebug>main_ebts_debug</mesaDataAdapterEntryPointDebug>
    <scriptFile>CONFIG/scripts-site/IMPORT-NIST-EBTS.js</scriptFile>
    <!--debug>true</debug-->
    <!--tracePath>file:///C:/MesaStorage/tmp</tracePath-->
  </service> 

  <service id="morpho.mesa.services.nist.mcp.MCPNistProcessor/LOCAL_NIST_FILE_IMPORT">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <mesaDataAdapterEntryPoint>main_ebts</mesaDataAdapterEntryPoint>
    <mesaDataAdapterEntryPointDebug>main_ebts_debug</mesaDataAdapterEntryPointDebug>
    <scriptFile>CONFIG/scripts-site/IMPORT-NIST-EBTS.js</scriptFile>
  </service> 

  <service id="morpho.mesa.services.importers.process.JavascriptSOAPReceiver/SOAP_QUICK_IDENT">
    <scriptFile>CONFIG/scripts-service/javascript-soap-sender/soap-import-quick-ident.js</scriptFile>
    <wsdlLocation>http://localhost:8088/mockQuickIdentificationServicesBinding?WSDL</wsdlLocation>
  </service> 

  <!-- ************************************* MESA CONFIGURATION DOSSIER EXPORTS and RESPONSE ***********************************************
                Specify the configuration of  MESA Export dossier features
                    - Export Site Repository
                    - Response Site Repository
                    - Dossier Export Transformer and  Sender configuration
                    - Response Receiver and Response Processor configuration
                    - Enable or Disable Embedded Export
                    - ....
    -->
  <!--################################################################################################################-->
  <!--############################ Export Site Repository Configuration ##############################################-->
  <!-- 
        Defines all export sites supported by MESA application
        Please refer to custo guide to get details about each parameter usage
    -->
  <service id="morpho.mesa.common.configuration.ExportSiteRepository">
    <site>
      <id>ABIS-SERVER-POLICE</id>
      <responseRequired>true</responseRequired>
      <maxRetries>5</maxRetries>
      <!--<descriptorsFile>CONFIG/descriptor/descriptors/nist-file-1.xml</descriptorsFile> -->
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.EmailSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/MESA-ABIS-POLICE.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
	  <!--Option for security. Possible values :
        ENCRYPTION data is encrypted
        SIGNATURE data is signed
        SIGNATURE_THEN_ENCRYPTION data is signed, then encrypted
        ENCRYPTION_THEN_SIGNATURE data is encrypted then signed
        NONE no signature, no encryption
        
        Default value : NONE
        
        Note that is securityOption is different from NONE, securityManagerId tag must be set (no default value).
        Possible values : 
        morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager to use asymmetrical algorithm (with certificates)
      -->
      <securityOption>SIGNATURE_THEN_ENCRYPTION</securityOption>
      <!--Used to identify the encryption certificate to use for this site-->
      <certificateLabel>cert1</certificateLabel>
      <securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId>
      <checksumAlgorithm>MD5</checksumAlgorithm>
    </site>
    <site>
      <id>ABIS-SERVER-QuickIdent</id>
      <responseRequired>true</responseRequired>
      <maxRetries>5</maxRetries>
      <!--<descriptorsFile>CONFIG/descriptor/descriptors/nist-file-1.xml</descriptorsFile> -->
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.EmailSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/MESA-ABIS-QuickIdent.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
	  <!--Option for security. Possible values :
        ENCRYPTION data is encrypted
        SIGNATURE data is signed
        SIGNATURE_THEN_ENCRYPTION data is signed, then encrypted
        ENCRYPTION_THEN_SIGNATURE data is encrypted then signed
        NONE no signature, no encryption
        
        Default value : NONE
        
        Note that is securityOption is different from NONE, securityManagerId tag must be set (no default value).
        Possible values : 
        morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager to use asymmetrical algorithm (with certificates)
      -->
      <securityOption>SIGNATURE_THEN_ENCRYPTION</securityOption>
      <!--Used to identify the encryption certificate to use for this site-->
      <certificateLabel>cert1</certificateLabel>
      <securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId>
      <checksumAlgorithm>MD5</checksumAlgorithm>
    </site>
    <site>
      <id>IDMS-WS-ENROL</id>
      <responseRequired>false</responseRequired>
      <maxRetries>1</maxRetries>
      <!-- Unit is minutes, amount of time during which submission will be suspended after an encountered failure. -->
      <delayBetweenRetries>1</delayBetweenRetries>
      <senderServiceId>morpho.mesa.services.exporters.process.JavascriptSOAPSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/idms-createApplication.js</scriptFile>
    </site>
    <site>
      <id>MIM-WS-1</id>
      <responseRequired>true</responseRequired>
      <maxRetries>1</maxRetries>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.JavascriptSOAPSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/MIM-WS.js</scriptFile>
    </site>
    <site>
      <id>MESA-USB-1</id>
      <maxRetries>3</maxRetries>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <!--Option for security. Possible values :
        ENCRYPTION data is encrypted
        SIGNATURE data is signed
        SIGNATURE_THEN_ENCRYPTION data is signed, then encrypted
        ENCRYPTION_THEN_SIGNATURE data is encrypted then signed
        NONE no signature, no encryption
        
        Default value : NONE
        
        Note that is securityOption is different from NONE, securityManagerId tag must be set (no default value).
        Possible values : 
        morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager to use asymmetrical algorithm (with certificates)
      -->
      <!-- <securityOption>ENCRYPTION</securityOption> -->
      <securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId>
      <!--Name of checksum algorithm (NONE if checksum is not required). Possible values :
        NONE no checksum required
        MD2
        MD5
        SHA1 means SHA-1
        SHA256 means SHA-256
        SHA384 means SHA-384
        SHA512 means SHA-512
        
        Default value : NONE
      -->
      <checksumAlgorithm>MD5</checksumAlgorithm>
    </site>
    <site>
      <id>PEP-NIST-FILE</id>
      <maxRetries>3</maxRetries>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId>
      <checksumAlgorithm>MD5</checksumAlgorithm>
      <scriptFile>CONFIG/scripts-site/MESA-ABIS-POLICE.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
    </site>
    <site>
      <id>CS-NIST-FILE</id>
      <maxRetries>3</maxRetries>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId>
      <checksumAlgorithm>MD5</checksumAlgorithm>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/CS-NIST-FILE.js</scriptFile>
    </site>
    <site>
      <id>CEP-NIST-FILE</id>
      <maxRetries>3</maxRetries>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <checksumAlgorithm>MD5</checksumAlgorithm>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/CEP-NIST-FILE.js</scriptFile>
      <!--Option for security. Possible values :
        ENCRYPTION data is encrypted
        SIGNATURE data is signed
        SIGNATURE_THEN_ENCRYPTION data is signed, then encrypted
        ENCRYPTION_THEN_SIGNATURE data is encrypted then signed
        NONE no signature, no encryption
        
        Default value : NONE
        
        Note that is securityOption is different from NONE, securityManagerId tag must be set (no default value).
        Possible values : 
        morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager to use asymmetrical algorithm (with certificates)
      -->
      <!--<securityOption>SIGNATURE_THEN_ENCRYPTION</securityOption>-->
      <!--Used to identify the encryption certificate to use for this site-->
      <!--<certificateLabel>cert1</certificateLabel>
      <securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId>
      <checksumAlgorithm>MD5</checksumAlgorithm>-->
    </site>
    <site>
      <id>ESB-REST-POST-NIST</id>
      <responseRequired>false</responseRequired>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.HttpSender</senderServiceId>
      <checksumAlgorithm>MD5</checksumAlgorithm>
      <scriptFile>CONFIG/scripts-site/common-HTTP-SENDER.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/ESB-REST-POST-NIST.js</scriptFile>

	  <!--Option for security. Possible values :
        ENCRYPTION data is encrypted
        SIGNATURE data is signed
        SIGNATURE_THEN_ENCRYPTION data is signed, then encrypted
        ENCRYPTION_THEN_SIGNATURE data is encrypted then signed
        NONE no signature, no encryption
        
        Default value : NONE
        
        Note that is securityOption is different from NONE, securityManagerId tag must be set (no default value).
        Possible values : 
        morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager to use asymmetrical algorithm (with certificates)
      -->
      <securityOption>SIGNATURE_THEN_ENCRYPTION</securityOption>
      <!--Used to identify the encryption certificate to use for this site-->
      <certificateLabel>cert1</certificateLabel>
      <securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId>
      <checksumAlgorithm>MD5</checksumAlgorithm>
    </site>
    <site>
      <!--Example site to export issuance result in a file on disk -->
      <id>ISSUANCE-DISK</id>
      <responseRequired>true</responseRequired>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/ISSUANCE-DISK.js</scriptFile>
    </site>
    <site>
      <!-- this site demonstrates how js hooks can be used to customize export process in Mesa -->
      <id>MESA-USB-3-hooks</id>
      <maxRetries>3</maxRetries>
      <descriptorsFile>CONFIG/descriptor/descriptors/nist-file-3.xml</descriptorsFile>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <checksumAlgorithm>SHA1</checksumAlgorithm>
      <!-- file MESA-USB-3.js contains js hooks implementations -->
      <scriptFile>CONFIG/scripts-site/MESA-USB-3.js</scriptFile>
      <!-- file common-NIST-TRANSFORMER.js contains generic functions : generateTCN() as an example -->
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
      <!-- securityOption>SIGNATURE_THEN_ENCRYPTION</securityOption -->
      <!-- securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId -->
    </site>
    <site>
      <id>MBIS-DSM-1</id>
      <responseRequired>true</responseRequired>
      <maxRetries>5</maxRetries>
      <descriptorsFile>CONFIG/descriptor/descriptors/mbis-dsm-1.xml</descriptorsFile>
      <transformerServiceId>morpho.mesa.services.export.morphobis.dsm.DSMTransformer</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/MBIS-DSM-1.js</scriptFile>
    </site>
    <site>
      <id>MESA-CPS</id>
      <descriptorsFile>CONFIG/descriptor/descriptors/mesa-cps.xml</descriptorsFile>
      <transformerServiceId>morpho.mesa.services.printing.iqs.IqsPrintingService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/MESA-CPS.js</scriptFile>
    </site>
    <site>
      <id>MESA-SMTP-1</id>
      <responseRequired>true</responseRequired>
      <maxRetries>5</maxRetries>
      <descriptorsFile>CONFIG/descriptor/descriptors/nist-file-1.xml</descriptorsFile>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.EmailSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/MESA-SMTP-1.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
    </site>
    <site>
      <id>MBIS-SMTP</id>
      <responseRequired>true</responseRequired>
      <maxRetries>5</maxRetries>
      <descriptorsFile>CONFIG/descriptor/descriptors/nist-file-1.xml</descriptorsFile>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.EmailSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/MESA-SMTP-1.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
    </site>
    <site>
      <id>NIST-EBTS-FILE</id>
      <maxRetries>5</maxRetries>
      <descriptorsFile>CONFIG/descriptor/descriptors/nist-file-1.xml</descriptorsFile>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
    </site>
    <site>
      <id>NIST-FILE-1</id>
      <maxRetries>5</maxRetries>
      <descriptorsFile>CONFIG/descriptor/descriptors/nist-file-1.xml</descriptorsFile>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
    </site>
    <site>
      <id>MESA-PERMANENT-VISA</id>
      <transformerServiceId>morpho.mesa.services.printing.formPrint.FormTransformer</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
    </site>
    <site>
      <id>MESA-TEMPORARY-VISA</id>
      <transformerServiceId>morpho.mesa.services.printing.formPrint.FormTransformer</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
    </site>
    <site>
      <id>MESA-APPLICATION-RECEIPT</id>
      <transformerServiceId>morpho.mesa.services.printing.formPrint.FormTransformer</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FileSystemSender</senderServiceId>
    </site>
    <site>
      <id>NIST-EBTS-HTTP</id>
      <maxRetries>5</maxRetries>
      <descriptorsFile>CONFIG/descriptor/descriptors/nist-file-1.xml</descriptorsFile>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.HttpSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/MESA-SMTP-1.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/common-NIST-TRANSFORMER.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/common-HTTP-SENDER.js</scriptFile>
    </site>
    <site>
      <id>MCS-REST-ISSUANCE-FROM-EDOC</id>
      <maxRetries>2</maxRetries>
      <checksumAlgorithm>MD5</checksumAlgorithm>
      <senderServiceId>morpho.mesa.services.exporters.process.HttpSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/common-HTTP-SENDER.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/MCS-REST-ISSUANCE-FROM-EDOC.js</scriptFile>
    </site>
    <site>
      <id>MCS-REST-ISSUANCE-FROM-RECEIPT</id>
      <maxRetries>2</maxRetries>
      <checksumAlgorithm>MD5</checksumAlgorithm>
      <senderServiceId>morpho.mesa.services.exporters.process.HttpSender</senderServiceId>
      <scriptFile>CONFIG/scripts-site/common-HTTP-SENDER.js</scriptFile>
      <scriptFile>CONFIG/scripts-site/MCS-REST-ISSUANCE-FROM-RECEIPT.js</scriptFile>
    </site>
    <site>
      <id>CUSTOM-WS</id>
      <maxRetries>5</maxRetries>
      <transformerServiceId>morpho.mesa.services.exporters.process.MesaXmlTransformer</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.JavascriptSOAPSender</senderServiceId>
    </site>
    <site>
      <id>MESA-FTP-1</id>
      <maxRetries>5</maxRetries>
      <transformerServiceId>morpho.mesa.services.nist.mcp.MCPNistTransformerService</transformerServiceId>
      <senderServiceId>morpho.mesa.services.exporters.process.FtpSender</senderServiceId>
    </site>
  </service>

  <!--####################################################################################################################-->
  <!--############################## Response Site Repository Configuration ##############################################-->
  <!-- 
        Defines all response sites supported by MESA application in order to receive export result :
            - Receiver Protocol Type. 
            - Response Processing Type.
  
        Example of available configuration  :
            - receiverServiceId : To define Receiver Protocol Service.
                  Possible values : - EmailReceiver : Email (SMTP) Reception.
          
            - processorServiceId : To define the Response Processing Service.
                  Possible values : - MCPNistProcessor : NIST File Processing.
    -->
  <service id="morpho.mesa.common.configuration.ResponseSiteRepository">
  <!--The sites that will be considered-->
  <activeSiteIds>ABIS-SERVER-RESPONSE</activeSiteIds>
  <!--Delay between each iteration for response fetching -->
  <responseServiceExecutionInterval>1000000</responseServiceExecutionInterval>
  <site>
      <id>ABIS-SERVER-RESPONSE</id>
      <receiverServiceId>morpho.mesa.services.importers.process.EmailReceiver</receiverServiceId>
      <processorServiceId>morpho.mesa.services.nist.mcp.MCPNistProcessor</processorServiceId>
      <mapSubmissionResponse>SUBMISSION_TCN,TCR</mapSubmissionResponse>
      <scriptFile>CONFIG/scripts-site/POP3-SERVER.js</scriptFile>
      <!--Option for security. Possible values :
        DECRYPTION: data is decrypted
        VERIFICATION: signed data is verified
        VERIFICATION_THEN_DECRYPTION: data is verified, then decrypted
        DECRYPTION_THEN_VERIFICATION: data is decrypted then verified
        NONE: no data verification, no decryption
        
        Default value : NONE
        
        Note that is securityOption is different from NONE, securityManagerId tag must be set (no default value).
        Possible values : 
        morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager to use asymetrical algorithm (with certificates)
      -->
      <securityOption>DECRYPTION_THEN_VERIFICATION</securityOption>
      <securityManagerId>morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager</securityManagerId>
    </site>
    <site>
      <id>REST-SERVER-RESPONSE</id>
      <receiverServiceId>morpho.mesa.services.importers.process.HttpReceiver</receiverServiceId>
      <processorServiceId>morpho.mesa.services.importers.process.JsonPocessor</processorServiceId>
      <mapSubmissionResponse>SUBMISSION_TCN,TCN</mapSubmissionResponse>
      <scriptFile>CONFIG/scripts-site/REST-SERVER.js</scriptFile>
    </site>
  </service>

  <!--####################################################################################################################-->
  <!--...................... Configuration for MBIS-DSM-1 Export site .....................-->
  <!--........................... Transformer Type : DSMTransformer ...........................-->
  <service id="morpho.mesa.services.export.morphobis.dsm.DSMTransformer/MBIS-DSM-1">
    <!-- Name of the application.-->
    <appName>MESA</appName>
    <!-- Version of the application.-->
    <appVersion>3.0</appVersion>
    <!-- Content type-->
    <contentType>TENPRINT</contentType>
    <!-- Priority of the submission-->
    <priority>7</priority>
    <!-- Originating agency-->
    <origAgency>Morphotrak</origAgency>
    <!-- Destination agency-->
    <destAgency>Morphotrak</destAgency>
    <!-- Backhand search parameters.-->
    <tParamAdd>false</tParamAdd>
    <tParamPriority>7</tParamPriority>
    <tParamSupersede>false</tParamSupersede>
    <tParamDbToSearch>TENPRINT</tParamDbToSearch>
    <tParamNumOfCandidates>10</tParamNumOfCandidates>
    <!-- Specifies case type.-->
    <descriptorCaseType>Criminal</descriptorCaseType>
    <!-- Determines if xslt transformation should be performed on descriptors data.-->
    <performDescriptorsConversion>false</performDescriptorsConversion>
    <!-- Specifies mugdshot horizontal resolution.-->
    <mugshotHorizontalPixelScale>1</mugshotHorizontalPixelScale>
    <!-- Specifies mugdshot horizontal resolution.-->
    <mugshotVerticalPixelScale>1</mugshotVerticalPixelScale>
    <!-- Specifies xslt transformation definition file location.-->
    <xsltLocation>CONFIG/xslt/mesa_2_mbis_descriptors.xsl</xsltLocation>
  </service> 

  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/MBIS-DSM-1">
    <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
    For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
    -->
    <driveName />
    <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
    Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
    e.g. [Windows-like]      C:\MesaStorage\Export
    e.g. [Windows-like]      MesaStorage/Export  (the folder MesaStorage is created in the current path)
    e.g. [Windows-like]      C:/MesaStorage/Export  (the folder MesaStorage is created in the current path)      
    e.g. [Linux-like]        /MesaStorage/Export
    e.g. [Network-share]     \\network-drive\export\ptkosm
    -->
    <path>C:/PtkOSM/tenprints</path>
    <filter />
    <!-- it is IMPORTANT to write the .trigger file as the last one (after all other DSM files) -->
    <lastToWrite>.*\.trigger</lastToWrite>
  </service> 

  <!--.........................................................................................-->
  <!--####################################################################################################################-->

  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
    <!--........................... Transformer Type : MCPNistTransformerService...........................-->
   <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/ABIS-SERVER-POLICE">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>pep_nist_2011_binary</adapter>
    <mesaDataAdapterBase>pep_mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>nist_2011_binary_js</mesaDataAdapterOverload>
    <!--debug>true</debug-->
    <!--tracePath>file:///C:/MesaStorage/tmp</tracePath-->
  </service>

   <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/ABIS-SERVER-QuickIdent">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>pep_nist_2011_binary</adapter>
    <mesaDataAdapterBase>pep_mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>nist_2011_binary_js</mesaDataAdapterOverload>
    <!--debug>true</debug-->
    <!--tracePath>file:///C:/MesaStorage/tmp</tracePath-->
  </service>

  <!--.........................................................................................-->
  <!--...................... Configuration for MorphoIM-WS-1 Export site .......................-->
  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/MIM-WS-1">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>mim_7_4_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>mim_7_4_binary_js</mesaDataAdapterOverload>
    <!--debug>true</debug-->
    <!--tracePath>file:///C:/MesaStorage/tmp</tracePath-->
  </service> 

  <!--........................... Sender Type : MorphoIMSender ................................-->
  <service id="morpho.mesa.services.exporters.process.JavascriptSOAPSender/MIM-WS-1">
    <scriptFile>CONFIG/scripts-service/javascript-soap-sender/morpho-im-sender.js</scriptFile>
    <wsdlLocation>ToBeDefined</wsdlLocation>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for MESA-USB-1 Export site .....................-->
  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/MESA-USB-1">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>nist_2011_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>nist_2011_binary_js</mesaDataAdapterOverload>
    <!-- <debug>true</debug> -->
  </service> 

  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/MESA-USB-1">
    <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
    For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
    -->
    <driveName></driveName>
    <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
    Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
    e.g. [Windows-like]      C:\MesaStorage\Export
    e.g. [Windows-like]      MesaStorage/Export  (the folder MesaStorage is created in the current path)
    e.g. [Windows-like]      C:/MesaStorage/Export  (the folder MesaStorage is created in the current path)      
    e.g. [Linux-like]        /MesaStorage/Export
    e.g. [Network-share]     \\network-drive\export\ptkosm
    -->
    <path>C:\MesaStorage\Export</path>
  </service>
  <!--.........................................................................................-->
  <!--...................... Configuration for PEP-NIST-FILE Export site .....................-->
  <!--.......................Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/PEP-NIST-FILE">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>pep_nist_2011_binary</adapter>
    <mesaDataAdapterBase>pep_mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>nist_2011_binary_js</mesaDataAdapterOverload>
  </service> 
  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/PEP-NIST-FILE">    
    <driveName></driveName>
    <path>/MesaStorage/PEP-NIST-FILE</path>
  </service>

   <!--.........................................................................................-->
  <!--...................... Configuration for CS-NIST-FILE Export site .....................-->
  <!--.......................Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/CS-NIST-FILE">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>cs_nist_2011_binary</adapter>
    <mesaDataAdapterBase>cs_mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>nist_2011_binary_js</mesaDataAdapterOverload>
  </service> 
  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/CS-NIST-FILE">    
    <driveName></driveName>
    <path>/MesaStorage/CS-NIST-FILE</path>
  </service>

  <!--.........................................................................................-->
  <!--...................... Configuration for CEP-NIST-FILE Export site .....................-->
  <!--.......................Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/CEP-NIST-FILE">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>mcvs_nist_2011_binary</adapter>
    <mesaDataAdapterBase>mcvs_mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>nist_2011_binary_js</mesaDataAdapterOverload>
  </service> 
  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/CEP-NIST-FILE">    
    <driveName></driveName>
    <path>C:/MesaStorage/CEP-NIST-FILE</path>
  </service>

  <!--LIMITATION IN THIS VERSION OF MESA : senderKeystore and senderTrustStore must be the same as of the response site mentioned in activeSiteIds tag.-->
  <!--.........................................................................................-->
  <!--...................... Configuration for ESB-REST-POST-NIST Export site .....................-->
  <!--.......................Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.exporters.process.HttpSender/ESB-REST-POST-NIST">
    <httpMethod>POST</httpMethod>
    <!--"nginx" refers to the CN (Common name) in the keystore, and should be mapped to the real server IP/name in the "hosts" file-->
    <baseUrl>https://nginx</baseUrl>
    <port>499</port>
    <complementRequestUrl>api/v1/NIST</complementRequestUrl>
    <!-- Defines the name of the header that will be used to send the generated attachement digest -->
    <headerNameForCheckSum>Digest</headerNameForCheckSum>
    <!-- Defines delimeter that will be used between the configured digest algorithm and the calcullated digest -->
    <headerDelimeterForCheckSum>=</headerDelimeterForCheckSum>
    
	
	<!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
      <checkCertificatesValidity>false</checkCertificatesValidity>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore>
        <path>CONFIG/security/keystore/client.keystore.jks</path>
        <password>genericsecuritystorepwd2</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/server.truststore.jks</path>
        <password>genericsecuritystorepwd2</password>
      </senderTrustStore>  
    </senderSecurityConfiguration>  
  </service>

  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/ESB-REST-POST-NIST">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>mcvs_nist_2011_binary</adapter>
    <mesaDataAdapterBase>mcvs_mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>nist_2011_binary_js</mesaDataAdapterOverload>
  </service>

  <service id="morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCertificatesManager">
    <referencePKIComponents>
      <!-- 
             Trust anchors are root certificates. When a certificate is verified, its 
             certificates chain is verified with these trusted anchors
             trustAnchorPath value must be the path to a PEM file that contains a certificate
             No default value
      -->
      <trustAnchorPath>CONFIG/security/truststore/Computers_CA_Technical_Root_CA_.cer</trustAnchorPath>
      
      <trustAnchorPath>CONFIG/security/truststore/Operators_CA_Technical_Root_CA_.cer</trustAnchorPath>
      
      <trustAnchorPath>CONFIG/security/CA/ca.cert.pem</trustAnchorPath>
      
      <trustAnchorPath>CONFIG/security/crypto/cacert.pem</trustAnchorPath>
      
      <trustAnchorPath>CONFIG/security/truststore/Technical_Root_CA.cer</trustAnchorPath>
      
      <trustAnchorPath>CONFIG/security/truststore/serversca.cer</trustAnchorPath>
      
      <trustAnchorPath>CONFIG/security/truststore/technicalrootca.cer</trustAnchorPath>
      <!--trustAnchorPath>CONFIG/security/CA/intermediate.cert.pem</trustAnchorPath-->
      <!-- 
          the revocation mode to be used
          possible values : 
            -Configuration (default): if specified the <crl> must contain the path to The local PEM CRL 
            -DistributionPoint : if specified the <crl> must be removed
			-Disable :  used to skip CRL verification, generally in development or integration environment, for test purposes only. 
			            To be avoided while in production, otherwise, expired certificates may be used !.
      -->
      <!--revocationMode>Configuration</revocationMode>
      <crl>CONFIG/security/CRL/intermediate.crl.pem</crl>
      <crl>CONFIG/security/CRL/ca.crl.pem</crl-->
      <revocationMode>Disable</revocationMode>
      
    </referencePKIComponents>
  </service> 

  <service id="morpho.mesa.services.security.cryptAndSign.mcpcompsec.internal.Activator">
    <useCertificatesManager>true</useCertificatesManager>
  </service> 

  <!--........................... Cryptography  settings ...........................-->
  <service id="morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager/MESA-USB-1">
    <cryptoComponents>
      <!--
        Path to PEM file that contains the certificate to use for encryption
      -->
      <encryptionCertificatePath>CONFIG/security/crypto/encryption1.cert.pem</encryptionCertificatePath>
      <!-- 
           The key store containing the private key and certificate ; 
           this keys tore will be used for signing data. 
           keystorePath : The path to the key store
           keystorePassword : The key of the password (have a look at mesaPasswords.properties) 
      -->
      <signingKeystore>
        <keystorePath>CONFIG/security/crypto/signing.jks-keystore.jks</keystorePath>
        <keystorePassword>signingKeystorePassword</keystorePassword>
      </signingKeystore>
      <!-- 
           The key store containing the decryption certificates  
           this key store will be used for decrypting encrypted files. 
           keystorePath : The path to the key store
           keystorePassword : The key of the password (have a look at mesaPasswords.properties)
      -->
      <!--decryptionKeystore>
        <keystorePath>CONFIG/security/crypto/decryption-keystore.jks</keystorePath>
        <keystorePassword>decryptionKeystorePassword</keystorePassword>
      </decryptionKeystore-->
    </cryptoComponents>
  </service>

  <service id="morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager/CEP-NIST-FILE">
    <compSecPKCS7ConfMode>FROM_PATH</compSecPKCS7ConfMode>
    <!--The .xml file must be added manually, it does not exist on SVN-->
    <compSecPKCS7ConfPath>CONFIG/security/crypto/pkcs7.xml</compSecPKCS7ConfPath>
  </service> 
  <service id="morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager/ABIS-SERVER-POLICE">
    <compSecPKCS7ConfMode>FROM_PATH</compSecPKCS7ConfMode>
    <!--The .xml file must be added manually, it does not exist on SVN-->
    <compSecPKCS7ConfPath>CONFIG/security/crypto/pkcs7.xml</compSecPKCS7ConfPath>
  </service> 
  <service id="morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager/ABIS-SERVER-RESPONSE">
    <compSecPKCS7ConfMode>FROM_PATH</compSecPKCS7ConfMode>
    <!--The .xml file must be added manually, it does not exist on SVN-->
    <compSecPKCS7ConfPath>CONFIG/security/crypto/pkcs7.xml</compSecPKCS7ConfPath>
  </service> 
    <service id="morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager/ABIS-SERVER-QuickIdent">
    <compSecPKCS7ConfMode>FROM_PATH</compSecPKCS7ConfMode>
    <!--The .xml file must be added manually, it does not exist on SVN-->
    <compSecPKCS7ConfPath>CONFIG/security/crypto/pkcs7.xml</compSecPKCS7ConfPath>
  </service> 
  <service id="morpho.mesa.services.security.cryptAndSign.mcpcompsec.MesaMCPCryptoManager/ABIS-SERVER-ESB-REST-POST-NIST">
    <compSecPKCS7ConfMode>FROM_PATH</compSecPKCS7ConfMode>
    <!--The .xml file must be added manually, it does not exist on SVN-->
    <compSecPKCS7ConfPath>CONFIG/security/crypto/pkcs7.xml</compSecPKCS7ConfPath>
  </service> 
  <!--...................... Configuration for ISSUANCE-DISK Export site .....................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/ISSUANCE-DISK">
    <driveName>OSDisk</driveName>
    <path>MesaStorage/Issuance</path>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for MESA-USB-3-hooks Export site .....................-->
  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/MESA-USB-3-hooks">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>nist_2011_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>nist_2011_binary_usb_3_js</mesaDataAdapterOverload>
  </service> 

  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/MESA-USB-3-hooks">
    <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
    For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
    -->
    <driveName />
    <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
    Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
    e.g. [Windows-like]      C:\MesaStorage\Export
    e.g. [Windows-like]      MesaStorage/Export  (the folder MesaStorage is created in the current path)
    e.g. [Windows-like]      C:/MesaStorage/Export  (the folder MesaStorage is created in the current path)      
    e.g. [Linux-like]        /MesaStorage/Export
    e.g. [Network-share]     \\network-drive\export\ptkosm
    -->
    <path>MesaStorage\Export</path>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for MESA-SMTP-1 Export site ....................-->
  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/MESA-SMTP-1">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <!--debug>true</debug-->
  </service> 

  <!--........................... Sender Type : EmailSender ...................................-->
  <service id="morpho.mesa.services.exporters.process.EmailSender/ABIS-SERVER-POLICE">
    <fromAddress>mesabox@mesa.com</fromAddress>
    <toAddress>mbisbox@mesa.com</toAddress>
    <port>587</port>
    <mailHost>10.129.70.126</mailHost>
    <mailMessage>This is a dossier of Police Procedure</mailMessage>
    <mailSubject>Dossier of Police Procedure</mailSubject>
    <authPassword>emailSenderSMTP1Password</authPassword>
    <authUser>mesabox@mesa.com</authUser>
    <singlePart>false</singlePart>
    <!-- It's recommended to use STARTTLS (since SSL/TLS is deprecated) but you still can set <starttls> to "false" if you need to use SSL/TLS -->
    <starttls>true</starttls>
    <timeout>120</timeout>

    <senderSecurityConfiguration>
      <checkCertificatesValidity>true</checkCertificatesValidity>
       <!-- TLS version to use -->
      <httpsProtocols>TLSv1.2</httpsProtocols>          
      <senderTrustStore>
        <path>CONFIG/security/truststore/mesasecurity.jks</path>
        <password>genericsecuritystorepwd</password>
        <certsToVerify>ALL</certsToVerify>
      </senderTrustStore> 
		</senderSecurityConfiguration>

  </service>  

  <service id="morpho.mesa.services.exporters.process.EmailSender/ABIS-SERVER-QuickIdent">
    <fromAddress>mesabox@mesa.com</fromAddress>
    <toAddress>mbisbox@mesa.com</toAddress>
    <port>587</port>
    <mailHost>10.129.70.126</mailHost>
    <mailMessage>This is a dossier of QuickIdent Procedure</mailMessage>
    <mailSubject>Dossier of QuickIdent Procedure</mailSubject>
    <authPassword>emailSenderSMTP1Password</authPassword>
    <authUser>mesabox@mesa.com</authUser>
    <singlePart>false</singlePart>
	<starttls>true</starttls>
    <timeout>120</timeout>

    <senderSecurityConfiguration>
	<checkCertificatesValidity>true</checkCertificatesValidity>
       <!-- TLS version to use -->
      <httpsProtocols>TLSv1.2</httpsProtocols>          
      <senderTrustStore>
        <path>CONFIG/security/truststore/mesasecurity.jks</path>
        <password>genericsecuritystorepwd</password>
        <certsToVerify>ALL</certsToVerify>
      </senderTrustStore> 
		</senderSecurityConfiguration>

  </service>  

  <service id="morpho.mesa.services.exporters.process.EmailSender/MESA-SMTP-1">
    <fromAddress>ToBeDefined</fromAddress>
    <toAddress>ToBeDefined</toAddress>
    <!-- host -->
    <mailHost>ToBeDefined</mailHost>
    <port>ToBeDefined</port>
    <!-- Message -->
    <mailMessage>This is only a test!!</mailMessage>
    <mailSubject>Read Me</mailSubject>
    <singlePart>false</singlePart>
    <!-- Authentication (if not required remove or empty those keys) -->
    <authUser>ToBeDefined</authUser>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <authPassword>ToBeDefined</authPassword>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for MBIS-SMTP Export site ....................-->
  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/MBIS-SMTP">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <mesaDataAdapterEntryPoint>main_ebts</mesaDataAdapterEntryPoint>
    <mesaDataAdapterEntryPointDebug>main_ebts_debug</mesaDataAdapterEntryPointDebug>
    <!--debug>true</debug-->
  </service> 

  <!--........................... Sender Type : EmailSender ...................................-->
  <service id="morpho.mesa.services.exporters.process.EmailSender/MBIS-SMTP">
    <fromAddress>mesa@mesa.com</fromAddress>
    <toAddress>External@mesa.com</toAddress>
    <mailHost>localhost</mailHost>
    <mailMessage>This is only a test!!</mailMessage>
    <mailSubject>Read Me</mailSubject>
    <authPassword>emailSenderMESAEBTSSMTPPassword</authPassword>
    <authUser>External</authUser>
    <singlePart>false</singlePart>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for NIST-EBTS-FILE Export site ....................-->
  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/NIST-EBTS-FILE">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <mesaDataAdapterEntryPoint>main_ebts</mesaDataAdapterEntryPoint>
    <mesaDataAdapterEntryPointDebug>main_ebts_debug</mesaDataAdapterEntryPointDebug>
    <!--debug>true</debug-->
  </service> 

  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/NIST-EBTS-FILE">
    <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
    For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
    -->
    <driveName>OSDisk</driveName>
    <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
    Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
    e.g. [Windows-like]      C:\MesaStorage\Export
    e.g. [Windows-like]      MesaStorage/Export  (the folder MesaStorage is created in the current path)
    e.g. [Windows-like]      C:/MesaStorage/Export  (the folder MesaStorage is created in the current path)      
    e.g. [Linux-like]        /MesaStorage/Export
    e.g. [Network-share]     \\network-drive\export\ptkosm
    -->
    <path>MesaStorage/Backup1</path>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for NIST-FILE-1 Export site ....................-->
  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/NIST-FILE-1">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <!--debug>true</debug-->
  </service> 

  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/NIST-FILE-1">
    <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
    For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
    -->
    <driveName />
    <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
    Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
    e.g. [Windows-like]      C:\MesaStorage\Export
    e.g. [Windows-like]      MesaStorage/Export  (the folder MesaStorage is created in the current path)
    e.g. [Windows-like]      C:/MesaStorage/Export  (the folder MesaStorage is created in the current path)      
    e.g. [Linux-like]        /MesaStorage/Export
    e.g. [Network-share]     \\network-drive\export\ptkosm
    -->
    <path>MesaStorage/Backup2</path>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for NIST-EBTS-HTTP Export site ....................-->
  <!--........................... Transformer Type : MCPNistTransformerService...........................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/NIST-EBTS-HTTP">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <mesaDataAdapterEntryPoint>main_ebts</mesaDataAdapterEntryPoint>
    <mesaDataAdapterEntryPointDebug>main_ebts_debug</mesaDataAdapterEntryPointDebug>
    <!--debug>true</debug-->
  </service> 

  <!--........................... Sender Type : HttpSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.HttpSender/NIST-EBTS-HTTP">
    <!-- HTTP method: PUT (default) or POST. -->
    <httpMethod>PUT</httpMethod>
    <!-- URL where the data is sent -->
    <!-- baseUrl : it defines the IP of the server                                                        -->
    <!-- port : it defines the port used for the exchanges with the central system                        -->
    <!-- complementRequestUrl : it defines the complement of the baseUrl (to generate the complete URL)   -->
    <baseUrl>http://localhost</baseUrl>
    <complementRequestUrl>/ws/v1/data/{UUID}</complementRequestUrl>
    <contentType>application/octet-stream</contentType>
  </service> 

  <!--..................................................................................-->
  <!--........................... Sender Type : HttpSender .............................-->
  <!--..................................................................................-->
  <service id="morpho.mesa.services.exporters.process.HttpSender/MCS-REST-ISSUANCE-FROM-EDOC">
    <!-- HTTP method used to send the request : PUT (default) or POST. -->
    <httpMethod>POST</httpMethod>
    <!--********************** URL where the data is sent is divided in three parts **********************-->
    <!-- baseUrl : it defines the IP of the server                                                        -->
    <!-- port : it defines the port used for the exchanges with the central system                        -->
    <!-- complementRequestUrl : it defines the complement of the baseUrl (to generate the complete URL)   -->
    <baseUrl>ToBeDefined</baseUrl>
    <port>ToBeDefined</port>
    <complementRequestUrl>/document/api/v1/{documentType}/{documentNumber}/issuance</complementRequestUrl>
    <!--*********************************** HTTP Headers ***********************************-->
    <!-- accept defines which types are acceptable for the server response                  -->
    <!-- contentType defines the type of the elements contained in the payload (attachment) -->
    <accept>application/json</accept>
    <contentType>application/json</contentType>
	
    <!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore> 
        <path>CONFIG/security/keystore/keystore.jks</path>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <password>issuanceSenderKeytStorePassword</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/truststore.jks</path>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <password>issuanceSenderTrustStorePassword</password>
      </senderTrustStore>   
    </senderSecurityConfiguration>
  </service> 

  <!--..................................................................................-->
  <!--........................... Sender Type : HttpSender .............................-->
  <!--..................................................................................-->
  <service id="morpho.mesa.services.exporters.process.HttpSender/MCS-REST-ISSUANCE-FROM-RECEIPT">
    <!-- HTTP method used to send the request : PUT (default) or POST. -->
    <httpMethod>POST</httpMethod>
    <!--******************* URL where the data is sent is divided in three parts ********************-->
    <!-- baseUrl defines the IP of the server                                                        -->
    <!-- port defines the port used for the exchanges with the central system                        -->
    <!-- complementRequestUrl defines the complement of the baseUrl (to generate the complete URL)   -->
    <baseUrl>http://localhost</baseUrl>
    <port>8087</port>
    <complementRequestUrl>/document/api/v1/{documentType}/{documentNumber}/issuance</complementRequestUrl>
    <!--*********************************** HTTP Headers ***********************************-->
    <!-- accept defines which types are acceptable for the server response                  -->
    <!-- contentType defines the type of the elements contained in the payload (attachment) -->
    <accept>application/json</accept>
    <contentType>application/json</contentType>
    <!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
	  <checkCertificatesValidity>false</checkCertificatesValidity>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore> 
        <path>CONFIG/security/keystore/keystore.jks</path>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <password>issuanceSenderKeytStorePassword</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/truststore.jks</path>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <password>issuanceSenderTrustStorePassword</password>
      </senderTrustStore>   
    </senderSecurityConfiguration>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for MESA-PERMANENT-VISA site .......................-->
  <!--........................... Transformer Type : FormTransformer .......................-->
  <service id="morpho.mesa.services.printing.formPrint.FormTransformer/MESA-PERMANENT-VISA">
    <formTemplateFilePath>CONFIG/pdf-printing-formats/permanent-visa.fmt</formTemplateFilePath>
    <mappingFilePath>CONFIG/pdf-printing-formats/permanent-temporary-visa-mapping.js</mappingFilePath>
    <scriptFile>CONFIG/pdf-printing-formats/permanent-temporary-visa-script.js</scriptFile>
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for MESA-TEMPORARY-VISA site .......................-->
  <!--........................... Transformer Type : FormTransformer .......................-->
  <service id="morpho.mesa.services.printing.formPrint.FormTransformer/MESA-TEMPORARY-VISA">
    <formTemplateFilePath>CONFIG/pdf-printing-formats/temporary-visa.fmt</formTemplateFilePath>
    <mappingFilePath>CONFIG/pdf-printing-formats/permanent-temporary-visa-mapping.js</mappingFilePath>
    <scriptFile>CONFIG/pdf-printing-formats/permanent-temporary-visa-script.js</scriptFile>
  </service>


  <!--.........................................................................................-->
  <!--...................... Configuration for MESA-APPLICATION-RECEIPT- site .......................-->
  <!--........................... Transformer Type : FormTransformer .......................-->
  <service id="morpho.mesa.services.printing.formPrint.FormTransformer/MESA-APPLICATION-RECEIPT">
    <formTemplateFilePath>CONFIG/pdf-printing-formats/application-receipt.fmt</formTemplateFilePath>
    <mappingFilePath>CONFIG/pdf-printing-formats/application-receipt-mapping.js</mappingFilePath>
    <scriptFile>CONFIG/pdf-printing-formats/permanent-temporary-visa-script.js</scriptFile>
  </service>

  <!--........................... Transformer Type : IqsPrintingService .......................-->
  <service id="morpho.mesa.services.printing.iqs.IqsPrintingService/MESA-CPS">
    <cardFormat>standard-fbi-applicant.fmt</cardFormat>
    <printer>PdfWriter</printer>
    <copies>1</copies>
    <performDescriptorsConversion>true</performDescriptorsConversion>
    <xsltLocation>CONFIG/printing-formats/mesa2card.xsl</xsltLocation>
  </service> 

  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/MESA-CPS">
    <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
    For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
    -->
    <driveName />
    <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
    Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
    e.g. [Windows-like]      C:\MesaStorage\Export
    e.g. [Linux-like]        C:/MesaStorage/Export
    e.g. [Network-share]     \\network-drive\export\ptkosm
    -->
    <path>C:\MesaStorage\cps\input</path>
    <filter />
    <!-- it is IMPORTANT to write the .printjob file as the last one (after all other CPS files) -->
    <lastToWrite>.*\.printjob</lastToWrite>
  </service> 

  <!--.........................................................................................-->
  <!--........................... Sender Type : FileSystemSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FileSystemSender/MESA-PERMANENT-VISA">
    <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
    For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
    -->
    <driveName />
    <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
    Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
    e.g. [Windows-like]      C:\MesaStorage\Export
    e.g. [Windows-like]      MesaStorage/Export  (the folder MesaStorage is created in the current path)
    e.g. [Windows-like]      C:MesaStorage/Export  (the folder MesaStorage is created in the current path)      
    e.g. [Linux-like]        /MesaStorage/Export
    e.g. [Network-share]     \\network-drive\export\ptkosm
    -->
    <path>C:\MesaStorage\ApplicationForm</path>
  </service> 

  <service id="morpho.mesa.services.exporters.process.FileSystemSender/MESA-TEMPORARY-VISA">
    <path refSource="morpho.mesa.services.exporters.process.FileSystemSender/MESA-PERMANENT-VISA" ref="/path" />
  </service>

   <service id="morpho.mesa.services.exporters.process.FileSystemSender/MESA-APPLICATION-RECEIPT">
    <path refSource="morpho.mesa.services.exporters.process.FileSystemSender/MESA-PERMANENT-VISA" ref="/path" />
  </service> 

  <!--.........................................................................................-->
  <!--..................................................................................-->
  <!--....................... Configuration for MESA-FTP-1 Export site .................-->
  <!--..................................................................................-->
  <!--........................ Transformer Type : MCPNistTransformerService.......................-->
  <!--..................................................................................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistTransformerService/MESA-FTP-1">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_binary_js</mesaDataAdapterOverload>
    <!--debug>true</debug-->
  </service> 

  <!--........................... Sender Type : FtpSender ..............................-->
  <service id="morpho.mesa.services.exporters.process.FtpSender/MESA-FTP-1">
    <!-- host -->
    <ftpHost>localhost</ftpHost>
    <ftpPort>21</ftpPort>
    <authUser>mesa</authUser>
    <authPassword>ftpAuthPassword</authPassword>
    <remoteRootFolder>MESA-FTP-1</remoteRootFolder>
    <usePassiveMode>true</usePassiveMode>
    <!-- FTP specific SSL Configuration -->
    <!-- set to true if ftp server requires TLS session resumption on data connection when using prop P -->
    <enableTlsSessionResumption>true</enableTlsSessionResumption>
    <!-- File Transfer security set on server side : 
          C - Clear
          S - Safe(SSL protocol only)
          E - Confidential(SSL protocol only)
          P - Private -->
    <fileTransferSecurity>P</fileTransferSecurity>
    <!-- SSL configuration -->
    <senderSecurityConfiguration>
      <senderTrustStore>
        <path>CONFIG/security/truststore/truststore.jks</path>
        <password>genericsecuritystorepwd</password>
        <certsToVerify>ALL</certsToVerify>
      </senderTrustStore>
    </senderSecurityConfiguration>
  </service> 

  <!--....................... Configuration for CUSTOM-WS Export site .................-->
  <!--......................... Sender Type : JavascriptSOAPSender ....................-->
  <service id="morpho.mesa.services.exporters.process.JavascriptSOAPSender/CUSTOM-WS">
    <scriptFile>CONFIG/scripts-service/javascript-soap-sender/export-sbpda.js</scriptFile>
    <wsdlLocation>http://localhost:8088/mocksoap12Binding?WSDL</wsdlLocation>
  </service> 

  <!--####################################################################################################################-->
  <!--######################################## Response Sites Configuration ##############################################-->
  <!-- 
        Defines the configuration for each response site declared in Response site Repository.
        The response site describe two configuration points
            - Receiver. 
            - Processor.
    -->
  <service id="morpho.mesa.services.importers.process.HttpReceiver/REST-SERVER-RESPONSE">
    <httpMethod>GET</httpMethod>
    <!--"nginx" refers to the CN (Common name) in the keystore, and should be mapped to the real server IP/name in the "hosts" file-->
    <baseUrl>https://nginx</baseUrl>
    <port>443</port>
    <complementRequestUrl>?mesa={stationID}</complementRequestUrl>
    <accept>application/json</accept>
    <contentType>application/json</contentType>
	
	<!--***************** Security configuration *****************-->
    <senderSecurityConfiguration>
      <checkCertificatesValidity>false</checkCertificatesValidity>
      <httpsProtocols>TLSv1.2</httpsProtocols>
      <httpsCipherSuites>ALL_SUPPORTED</httpsCipherSuites>
      <senderKeystore>
        <path>CONFIG/security/keystore/client.keystore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/server.truststore.jks</path>
        <password>genericsecuritystorepwd</password>
      </senderTrustStore>  
    </senderSecurityConfiguration>  
  </service> 

  <!--...................... Configuration for IMAP-SERVER Response site ......................-->
  <!--........................... Receiver Type : EmailReceiver ...............................-->
  <service id="morpho.mesa.services.importers.process.EmailReceiver/ABIS-SERVER-RESPONSE">
    <mailProtocol>POP3S</mailProtocol>
    <mailHost>10.129.70.126</mailHost>
    <mailPort>112</mailPort>
    <!-- Mailbox credentials (username and password) -->
    <authUser>mesabox@mesa.com</authUser>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <authPassword>emailSenderSMTP1Password</authPassword>
    <timeout>120</timeout>
    <markReceivedMessagesAsRead>true</markReceivedMessagesAsRead>
    <skipMessagesMarkedAsRead>true</skipMessagesMarkedAsRead>
    <keepMessagesOnServer>false</keepMessagesOnServer>
    <defaultContentDisposition>attachment</defaultContentDisposition>

    <senderSecurityConfiguration>
      <httpsProtocols>TLSv1.2</httpsProtocols>          
      <senderKeystore>
        <path>CONFIG/security/keystore/client.keystore.jks</path>
        <password>genericsecuritystorepwd2</password>
      </senderKeystore>
      <senderTrustStore>
        <path>CONFIG/security/truststore/server.truststore.jks</path>
        <password>genericsecuritystorepwd2</password>
      </senderTrustStore>  
	</senderSecurityConfiguration>
  </service> 

  <service id="morpho.mesa.services.importers.process.EmailReceiver/IMAP-SERVER">
    <!-- Mail server type/protocol.
    Valid values: 
    'POP3'  (plain POP3, unsecure)
    'POP3S' (POP3 + SSL, secure, encrypted)
    'IMAP', (plain IMAP, unsecure)
    'IMAPS' (IMAP + SSL, secure, encrypted)
    -->
    <mailProtocol>IMAPS</mailProtocol>
    <!-- Mail server hostname or IP -->
    <mailHost>10.129.70.126</mailHost>
    <!-- Mail server port. 
    Port is automatically determined based on 'mailProtocol' and 'useSSL' parameter. 
    Change ONLY if using non-standard port! -->
    <mailPort>143</mailPort>
    <!-- Mailbox credentials (username and password) -->
    <authUser>mesabox@mesa.com</authUser>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <authPassword>emailSenderSMTP1Password</authPassword>
    <!-- Connection timeout in seconds [default: 120 seconds] -->
    <timeout>120</timeout>
    <!-- Mark received messages as 'Read' [default: true]. 
    Useful for IMAP mailbox, to skip processing already received emails.
    -->
    <markReceivedMessagesAsRead>true</markReceivedMessagesAsRead>
    <!-- Skip messages (don't process) already marked as 'Read' [default: true] -->
    <skipMessagesMarkedAsRead>true</skipMessagesMarkedAsRead>
    <!-- Leave a copy of messages on the server [default: true] -->
    <keepMessagesOnServer>true</keepMessagesOnServer>
    <!--If the "Content-Disposition" header is missing then default the value to "attachment" (BodyPart.ATTACHMENT)-->
    <defaultContentDisposition>attachment</defaultContentDisposition>

    <senderSecurityConfiguration>
      <httpsProtocols>TLSv1.2</httpsProtocols>          
      <senderTrustStore>
        <path>Path to TrustStore (jks file)</path>
        <password>genericsecuritystorepwd</password>
        <certsToVerify>ALL</certsToVerify>
      </senderTrustStore> 
		</senderSecurityConfiguration>
  </service> 

  <!--........................... Processor Type : MCPNistProcessor ..............................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistProcessor/IMAP-SERVER">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_response</mesaDataAdapterOverload>
    <!--debug>true</debug-->
  </service> 

  <!--.........................................................................................-->
  <!--...................... Configuration for POP3-SERVER Response site ......................-->
  <!--........................... Receiver Type : EmailReceiver ...............................-->
  <service id="morpho.mesa.services.importers.process.EmailReceiver/POP3-SERVER">
    <!-- Mail server type/protocol.
    Valid values: 
    'POP3'  (plain POP3, unsecure)
    'POP3S' (POP3 + SSL, secure, encrypted)
    'IMAP', (plain IMAP, unsecure)
    'IMAPS' (IMAP + SSL, secure, encrypted)
    -->
    <mailProtocol>POP3</mailProtocol>
    <!-- Mail server hostname or IP -->
    <mailHost>localhost</mailHost>
    <!-- Mail server port. 
    Port is automatically determined based on 'mailProtocol' and 'useSSL' parameter. 
    Change ONLY if using non-standard port! -->
    <mailPort />
    <!-- Mailbox credentials (username and password) -->
    <authUser>ToBeDefined</authUser>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <authPassword>ToBeDefined</authPassword>
    <!-- Connection timeout in seconds [default: 120 seconds] -->
    <timeout>120</timeout>
    <!-- Mark received messages as 'Read' [default: true]. 
    Useful for IMAP mailbox, to skip processing already received emails.
    Has NO effect on POP3 mailbox!
    -->
    <markReceivedMessagesAsRead>true</markReceivedMessagesAsRead>
    <!-- Skip messages (don't process) already marked as 'Read' [default: true] 
    Has NO effect on POP3 mailbox! 
    -->
    <skipMessagesMarkedAsRead>true</skipMessagesMarkedAsRead>
    <!-- Leave a copy of messages on the server [default: true] 
    For POP3 mailbox, the recommended is 'false'. Otherwise, ALL messages will be received and processed on every check! (default: on every 30 seconds)
    -->
    <keepMessagesOnServer>false</keepMessagesOnServer>
    <!--If the "Content-Disposition" header is missing then default the value to "attachment" (BodyPart.ATTACHMENT)-->
    <defaultContentDisposition>attachment</defaultContentDisposition>
  </service> 

  <!--........................... Processor Type : MCPNistProcessor ..............................-->
  <service id="morpho.mesa.services.nist.mcp.MCPNistProcessor/POP3-SERVER">
    <domainPath>CONFIG/nist/domain_morphoX</domainPath>
    <domainFile>domain_definition__morphoX.xml</domainFile>
    <adapter>fbi_ebts_9_3_binary</adapter>
    <mesaDataAdapterBase>mesa_js</mesaDataAdapterBase>
    <mesaDataAdapterOverload>fbi_ebts_9_3_response</mesaDataAdapterOverload>
    <!--debug>true</debug-->
  </service> 

  <!--...................... Configuration for POP3-ISSUANCE Response site ......................-->
  <service id="morpho.mesa.services.importers.process.EmailReceiver/POP3-ISSUANCE">
    <mailProtocol>POP3</mailProtocol>
    <mailHost>localhost</mailHost>
    <mailPort />
    <!-- Mailbox credentials (username and password) -->
    <authUser>MesaIssuance</authUser>
    <!-- The password tag bellow must not contain the value of password, it must contain a key mentioned in mesaPasswords.properties file-->
    <authPassword>emailReceiverPop3ServerPassword</authPassword>
    <timeout>120</timeout>
    <markReceivedMessagesAsRead>true</markReceivedMessagesAsRead>
    <skipMessagesMarkedAsRead>true</skipMessagesMarkedAsRead>
    <keepMessagesOnServer>false</keepMessagesOnServer>
    <defaultContentDisposition>attachment</defaultContentDisposition>
  </service> 

  <!--######################################## Embedded Export Configuration #############################################-->
  <service id="morpho.mesa.business.export.logic.StartBackgroundExportLogic">
    <!--to activate export management, set skipEmbeddedExport value to false (default value). Otherwise, set it to true-->
    <skipEmbeddedExport>false</skipEmbeddedExport>
  </service> 

  <service id="morpho.mesa.business.export.logic.StartBackgroundResponseLogic">
    <!--to activate response management, set skipEmbeddedResponse value to false (default value). Otherwise, set it to true-->
    <skipEmbeddedResponse>false</skipEmbeddedResponse>
  </service> 

  <!--####################################################################################################################-->
  <!-- ********************************* MESA PURGE DOSSIER CONFIGURATION *********************************************************
        Defines the global configuration for MESA PURGE service.
          - Enable or Disable the dossier purge (automatic deletion)
          - Configuration of the dossier deletion from MESA database according the following criteria:
  -->
  <!-- Enable or Disable the dossier purge (automatic deletion) -->
  <service id="morpho.mesa.business.purge.logic.PurgeLogic">
    <skipPurge>true</skipPurge>
  </service> 

  <!--- Configuration of the dossier deletion from MESA database according the following criteria: 
      - PURGE_BY_DIRECTORY_EVENT: System directories Watcher Event
      - PURGE_BY_DOSSIER_AGE: Dossier Age
      - PURGE_BY_MAX_DOSSIER_EVENT: Maximum number of dossiers in database
      - PURGE_BY_DOSSIER_COMPLETION: Purge by dossier completion (can check ACK before purging)
  -->
  <service id="morpho.mesa.services.purge.PurgeServiceImpl">
    <!--  Declare here all used configurations to purge dossiers
          and the submissions and printing requests related to dossiers
    -->
    <purgeConfigurations>
      <purgeConfiguration>PURGE_BY_DOSSIER_COMPLETION</purgeConfiguration>
      <purgeConfiguration>PURGE_BY_DOSSIER_AGE</purgeConfiguration>
    </purgeConfigurations>
    <!-- Scriptable entry point to manage specific deletion purge -->
    <scriptFile>CONFIG/scripts-service/purge-service.js</scriptFile>
  </service>

  <service id="morpho.mesa.services.purge.config.PurgeConfigurationRepository">
    <!-- Configuration of Purge by Dossier age  -->
    <purgeConfiguration>
      <type>PURGE_BY_DOSSIER_AGE</type>
      <!-- Delete dossiers oldest than 720 hours (30days) -->
      <dossierLifeDuration>720</dossierLifeDuration>
    </purgeConfiguration>
	
	<purgeConfiguration>
      <type>PURGE_BY_ADVANCED_CRITERIA</type>
      <!-- Delete dossiers oldest than 720 hours (30days) -->
      <dossierLifeDuration>720</dossierLifeDuration>
	  <purgeDossierAdvancedCriteria>(STATUS = 'COMPLETE' and PROCEDURE_NAME = 'P1')</purgeDossierAdvancedCriteria>
    </purgeConfiguration>
	
    <!-- Configuration of Purge FIFO  -->
    <purgeConfiguration>
      <type>PURGE_BY_MAX_DOSSIER_EVENT</type>
      <!-- Delete the oldest dossiers if there are more than 100 dossiers in database
             maxDossierInDatabase must always be greater than targetDossiersInDatabase in order to purge dossier(s)
        -->
      <maxDossierInDatabase>100</maxDossierInDatabase>
      <!-- Indicates a database size that will allow operations to continue normally on the system.
             targetDossiersInDatabase is the number of dossiers to stop at when deleting the exceeding 
             number of dossiers, targetDossiersInDatabase = 80 by default.
        -->
      <targetDossiersInDatabase>80</targetDossiersInDatabase>
      <!-- Define the criterias to select dossier to be purged (separated by "&" character, which is a special XML character, so it must be replaced by "&amp;")
             Default value: none
        -->
      <purgeDossierCriteria>stationIdentifier=123456</purgeDossierCriteria>
    </purgeConfiguration>
    <!-- configuration of Purge by System File Watcher Event -->
    <purgeConfiguration>
      <type>PURGE_BY_DIRECTORY_EVENT</type>
      <directoryToWatch>
        <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
            For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
            -->
        <driveName>OSDisk</driveName>
        <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
            Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
            e.g. [Windows-like]      C:\MesaStorage\Export
            e.g. [Linux-like]        C:/MesaStorage/Export
            e.g. [Network-share]     \\network-drive\export\ptkosm
            -->
        <path>MesaStorage/Backup1</path>
      </directoryToWatch>
      <directoryToWatch>
        <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
            For non-USB destinations, it is recommended to leave it empty and give the full path in the 'path' parameter.
            -->
        <driveName>OSDisk</driveName>
        <!-- if 'driveName' is used (for USBs), this parameter should contain relative path from the drive root folder.
            Otherwise, if 'driveName' is NOT used, the path MUST contain drive letter, or shared network name.
            e.g. [Windows-like]      C:\MesaStorage\Export
            e.g. [Linux-like]        C:/MesaStorage/Export
            e.g. [Network-share]     \\network-drive\export\ptkosm
            -->
         <path>MesaStorage/Backup2</path>
      </directoryToWatch>
      <jsInitFunction>initPurgeByDirectoryWatcher</jsInitFunction>
      <jsFunction>purgeByDirectoryWatcher</jsFunction>
    </purgeConfiguration>
    <!-- configuration of Purge by dossier completion -->
    <purgeConfiguration>
      <type>PURGE_BY_DOSSIER_COMPLETION</type>
      <!-- The maximum dossier number that can be deleted per iteration. -1 means that all completed dossiers are purged at first iteration. -->
      <maxToDeletePerIteration>-1</maxToDeletePerIteration>
      <!-- time (in ms) between checks for purge, timeBetweenChecksForPurge = 10000 by default -->
      <timeBetweenChecksForPurge>10000</timeBetweenChecksForPurge>
      <jsInitFunction>initPurgeByDossierCompletion</jsInitFunction>
      <!-- check if the dossier could be considered as complete -->
      <!-- if jsFunction is not defined for this purge, no acknowledgment checking will be done -->
      <jsFunction>checkDossierCompletion</jsFunction>
    </purgeConfiguration>
  </service>

  <!-- *****************************************************************************************************************************-->
  <service id="morpho.mesa.common.business.logic.MesaBaseLogic">
    <checkEnvironmentOptions>
      <checkFPDevices>false</checkFPDevices>
      <checkScanners>false</checkScanners>
      <checkCameras>false</checkCameras>
      <checkIrisDevices>false</checkIrisDevices>
      <checkUSBDevices>false</checkUSBDevices>
      <checkDirectoriesRights>false</checkDirectoriesRights>
      <checkDisksSpace>false</checkDisksSpace>
      <checkLicenses>false</checkLicenses>
      <checkCertificatesStores>false</checkCertificatesStores>
      <checkSerialPortCOM>false</checkSerialPortCOM>
    </checkEnvironmentOptions>
    <importFileRootLocation refSource="CommonConfiguration" ref="/appDetails/fileRoot" />
    <!--true to allow the change of user from any Mesa page
      Default : false (disabled)
      -->
    <allowChangeUser>false</allowChangeUser>
    <!-- true if user must type in username and password manually, false otherwise (auto login)
        Default value : true
    -->
    <manualLogin refSource="morpho.mesa.security.authentication" ref="/manualLogin" />
    <!--true to enable devices capabilities feature
      Default : false (disabled)
      -->
    <enableDevicesCapabilities>true</enableDevicesCapabilities>
  </service> 
  
   <!-- Device Capabilities configuration 
        "procedureName" should match the related workflow's name and has its list of required and optional capabilities among the following list:
          FLAT - Ability to capture flat and slap fingerprints
          ROLLED - Ability to capture rolled fingerprints
          PALM - Ability to capture palms
          PHOTO - Ability to capture all kind of photos, which includes scanner devices
          PORTRAIT - Ability to capture live, in person portraits
          IRIS - Ability to capture irises
          PORTRAIT_IRIS - Ability to capture both iris and live portrait at the same time 
          PHYSICAL_PASSPORT - Ability to read full page passports
          RFID - Ability to read e-documents in RFID chips
          
        NB: A required capability is needed to complete mandatory step(s) in the procedure.
            An optional capability is needed to complete optional step(s) in the procedure.
            
        Sample example of a configuration:
  -->
  <service id="morpho.mesa.services.devicescapabilities.DevicesCapabilitiesImpl">
    <timeout>30</timeout>
    <procedureCapabilities>
      <procedureName>PortraitProcedure</procedureName>
      <requiredCapability>PORTRAIT</requiredCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>FingerprintProcedure</procedureName>
      <requiredCapability>FLAT</requiredCapability>
      <optionalCapability>ROLLED</optionalCapability>
      <optionalCapability>PALM</optionalCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>DocumentCopiesProcedure</procedureName>
      <requiredCapability>PHOTO</requiredCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>CardScanProcedure</procedureName>
      <requiredCapability>PHOTO</requiredCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>EvidencesAndLatentsProcedure</procedureName>
      <requiredCapability>PHOTO</requiredCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>SMTProcedure</procedureName>
      <requiredCapability>PHOTO</requiredCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>IrisAndFaceProcedure</procedureName>
      <requiredCapability>PORTRAIT_IRIS</requiredCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>IrisProcedure</procedureName>
      <requiredCapability>IRIS</requiredCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>P40PassportIssuanceMOD</procedureName>
      <requiredCapability>PHYSICAL_PASSPORT</requiredCapability>
      <requiredCapability>RFID</requiredCapability>
      <requiredCapability>PORTRAIT</requiredCapability>
      <requiredCapability>FLAT</requiredCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>FirstEnrolmentProcedure</procedureName>
      <requiredCapability>PHOTO</requiredCapability>
      <requiredCapability>PORTRAIT</requiredCapability>
      <requiredCapability>FLAT</requiredCapability>
      <optionalCapability>IRIS</optionalCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>DocumentRenewal</procedureName>
      <requiredCapability>PHOTO</requiredCapability>
      <requiredCapability>PORTRAIT</requiredCapability>
      <requiredCapability>FLAT</requiredCapability>
      <optionalCapability>IRIS</optionalCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>DocumentReplacement</procedureName>
      <requiredCapability>PHOTO</requiredCapability>
      <requiredCapability>PORTRAIT</requiredCapability>
      <requiredCapability>FLAT</requiredCapability>
      <optionalCapability>IRIS</optionalCapability>
    </procedureCapabilities>
    <procedureCapabilities>
      <procedureName>PoliceEnrolmentProcedure</procedureName>
      <requiredCapability>PORTRAIT</requiredCapability>
      <requiredCapability>FLAT</requiredCapability>
      <requiredCapability>ROLLED</requiredCapability>
      <requiredCapability>PALM</requiredCapability>
      <optionalCapability>PHOTO</optionalCapability>
    </procedureCapabilities>
	<procedureCapabilities>
      <procedureName>SimultaneousPortraitsProcedure</procedureName>
      <requiredCapability>PORTRAIT</requiredCapability>
    </procedureCapabilities>
  </service>
  
  <!-- Enable or Disable the check Environment for JMX monitoring (Jconsole)-->
  <service id="morpho.mesa.services.checkenvironment.MesaJMX">
    <checkEnvironmentOptions>
      <checkFPDevices>true</checkFPDevices>
      <checkScanners>true</checkScanners>
      <checkCameras>true</checkCameras>
      <checkIrisDevices>true</checkIrisDevices>
      <checkUSBDevices>true</checkUSBDevices>
      <checkDirectoriesRights>true</checkDirectoriesRights>
      <checkDisksSpace>true</checkDisksSpace>
      <checkLicenses>true</checkLicenses>
      <checkCertificatesStores>true</checkCertificatesStores>
      <checkSerialPortCOM>true</checkSerialPortCOM>
    </checkEnvironmentOptions>
  </service> 

  <!-- CONFIGURATION of conditions to check when Mesa startup-->
  <service id="morpho.mesa.services.checkenvironment.CheckEnvironmentImpl">
    <!-- logging path (use $XXX$ to refer to environment variables ) 
         $XXX$ must always be at the first of the path
    -->
    <!-- You must set a valid path for the logHome-->
    <logHome>$APPDATA$/IDEMIA/Mesa/log</logHome>
    <!-- Licenses type to checked (it's possible to define another <license> configuration property)-->
    <license>VERIF</license>
    <!--Volumes to be checked (it's possible to define another <volume> configuration property) -->
    <volume>
      <!-- 'driveName' parameter is usefull for USB drives (which couldn't be uniquely identified by the letter in Windows) 
        For non-USB destinations, it is recommended to leave it empty and give the drive root path in the 'path' parameter.
        -->
      <driveName>OSDisk</driveName>
      <!-- if 'driveName' is used (for USBs), this parameter should be empty.
        Otherwise, if 'driveName' is NOT used, the path MUST contain drive root path, or shared network name.
        e.g. [Windows-like]      C:\
        e.g. [Network-share]     \\network-drive\export\ptkosm
        -->
      <path />
      <!-- Minimum free space in Mo -->
      <minimumFreeSpace>
        <warningThreshold>200</warningThreshold>
        <blockingThreshold>128</blockingThreshold>
      </minimumFreeSpace>
    </volume>
    <!-- directories access rights check (it's possible to define another <directoryToCheck> configuration property) -->
    <directoryToCheck>
      <directoryPath>C:\Mesa</directoryPath>
      <!-- the maximum number of directory levels to visit  /!\ : going down in levels makes MESA loading slow -->
      <maxDepth>2</maxDepth>
      <!-- check or skip files -->
      <checkFiles>true</checkFiles>
      <!-- skip files from check by extensions (list separated with ',') -->
      <skipFileExt>zip</skipFileExt>
      <!-- detail for all directories and files checked, the RW status -->
      <details>true</details>
    </directoryToCheck>
    <!-- Regular expression to look for specific USB device -->
    <usbDevice>.*Mouse.*</usbDevice>
    <!--<usbDevice>.*Topaz.*</usbDevice>
    <usbDevice>.*MorphoTop.*</usbDevice>-->
    <!-- Verification of connection of COM Ports Serial-->
    <comPortSerialDevice>
      <!-- You can specify other COM Port Serial To check by adding : <comPort>NUM_COM</comPort> below)-->
      <comPort>COM11</comPort>
    </comPortSerialDevice>
    <comPortSerialDevice>
      <!-- You can specify other COM Port Serial To check by adding : <comPort>NUM_COM</comPort> below)-->
      <comPort>COM6</comPort>
    </comPortSerialDevice>
  </service> 

  <!-- **********************************************************************************************************************-->
  <!-- ********************************* MESA Serial Communication service CONFIGURATION *************************************************-->
  <service id="morpho.mesa.services.serialCom.SerialComImpl">
    <comPortSerialDevice>
      <comPort>COM8</comPort>
      <!-- Type of serial device, possible values barcodeReader or MRZReader (default) -->
      <deviceType>MRZReader</deviceType>
    </comPortSerialDevice>
    <comPortSerialDevice>
      <comPort>COM5</comPort>
      <deviceType>barcodeReader</deviceType>
    </comPortSerialDevice>
  </service> 

  <!-- **********************************************************************************************************************-->
  <!-- ********************************* Import Tool (Import Dossiers) CONFIGURATION ******************************************************
        Import tool (Import Dossiers) features: 
          - Load MESA Database with dossiers (containing acquired data) from input xml files
          - Load MESA Database with submissions requests and responses related to submissions
          - Load MESA Database with fictitious submissions (random site ID and status as "Sent")
          - Generate a number of dossiers to import which are built from input xml files 
            Dossiers can be generated differently in terms of acquired data
  -->
  <service id="morpho.mesaImport.app.launcher.importDossiers.ImportDossiers">
    <!-- .......................... Dossiers generation Configuration .......................... -->
    <!--  Declare here all used configurations to generate and import dossiers
          These configurations are applied to all input xml files
          Input xml files folder is chosen from GUI of Import Tool
    -->
    <dossiersGeneratorConfigs>
      <dossiersGeneratorConfig>DOSSIERS-GENERATOR-CONFIG-1</dossiersGeneratorConfig>
      <dossiersGeneratorConfig>DOSSIERS-GENERATOR-CONFIG-2</dossiersGeneratorConfig>
    </dossiersGeneratorConfigs>
    <!-- ................................. Data saving Configuration ........................... -->
    <!--  - Create binaries (images of  acquired data) for all imported dossiers and save it on disk 
            Binaries location is specified by binaryDataLocation config tag 
            (cf. MESA DATABASE LOCATION PARAMETERS)
          - Save generated dossiers as xml files in the folder where input xml files are located
    -->
    <createBinaries>true</createBinaries>
    <saveGeneratedDossiersXml>true</saveGeneratedDossiersXml>
    <saveGeneratedDossiersXmlWithoutBinaries>true</saveGeneratedDossiersXmlWithoutBinaries>
    <!-- ................................. Generated Dossiers identifiers Configuration ........................... -->
    <identifiersGeneratorScriptLocation>CONFIG/scripts-importTool/dossiersIdentifiersGenerator.js</identifiersGeneratorScriptLocation>
  </service> 

  <service id="morpho.mesaImport.app.launcher.configuration.DossiersGeneratorConfigRepository">
    <dossiersGeneratorConfig>
      <id>DOSSIERS-GENERATOR-CONFIG-1</id>
      <dossiersToGenerateNumber>2</dossiersToGenerateNumber>
      <!-- ..................... Demographics generation configuration ..................... -->
      <includeDemographics>true</includeDemographics>
      <randomizeDemographics>true</randomizeDemographics>
      <!-- ..................... FeatureTypes generation configuration ..................... -->
      <includeSomeFeatureTypesRandomly>false</includeSomeFeatureTypesRandomly>
      <includeFingers>true</includeFingers>
      <includeSignatures>true</includeSignatures>
      <includePortraits>true</includePortraits>
      <includeForms>false</includeForms>
      <includeMultipleImages>false</includeMultipleImages>
      <includeCardScan>false</includeCardScan>
      <includeIrises>false</includeIrises>
      <includeEvidences>false</includeEvidences>
      <!-- ..................... Submissions generation configuration ...................... -->
      <!--  Declare here all used configurations to generate and import submissions requests,
            responses and fictitious submissions (random site ID and status as "Sent")
            These configurations are applied to all dossiers generated from this config
      -->
      <submissionsGeneratorConfigs>
        <submissionsGeneratorConfig>SUBMISSIONS-GENERATOR-CONFIG-1</submissionsGeneratorConfig>
        <submissionsGeneratorConfig>SUBMISSIONS-GENERATOR-CONFIG-2</submissionsGeneratorConfig>
      </submissionsGeneratorConfigs>
    </dossiersGeneratorConfig>
    <dossiersGeneratorConfig>
      <id>DOSSIERS-GENERATOR-CONFIG-2</id>
      <dossiersToGenerateNumber>2</dossiersToGenerateNumber>
      <!-- ..................... Demographics generation configuration ..................... -->
      <includeDemographics>false</includeDemographics>
      <!-- ..................... FeatureTypes generation configuration ..................... -->
      <includeSomeFeatureTypesRandomly>true</includeSomeFeatureTypesRandomly>
      <!-- ..................... Submissions generation configuration ...................... -->
      <submissionsGeneratorConfigs>
        <submissionsGeneratorConfig>SUBMISSIONS-GENERATOR-CONFIG-1</submissionsGeneratorConfig>
      </submissionsGeneratorConfigs>
    </dossiersGeneratorConfig>
  </service> 

  <service id="morpho.mesaImport.app.launcher.configuration.SubmissionsGeneratorConfigRepository">
    <submissionsGeneratorConfig>
      <id>SUBMISSIONS-GENERATOR-CONFIG-1</id>
      <!-- ....................... Submission requests configuration ....................... -->
      <submissionRequestsSiteId>MESA-USB-1</submissionRequestsSiteId>
      <submissionRequestsNumber>2</submissionRequestsNumber>
      <!-- ................. Submissions with random site ID configuration ................. -->
      <submissionRandomNumber>2</submissionRandomNumber>
    </submissionsGeneratorConfig>
    <submissionsGeneratorConfig>
      <id>SUBMISSIONS-GENERATOR-CONFIG-2</id>
      <!-- ....................... Submission requests configuration ....................... -->
      <submissionRequestsSiteId>MESA-SMTP-1</submissionRequestsSiteId>
      <submissionRequestsNumber>2</submissionRequestsNumber>
      <responseRequired>true</responseRequired>
      <!-- ................. Submissions with random site ID configuration ................. -->
      <submissionRandomNumber>2</submissionRandomNumber>
    </submissionsGeneratorConfig>
  </service> 

  <!-- **********************************************************************************************************************-->
  <!-- ********************************* MESA updater service CONFIGURATION *************************************************-->
  <service id="morpho.mesa.business.portal.update.Updater">
    <updatesURL>http://[server]:8081/mesa/updates.xml</updatesURL>
    <updatesURL>ToBeDefined</updatesURL>
  </service> 

  <!-- **********************************************************************************************************************-->
  <!-- ********************************* Dossier logic CONFIGURATION *************************************************-->
  <service id="morpho.mesa.business.dossiers.logic.DossiersLogic">
    <site>MESA-USB-1</site>
    <!-- Maximum number of dossiers that can be retrieved from a query in database
            (if too high, query time can be long...)  -->
    <maxDossiersFromQuery>50</maxDossiersFromQuery>
  </service> 

  <!-- ***********************************************************************************************************************-->
  <!-- ********************************* MESA Login Module and User Rights Management ****************************************-->
  <!--####################################################################################################################-->

  <service id="morpho.mesa.security.authentication">
    <!-- true if user must type in username and password manually, false otherwise (auto login)
        No default value
    -->
    <manualLogin>true</manualLogin>
    <!--Name of authentication type that must be used
        (refer to "morpho.mcp.fabric.internal.security.auth.LoginConfiguration" scope for definitions)
        No default value
        LocalUsers
    -->
    <active>LocalUsers</active>
  </service> 

  <!-- Card Scan *************************************************************************************************************************-->
  <!-- *************************************************************************************************************************-->
  <service id="com.printrak.frontend.services.tewsdk.logic.ConfigurationLogic">
    <adsHost ref="adsHost" />
    <appName>TEW</appName>
    <appVersion>MB3.1</appVersion>
    <cardImageSubmission>yes</cardImageSubmission>
    <cardImageSubmissionResolution>250</cardImageSubmissionResolution>
    <cardImageSubmissionMediaType>jpg</cardImageSubmissionMediaType>
    <closedSearchAllowed>yes</closedSearchAllowed>
    <contentType>TENPRINT</contentType>
    <documentResolution>300</documentResolution>
    <!--<exemptionDescriptors>Exemptions.swtxml</exemptionDescriptors>-->
    <exemptionDescTag>Exemptions</exemptionDescTag>
    <exemptionSkipProcessingList>
      <exemptionCode>AMPUTATED</exemptionCode>
    </exemptionSkipProcessingList>
    <fingerTipSubmissionCount>3</fingerTipSubmissionCount>
    <fingerViewSubmissionCount>4</fingerViewSubmissionCount>
    <!--<faceDescriptors>FaceDescriptors.swtxml</faceDescriptors>
    <scarDescriptors>ScarDescriptors.swtxml</scarDescriptors>
    <markDescriptors>MarkDescriptors.swtxml</markDescriptors>
    <tattooDescriptors>TattooDescriptors.swtxml</tattooDescriptors>
    <searchDescriptors>SearchDescriptors.swtxml</searchDescriptors>
    <searchParameters>SearchParameters.swtxml</searchParameters>-->
  </service>
  
  <service id="morpho.mesa.services.acquisition.edoc.medocreader.ICAOMorphoEDocReader">
    <timeoutForConnectingToReader>30</timeoutForConnectingToReader>
  </service>
  
  <!-- Multiple Portrait logic configuration for Simultaneous Portrait procedure -->
  <service id='default/SimultaneousPortraitsProcedure/SimultaneousPortrait/morpho.mesa.business.portrait.logic.SimultaneousPortraitsLogic'>
    <strictAcquisitionOrder>true</strictAcquisitionOrder>
    <enableIcaoChecks>true</enableIcaoChecks>
    <computeFaceBioQuality>true</computeFaceBioQuality>
    <enableAutoRealignEyesHorizontally>true</enableAutoRealignEyesHorizontally>
    <portraits>
	  <portrait>
        <name>frontal-1</name>
        <type>FRONT</type>
        <width>414</width>
        <height>512</height>
		<thumbnailWidth>233</thumbnailWidth>
		<thumbnailHeight>250</thumbnailHeight>
        <mandatory>true</mandatory>
      </portrait>
      <portrait>
        <name>Right-Profile-1</name>
        <type>RIGHT_PROFILE</type>
         <width>414</width>
        <height>512</height>
		<thumbnailWidth>233</thumbnailWidth>
		<thumbnailHeight>250</thumbnailHeight>
		<cropBoxWidth>414</cropBoxWidth>
		<cropBoxHeight>512</cropBoxHeight>
        <mandatory>true</mandatory>
      </portrait>
	  <portrait>
        <name>Left-Profile-1</name>
        <type>LEFT_PROFILE</type>
         <width>414</width>
        <height>512</height>
		<thumbnailWidth>233</thumbnailWidth>
		<thumbnailHeight>250</thumbnailHeight>
		<cropBoxWidth>414</cropBoxWidth>
		<cropBoxHeight>512</cropBoxHeight>
        <mandatory>true</mandatory>
      </portrait>
    </portraits>
	<devicePortraitMapper>
	   <portraitType>FRONT</portraitType>
	   <deviceIdentifier>0005</deviceIdentifier>
    </devicePortraitMapper>
	<devicePortraitMapper>
	   <portraitType>RIGHT_PROFILE</portraitType>
	   <deviceIdentifier>0006</deviceIdentifier>
    </devicePortraitMapper>
	<devicePortraitMapper>
	   <portraitType>LEFT_PROFILE</portraitType>
	   <deviceIdentifier>0003</deviceIdentifier>
    </devicePortraitMapper>
  </service>
  
  <!-- Export logic configuration for Simultaneous Portraits Procedure -->
  <service id="default/SimultaneousPortraitsProcedure/Export/morpho.mesa.business.export.logic.ExportLogic">
    <site>MESA-USB-1</site>
  </service> 
  
</services>